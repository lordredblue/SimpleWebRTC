!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).adapter=e()}(function(){return function r(o,i,s){function a(t,e){if(!i[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}n=i[t]={exports:{}},o[t][0].call(n.exports,function(e){return a(o[t][1][e]||e)},n,n.exports,r,o,i,s)}return i[t].exports}for(var c="function"==typeof require&&require,e=0;e<s.length;e++)a(s[e]);return a}({1:[function(e,t,n){"use strict";e=(0,e("./adapter_factory.js").adapterFactory)({window:"undefined"==typeof window?void 0:window});t.exports=e},{"./adapter_factory.js":2}],2:[function(e,t,n){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},n=i.log,r=i.detectBrowser(e),o={browserDetails:r,commonShim:p,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings,sdp:d};switch(r.browser){case"chrome":if(!a||!a.shimPeerConnection||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),o;if(null===r.version)return n("Chrome shim can not determine version, not shimming."),o;n("adapter.js shimming chrome."),o.browserShim=a,p.shimAddIceCandidateNullOrEmpty(e,r),p.shimParameterlessSetLocalDescription(e,r),a.shimGetUserMedia(e,r),a.shimMediaStream(e,r),a.shimPeerConnection(e,r),a.shimOnTrack(e,r),a.shimAddTrackRemoveTrack(e,r),a.shimGetSendersWithDtmf(e,r),a.shimGetStats(e,r),a.shimSenderReceiverGetStats(e,r),a.fixNegotiationNeeded(e,r),p.shimRTCIceCandidate(e,r),p.shimRTCIceCandidateRelayProtocol(e,r),p.shimConnectionState(e,r),p.shimMaxMessageSize(e,r),p.shimSendThrowTypeError(e,r),p.removeExtmapAllowMixed(e,r);break;case"firefox":if(!c||!c.shimPeerConnection||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),o;n("adapter.js shimming firefox."),o.browserShim=c,p.shimAddIceCandidateNullOrEmpty(e,r),p.shimParameterlessSetLocalDescription(e,r),c.shimGetUserMedia(e,r),c.shimPeerConnection(e,r),c.shimOnTrack(e,r),c.shimRemoveStream(e,r),c.shimSenderGetStats(e,r),c.shimReceiverGetStats(e,r),c.shimRTCDataChannel(e,r),c.shimAddTransceiver(e,r),c.shimGetParameters(e,r),c.shimCreateOffer(e,r),c.shimCreateAnswer(e,r),p.shimRTCIceCandidate(e,r),p.shimConnectionState(e,r),p.shimMaxMessageSize(e,r),p.shimSendThrowTypeError(e,r);break;case"safari":if(!u||!t.shimSafari)return n("Safari shim is not included in this adapter release."),o;n("adapter.js shimming safari."),o.browserShim=u,p.shimAddIceCandidateNullOrEmpty(e,r),p.shimParameterlessSetLocalDescription(e,r),u.shimRTCIceServerUrls(e,r),u.shimCreateOfferLegacy(e,r),u.shimCallbacksAPI(e,r),u.shimLocalStreamsAPI(e,r),u.shimRemoteStreamsAPI(e,r),u.shimTrackEventTransceiver(e,r),u.shimGetUserMedia(e,r),u.shimAudioContext(e,r),p.shimRTCIceCandidate(e,r),p.shimRTCIceCandidateRelayProtocol(e,r),p.shimMaxMessageSize(e,r),p.shimSendThrowTypeError(e,r),p.removeExtmapAllowMixed(e,r);break;default:n("Unsupported browser!")}return o};var i=r(e("./utils")),a=r(e("./chrome/chrome_shim")),c=r(e("./firefox/firefox_shim")),u=r(e("./safari/safari_shim")),p=r(e("./common_shim")),d=r(e("sdp"));function f(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(f=function(e){return e?n:t})(e))}function r(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==s(e)&&"function"!=typeof e)return{default:e};t=f(t);if(t&&t.has(e))return t.get(e);var n,r,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((r=i?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(o,n,r):o[n]=e[n]);return o.default=e,t&&t.set(e,o),o}},{"./chrome/chrome_shim":3,"./common_shim":6,"./firefox/firefox_shim":7,"./safari/safari_shim":10,"./utils":11,sdp:12}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fixNegotiationNeeded=function(e,n){o.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){var t=e.target;if(!(n.version<72||t.getConfiguration&&"plan-b"===t.getConfiguration().sdpSemantics)||"stable"===t.signalingState)return e})},n.shimAddTrackRemoveTrack=function(o,e){if(o.RTCPeerConnection){if(o.RTCPeerConnection.prototype.addTrack&&65<=e.version)return u(o);var n=o.RTCPeerConnection.prototype.getLocalStreams,r=(o.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this,e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(function(e){return t._reverseStreams[e.id]})},o.RTCPeerConnection.prototype.addStream),t=(o.RTCPeerConnection.prototype.addStream=function(e){var t,n=this;this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e.getTracks().forEach(function(t){if(n.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")}),this._reverseStreams[e.id]||(t=new o.MediaStream(e.getTracks()),this._streams[e.id]=t,this._reverseStreams[t.id]=e,e=t),r.apply(this,[e])},o.RTCPeerConnection.prototype.removeStream),i=(o.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[(this._streams[e.id]||e).id],delete this._streams[e.id]},o.RTCPeerConnection.prototype.addTrack=function(t,e){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var r=this._streams[e.id];return r?(r.addTrack(t),Promise.resolve().then(function(){n.dispatchEvent(new Event("negotiationneeded"))})):(r=new o.MediaStream([t]),this._streams[e.id]=r,this._reverseStreams[r.id]=e,this.addStream(r)),this.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(e){var r=o.RTCPeerConnection.prototype[e],t=c({},e,function(){var t=this,n=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[function(e){e=a(t,e);n[0].apply(null,[e])},function(e){n[1]&&n[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then(function(e){return a(t,e)})});o.RTCPeerConnection.prototype[e]=t[e]}),o.RTCPeerConnection.prototype.setLocalDescription),s=(o.RTCPeerConnection.prototype.setLocalDescription=function(){var n,e,r;return arguments.length&&arguments[0].type&&(arguments[0]=(n=this,r=(e=arguments[0]).sdp,Object.keys(n._reverseStreams||[]).forEach(function(e){var e=n._reverseStreams[e],t=n._streams[e.id];r=r.replace(new RegExp(e.id,"g"),t.id)}),new RTCSessionDescription({type:e.type,sdp:r}))),i.apply(this,arguments)},Object.getOwnPropertyDescriptor(o.RTCPeerConnection.prototype,"localDescription"));Object.defineProperty(o.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=s.get.apply(this);return""===e.type?e:a(this,e)}}),o.RTCPeerConnection.prototype.removeTrack=function(t){var n,r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(t._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach(function(e){r._streams[e].getTracks().find(function(e){return t.track===e})&&(n=r._streams[e])}),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}}function a(n,e){var r=e.sdp;return Object.keys(n._reverseStreams||[]).forEach(function(e){var e=n._reverseStreams[e],t=n._streams[e.id];r=r.replace(new RegExp(t.id,"g"),e.id)}),new RTCSessionDescription({type:e.type,sdp:r})}},n.shimAddTrackRemoveTrackWithNative=u,Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),n.shimGetSendersWithDtmf=function(e){{var r,o,t,n,i,s;"object"===a(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype?(r=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}},e.RTCPeerConnection.prototype.getSenders||(e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()},o=e.RTCPeerConnection.prototype.addTrack,e.RTCPeerConnection.prototype.addTrack=function(e,t){var n=o.apply(this,arguments);return n||(n=r(this,e),this._senders.push(n)),n},t=e.RTCPeerConnection.prototype.removeTrack,e.RTCPeerConnection.prototype.removeTrack=function(e){t.apply(this,arguments);e=this._senders.indexOf(e);-1!==e&&this._senders.splice(e,1)}),n=e.RTCPeerConnection.prototype.addStream,e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(function(e){t._senders.push(r(t,e))})},i=e.RTCPeerConnection.prototype.removeStream,e.RTCPeerConnection.prototype.removeStream=function(e){var n=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach(function(t){var e=n._senders.find(function(e){return e.track===t});e&&n._senders.splice(n._senders.indexOf(e),1)})}):"object"===a(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&(s=e.RTCPeerConnection.prototype.getSenders,e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=s.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}}))}},n.shimGetStats=function(e){var s;e.RTCPeerConnection&&(s=e.RTCPeerConnection.prototype.getStats,e.RTCPeerConnection.prototype.getStats=function(){var n,r,o=this,e=Array.prototype.slice.call(arguments),t=e[0],i=e[1],e=e[2];return 0<arguments.length&&"function"==typeof t?s.apply(this,arguments):0!==s.length||0!==arguments.length&&"function"==typeof t?(n=function(e){var r={};return e.result().forEach(function(t){var n={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach(function(e){n[e]=t.stat(e)}),r[n.id]=n}),r},r=function(t){return new Map(Object.keys(t).map(function(e){return[e,t[e]]}))},2<=arguments.length?s.apply(this,[function(e){i(r(n(e)))},t]):new Promise(function(t,e){s.apply(o,[function(e){t(r(n(e)))},e])}).then(i,e)):s.apply(this,[])})},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}}),n.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function(i){{var e;"object"!==a(i)||!i.RTCPeerConnection||"ontrack"in i.RTCPeerConnection.prototype?o.wrapPeerConnectionEvent(i,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}):(Object.defineProperty(i.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0}),e=i.RTCPeerConnection.prototype.setRemoteDescription,i.RTCPeerConnection.prototype.setRemoteDescription=function(){var o=this;return this._ontrackpoly||(this._ontrackpoly=function(r){r.stream.addEventListener("addtrack",function(t){var e=i.RTCPeerConnection.prototype.getReceivers?o.getReceivers().find(function(e){return e.track&&e.track.id===t.track.id}):{track:t.track},n=new Event("track");n.track=t.track,n.receiver=e,n.transceiver={receiver:e},n.streams=[r.stream],o.dispatchEvent(n)}),r.stream.getTracks().forEach(function(t){var e=i.RTCPeerConnection.prototype.getReceivers?o.getReceivers().find(function(e){return e.track&&e.track.id===t.id}):{track:t},n=new Event("track");n.track=t,n.receiver=e,n.transceiver={receiver:e},n.streams=[r.stream],o.dispatchEvent(n)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)})}},n.shimPeerConnection=function(r,e){!r.RTCPeerConnection&&r.webkitRTCPeerConnection&&(r.RTCPeerConnection=r.webkitRTCPeerConnection);r.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=r.RTCPeerConnection.prototype[e],n=c({},e,function(){return arguments[0]=new("addIceCandidate"===e?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)});r.RTCPeerConnection.prototype[e]=n[e]})},n.shimSenderReceiverGetStats=function(e){var n,t,r,i;"object"===a(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver&&("getStats"in e.RTCRtpSender.prototype||((n=e.RTCPeerConnection.prototype.getSenders)&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),(t=e.RTCPeerConnection.prototype.addTrack)&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return o.filterStats(e,t.track,!0)})}),"getStats"in e.RTCRtpReceiver.prototype||((r=e.RTCPeerConnection.prototype.getReceivers)&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=r.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),o.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return o.filterStats(e,t.track,!1)})}),"getStats"in e.RTCRtpSender.prototype)&&"getStats"in e.RTCRtpReceiver.prototype&&(i=e.RTCPeerConnection.prototype.getStats,e.RTCPeerConnection.prototype.getStats=function(){var t,n,r,o;return 0<arguments.length&&arguments[0]instanceof e.MediaStreamTrack?(t=arguments[0],this.getSenders().forEach(function(e){e.track===t&&(n?o=!0:n=e)}),this.getReceivers().forEach(function(e){return e.track===t&&(r?o=!0:r=e),e.track===t}),o||n&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))):i.apply(this,arguments)})};var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var i;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(e("../utils.js")),r=e("./getusermedia"),i=e("./getdisplaymedia");function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function c(e,t,n){return(t=function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(e){return t._shimmedLocalStreams[e][0]})};var r=e.RTCPeerConnection.prototype.addTrack,o=(e.RTCPeerConnection.prototype.addTrack=function(e,t){if(!t)return r.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=r.apply(this,arguments);return this._shimmedLocalStreams[t.id]?-1===this._shimmedLocalStreams[t.id].indexOf(n)&&this._shimmedLocalStreams[t.id].push(n):this._shimmedLocalStreams[t.id]=[t,n],n},e.RTCPeerConnection.prototype.addStream),t=(e.RTCPeerConnection.prototype.addStream=function(e){var n=this,t=(this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(t){if(n.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")}),this.getSenders()),r=(o.apply(this,arguments),this.getSenders().filter(function(e){return-1===t.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(r)},e.RTCPeerConnection.prototype.removeStream),i=(e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],t.apply(this,arguments)},e.RTCPeerConnection.prototype.removeTrack);e.RTCPeerConnection.prototype.removeTrack=function(n){var r=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},n&&Object.keys(this._shimmedLocalStreams).forEach(function(e){var t=r._shimmedLocalStreams[e].indexOf(n);-1!==t&&r._shimmedLocalStreams[e].splice(t,1),1===r._shimmedLocalStreams[e].length&&delete r._shimmedLocalStreams[e]}),i.apply(this,arguments)}}},{"../utils.js":11,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(i,e){i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices||i.navigator.mediaDevices&&("function"!=typeof e?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):i.navigator.mediaDevices.getDisplayMedia=function(o){return e(o).then(function(e){var t=o.video&&o.video.width,n=o.video&&o.video.height,r=o.video&&o.video.frameRate;return o.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:r||3}},t&&(o.video.mandatory.maxWidth=t),n&&(o.video.mandatory.maxHeight=n),i.navigator.mediaDevices.getUserMedia(o)})})}},{}],5:[function(e,t,n){"use strict";function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e,t){var s,r,o,n,a=e&&e.navigator;a.mediaDevices&&(s=function(o){var i;return"object"!==c(o)||o.mandatory||o.optional?o:(i={},Object.keys(o).forEach(function(t){var n,r,e;"require"!==t&&"advanced"!==t&&"mediaSource"!==t&&(void 0!==(n="object"===c(o[t])?o[t]:{ideal:o[t]}).exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact),r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t},void 0!==n.ideal&&(i.optional=i.optional||[],e={},"number"==typeof n.ideal?(e[r("min",t)]=n.ideal,i.optional.push(e),(e={})[r("max",t)]=n.ideal):e[r("",t)]=n.ideal,i.optional.push(e)),void 0!==n.exact&&"number"!=typeof n.exact?(i.mandatory=i.mandatory||{},i.mandatory[r("",t)]=n.exact):["min","max"].forEach(function(e){void 0!==n[e]&&(i.mandatory=i.mandatory||{},i.mandatory[r(e,t)]=n[e])}))}),o.advanced&&(i.optional=(i.optional||[]).concat(o.advanced)),i)},r=function(n,r){if(!(61<=t.version)){if((n=JSON.parse(JSON.stringify(n)))&&"object"===c(n.audio)&&((e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])})((n=JSON.parse(JSON.stringify(n))).audio,"autoGainControl","googAutoGainControl"),e(n.audio,"noiseSuppression","googNoiseSuppression"),n.audio=s(n.audio)),n&&"object"===c(n.video)){var o,i=(i=n.video.facingMode)&&("object"===c(i)?i:{ideal:i}),e=t.version<66;if(i&&("user"===i.exact||"environment"===i.exact||"user"===i.ideal||"environment"===i.ideal)&&(!a.mediaDevices.getSupportedConstraints||!a.mediaDevices.getSupportedConstraints().facingMode||e))if(delete n.video.facingMode,"environment"===i.exact||"environment"===i.ideal?o=["back","rear"]:"user"!==i.exact&&"user"!==i.ideal||(o=["front"]),o)return a.mediaDevices.enumerateDevices().then(function(e){var t=(e=e.filter(function(e){return"videoinput"===e.kind})).find(function(t){return o.some(function(e){return t.label.toLowerCase().includes(e)})});return(t=!t&&e.length&&o.includes("back")?e[e.length-1]:t)&&(n.video.deviceId=i.exact?{exact:t.deviceId}:{ideal:t.deviceId}),n.video=s(n.video),u("chrome: "+JSON.stringify(n)),r(n)});n.video=s(n.video)}u("chrome: "+JSON.stringify(n))}return r(n)},o=function(e){return 64<=t.version?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},a.getUserMedia=function(e,t,n){r(e,function(e){a.webkitGetUserMedia(e,t,function(e){n&&n(o(e))})})}.bind(a),a.mediaDevices.getUserMedia)&&(n=a.mediaDevices.getUserMedia.bind(a.mediaDevices),a.mediaDevices.getUserMedia=function(e){return r(e,function(t){return n(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return e},function(e){return Promise.reject(o(e))})})})};var u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var i;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(e("../utils.js")).log},{"../utils.js":11}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.removeExtmapAllowMixed=function(n,e){var r;!n.RTCPeerConnection||"chrome"===e.browser&&71<=e.version||"safari"===e.browser&&605<=e.version||(r=n.RTCPeerConnection.prototype.setRemoteDescription,n.RTCPeerConnection.prototype.setRemoteDescription=function(e){var t;return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(t=e.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n"),n.RTCSessionDescription&&e instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:e.type,sdp:t}):e.sdp=t),r.apply(this,arguments)})},n.shimAddIceCandidateNullOrEmpty=function(e,t){var n;e.RTCPeerConnection&&e.RTCPeerConnection.prototype&&(n=e.RTCPeerConnection.prototype.addIceCandidate)&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})},n.shimConnectionState=function(e){var n;!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype||(n=e.RTCPeerConnection.prototype,Object.defineProperty(n,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(n,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var t=n[e];n[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t,n=e.target;return n._lastConnectionState!==n.connectionState&&(n._lastConnectionState=n.connectionState,t=new Event("connectionstatechange",e),n.dispatchEvent(t)),e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}}))},n.shimMaxMessageSize=function(e,i){var s;e.RTCPeerConnection&&("sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}}),s=e.RTCPeerConnection.prototype.setRemoteDescription,e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e,t,n,r,o;return this._sctp=null,"chrome"===i.browser&&76<=i.version&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0}),(o=arguments[0])&&o.sdp&&((o=a.default.splitSections(o.sdp)).shift(),o.some(function(e){e=a.default.parseMLine(e);return e&&"application"===e.kind&&-1!==e.protocol.indexOf("SCTP")}))&&(o=null===(o=(o=arguments[0]).sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/))||o.length<2||(o=parseInt(o[1],10))!=o?-1:o,n=o,r=65536,n=r="firefox"===i.browser?i.version<57?-1===n?16384:2147483637:i.version<60?57===i.version?65535:65536:2147483637:r,r=arguments[0],o=o,t=65536,"firefox"===i.browser&&57===i.version&&(t=65535),0<(r=a.default.matchPrefix(r.sdp,"a=max-message-size:")).length?t=parseInt(r[0].substring(19),10):"firefox"===i.browser&&-1!==o&&(t=2147483637),r=t,e=0===n&&0===r?Number.POSITIVE_INFINITY:0===n||0===r?Math.max(n,r):Math.min(n,r),o={},Object.defineProperty(o,"maxMessageSize",{get:function(){return e}}),this._sctp=o),s.apply(this,arguments)})},n.shimParameterlessSetLocalDescription=function(e,t){var n;e.RTCPeerConnection&&e.RTCPeerConnection.prototype&&(n=e.RTCPeerConnection.prototype.setLocalDescription)&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){var t=this,e=arguments[0]||{};if("object"!==c(e)||e.type&&e.sdp)return n.apply(this,arguments);if(!(e={type:e.type,sdp:e.sdp}).type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}return e.sdp||"offer"!==e.type&&"answer"!==e.type?n.apply(this,[e]):("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then(function(e){return n.apply(t,[e])})})},n.shimRTCIceCandidate=function(t){var o;!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype||(o=t.RTCIceCandidate,t.RTCIceCandidate=function(e){if("object"===c(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){var t,n=new o(e),r=a.default.parseCandidate(e.candidate);for(t in r)t in n||Object.defineProperty(n,t,{value:r[t]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new o(e)},t.RTCIceCandidate.prototype=o.prototype,r.wrapPeerConnectionEvent(t,"icecandidate",function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"}),e}))},n.shimRTCIceCandidateRelayProtocol=function(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||r.wrapPeerConnectionEvent(e,"icecandidate",function(e){var t;return e.candidate&&"relay"===(t=a.default.parseCandidate(e.candidate.candidate)).type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24]),e})},n.shimSendThrowTypeError=function(e){var t;function n(t,n){var r=t.send;t.send=function(){var e=arguments[0],e=e.length||e.size||e.byteLength;if("open"===t.readyState&&n.sctp&&e>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return r.apply(t,arguments)}}e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype&&(t=e.RTCPeerConnection.prototype.createDataChannel,e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},r.wrapPeerConnectionEvent(e,"datachannel",function(e){return n(e.channel,e.target),e}))};var a=(n=e("sdp"))&&n.__esModule?n:{default:n},r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var i;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(e("./utils"));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"./utils":11,sdp:12}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimAddTransceiver=function(e){var o;"object"===c(e)&&e.RTCPeerConnection&&(o=e.RTCPeerConnection.prototype.addTransceiver)&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e,t=arguments[1]&&arguments[1].sendEncodings,n=0<(t=function(e){if(Array.isArray(e))return a(e)}(n=t=void 0===t?[]:t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){var n;if(e)return"string"==typeof e?a(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).length,r=(n&&t.forEach(function(e){if("rid"in e)if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(1<=parseFloat(e.scaleResolutionDownBy)))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(0<=parseFloat(e.maxFramerate)))throw new RangeError("max_framerate must be >= 0.0")}),o.apply(this,arguments));return!n||"encodings"in(n=(e=r.sender).getParameters())&&(1!==n.encodings.length||0!==Object.keys(n.encodings[0]).length)||(n.encodings=t,e.sendEncodings=t,this.setParametersPromises.push(e.setParameters(n).then(function(){delete e.sendEncodings}).catch(function(){delete e.sendEncodings}))),r})},n.shimCreateAnswer=function(e){var n;"object"===c(e)&&e.RTCPeerConnection&&(n=e.RTCPeerConnection.prototype.createAnswer,e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,t=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return n.apply(t,e)}).finally(function(){t.setParametersPromises=[]}):n.apply(this,arguments)})},n.shimCreateOffer=function(e){var n;"object"===c(e)&&e.RTCPeerConnection&&(n=e.RTCPeerConnection.prototype.createOffer,e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,t=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return n.apply(t,e)}).finally(function(){t.setParametersPromises=[]}):n.apply(this,arguments)})},Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),n.shimGetParameters=function(e){var t;"object"===c(e)&&e.RTCRtpSender&&(t=e.RTCRtpSender.prototype.getParameters)&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return o.shimGetUserMedia}}),n.shimOnTrack=function(e){"object"===c(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(r,o){var i,n;"object"===c(r)&&(r.RTCPeerConnection||r.mozRTCPeerConnection)&&(!r.RTCPeerConnection&&r.mozRTCPeerConnection&&(r.RTCPeerConnection=r.mozRTCPeerConnection),o.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=r.RTCPeerConnection.prototype[e],n=function(e,t,n){(t=function(e){e=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===c(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},e,function(){return arguments[0]=new("addIceCandidate"===e?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)});r.RTCPeerConnection.prototype[e]=n[e]}),i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=r.RTCPeerConnection.prototype.getStats,r.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),t=e[0],r=e[1],e=e[2];return n.apply(this,[t||null]).then(function(n){if(o.version<53&&!r)try{n.forEach(function(e){e.type=i[e.type]||e.type})}catch(e){if("TypeError"!==e.name)throw e;n.forEach(function(e,t){n.set(t,Object.assign({},e,{type:i[e.type]||e.type}))})}return n}).then(r,e)})},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimReceiverGetStats=function(e){var n;"object"===c(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype||((n=e.RTCPeerConnection.prototype.getReceivers)&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),r.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}))},n.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(t){var n=this;r.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(e){e.track&&t.getTracks().includes(e.track)&&n.removeTrack(e)})})},n.shimSenderGetStats=function(e){var n,t;"object"===c(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype||((n=e.RTCPeerConnection.prototype.getSenders)&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),(t=e.RTCPeerConnection.prototype.addTrack)&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}))};var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var i;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(e("../utils")),o=e("./getusermedia"),i=e("./getdisplaymedia");function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":11,"./getdisplaymedia":8,"./getusermedia":9}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(t,n){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(e){return e&&e.video?(!0===e.video?e.video={mediaSource:n}:e.video.mediaSource=n,t.navigator.mediaDevices.getUserMedia(e)):((e=new DOMException("getDisplayMedia without video constraints is undefined")).name="NotFoundError",e.code=8,Promise.reject(e))})}},{}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e,t){var r=e&&e.navigator,e=e&&e.MediaStreamTrack;{var n,o,i,s;r.getUserMedia=function(e,t,n){a.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,n)},55<t.version&&"autoGainControl"in r.mediaDevices.getSupportedConstraints()||(n=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},o=r.mediaDevices.getUserMedia.bind(r.mediaDevices),r.mediaDevices.getUserMedia=function(e){return"object"===c(e)&&"object"===c(e.audio)&&(e=JSON.parse(JSON.stringify(e)),n(e.audio,"autoGainControl","mozAutoGainControl"),n(e.audio,"noiseSuppression","mozNoiseSuppression")),o(e)},e&&e.prototype.getSettings&&(i=e.prototype.getSettings,e.prototype.getSettings=function(){var e=i.apply(this,arguments);return n(e,"mozAutoGainControl","autoGainControl"),n(e,"mozNoiseSuppression","noiseSuppression"),e}),e&&e.prototype.applyConstraints&&(s=e.prototype.applyConstraints,e.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===c(e)&&(e=JSON.parse(JSON.stringify(e)),n(e,"autoGainControl","mozAutoGainControl"),n(e,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[e])}))}};var a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var i;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(e("../utils"));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":11}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimAudioContext=function(e){"object"!==c(e)||e.AudioContext||(e.AudioContext=e.webkitAudioContext)},n.shimCallbacksAPI=function(e){var r,o,i,s,a,t;"object"===c(e)&&e.RTCPeerConnection&&(e=e.RTCPeerConnection.prototype,r=e.createOffer,o=e.createAnswer,i=e.setLocalDescription,s=e.setRemoteDescription,a=e.addIceCandidate,e.createOffer=function(e,t){var n=r.apply(this,[2<=arguments.length?arguments[2]:e]);return t?(n.then(e,t),Promise.resolve()):n},e.createAnswer=function(e,t){var n=o.apply(this,[2<=arguments.length?arguments[2]:e]);return t?(n.then(e,t),Promise.resolve()):n},t=function(e,t,n){e=i.apply(this,[e]);return n?(e.then(t,n),Promise.resolve()):e},e.setLocalDescription=t,t=function(e,t,n){e=s.apply(this,[e]);return n?(e.then(t,n),Promise.resolve()):e},e.setRemoteDescription=t,t=function(e,t,n){e=a.apply(this,[e]);return n?(e.then(t,n),Promise.resolve()):e},e.addIceCandidate=t)},n.shimConstraints=o,n.shimCreateOfferLegacy=function(e){var n=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var t;return e&&(void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio),t=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind}),!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo),t=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind}),!1===e.offerToReceiveVideo&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveVideo||t||this.addTransceiver("video",{direction:"recvonly"})),n.apply(this,arguments)}},n.shimGetUserMedia=function(e){var r=e&&e.navigator;{var t;r.mediaDevices&&r.mediaDevices.getUserMedia&&(e=r.mediaDevices,t=e.getUserMedia.bind(e),r.mediaDevices.getUserMedia=function(e){return t(o(e))})}!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=function(e,t,n){r.mediaDevices.getUserMedia(e).then(t,n)}.bind(r))},n.shimLocalStreamsAPI=function(e){var i;"object"===c(e)&&e.RTCPeerConnection&&("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"addStream"in e.RTCPeerConnection.prototype||(i=e.RTCPeerConnection.prototype.addTrack,e.RTCPeerConnection.prototype.addStream=function(t){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach(function(e){return i.call(n,e,t)}),t.getVideoTracks().forEach(function(e){return i.call(n,e,t)})},e.RTCPeerConnection.prototype.addTrack=function(e){for(var t=this,n=arguments.length,r=new Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r&&r.forEach(function(e){t._localStreams?t._localStreams.includes(e)||t._localStreams.push(e):t._localStreams=[e]}),i.apply(this,arguments)}),"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t,n=this,r=(this._localStreams||(this._localStreams=[]),this._localStreams.indexOf(e));-1!==r&&(this._localStreams.splice(r,1),t=e.getTracks(),this.getSenders().forEach(function(e){t.includes(e.track)&&n.removeTrack(e)}))}))},n.shimRTCIceServerUrls=function(e){var i;e.RTCPeerConnection&&(i=e.RTCPeerConnection,e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){for(var n=[],r=0;r<e.iceServers.length;r++){var o=e.iceServers[r];void 0===o.urls&&o.url?(s.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,n.push(o)):n.push(e.iceServers[r])}e.iceServers=n}return new i(e,t)},e.RTCPeerConnection.prototype=i.prototype,"generateCertificate"in i)&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return i.generateCertificate}})},n.shimRemoteStreamsAPI=function(e){var t;"object"===c(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams||[]}),"onaddstream"in e.RTCPeerConnection.prototype||(Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var n=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){var t;n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.includes(e)||(n._remoteStreams.push(e),(t=new Event("addstream")).stream=e,n.dispatchEvent(t))})})}}),t=e.RTCPeerConnection.prototype.setRemoteDescription,e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){var t;n._remoteStreams||(n._remoteStreams=[]),0<=n._remoteStreams.indexOf(e)||(n._remoteStreams.push(e),(t=new Event("addstream")).stream=e,n.dispatchEvent(t))})}),t.apply(n,arguments)}))},n.shimTrackEventTransceiver=function(e){"object"===c(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};var s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};t=a(t);if(t&&t.has(e))return t.get(e);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var i;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(e("../utils"));function a(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(a=function(e){return e?n:t})(e))}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return e&&void 0!==e.video?Object.assign({},e,{video:s.compactObject(e.video)}):e}},{"../utils":11}],11:[function(e,t,n){"use strict";function s(e,t,n){return(t=function(e){e=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===r(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.compactObject=function o(i){if(!c(i))return i;return Object.keys(i).reduce(function(e,t){var n=c(i[t]),r=n?o(i[t]):i[t],n=n&&!Object.keys(r).length;return void 0===r||n?e:Object.assign(e,s({},t,r))},{})},n.deprecated=function(e,t){i&&console.warn(e+" is deprecated, please use "+t+" instead.")},n.detectBrowser=function(e){var t,n={browser:null,version:null};return void 0!==e&&e.navigator&&e.navigator.userAgent?(t=e.navigator).mozGetUserMedia?(n.browser="firefox",n.version=a(t.userAgent,/Firefox\/(\d+)\./,1)):t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection?(n.browser="chrome",n.version=a(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):e.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./)?(n.browser="safari",n.version=a(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype):n.browser="Not a supported browser.":n.browser="Not a browser.",n},n.disableLog=function(e){return"boolean"==typeof e?(o=e)?"adapter.js logging disabled":"adapter.js logging enabled":new Error("Argument type: "+r(e)+". Please use a boolean.")},n.disableWarnings=function(e){return"boolean"==typeof e?(i=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled")):new Error("Argument type: "+r(e)+". Please use a boolean.")},n.extractVersion=a,n.filterStats=function(n,t,e){var r,o=e?"outbound-rtp":"inbound-rtp",i=new Map;return null!==t&&(r=[],n.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&r.push(e)}),r.forEach(function(t){n.forEach(function(e){e.type===o&&e.trackId===t.id&&u(n,e,i)})})),i},n.log=function(){"object"!==("undefined"==typeof window?"undefined":r(window))||o||"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)},n.walkStats=u,n.wrapPeerConnectionEvent=function(e,r,o){var i,s;e.RTCPeerConnection&&(e=e.RTCPeerConnection.prototype,i=e.addEventListener,e.addEventListener=function(e,t){var n;return e!==r?i.apply(this,arguments):(n=function(e){e=o(e);e&&(t.handleEvent?t.handleEvent(e):t(e))},this._eventMap=this._eventMap||{},this._eventMap[r]||(this._eventMap[r]=new Map),this._eventMap[r].set(t,n),i.apply(this,[e,n]))},s=e.removeEventListener,e.removeEventListener=function(e,t){var n;return e===r&&this._eventMap&&this._eventMap[r]&&this._eventMap[r].has(t)?(n=this._eventMap[r].get(t),this._eventMap[r].delete(t),0===this._eventMap[r].size&&delete this._eventMap[r],0===Object.keys(this._eventMap).length&&delete this._eventMap,s.apply(this,[e,n])):s.apply(this,arguments)},Object.defineProperty(e,"on"+r,{get:function(){return this["_on"+r]},set:function(e){this["_on"+r]&&(this.removeEventListener(r,this["_on"+r]),delete this["_on"+r]),e&&this.addEventListener(r,this["_on"+r]=e)},enumerable:!0,configurable:!0}))};var o=!0,i=!0;function a(e,t,n){e=e.match(t);return e&&e.length>=n&&parseInt(e[n],10)}function c(e){return"[object Object]"===Object.prototype.toString.call(e)}function u(t,n,r){n&&!r.has(n.id)&&(r.set(n.id,n),Object.keys(n).forEach(function(e){e.endsWith("Id")?u(t,t.get(n[e]),r):e.endsWith("Ids")&&n[e].forEach(function(e){u(t,t.get(e),r)})}))}},{}],12:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};u.localCName=u.generateIdentifier(),u.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},u.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(0<t?"m="+e:e).trim()+"\r\n"})},u.getDescription=function(e){e=u.splitSections(e);return e&&e[0]},u.getMediaSections=function(e){e=u.splitSections(e);return e.shift(),e},u.matchPrefix=function(e,t){return u.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},u.parseCandidate=function(e){for(var t=void 0,n={foundation:(t=(0===e.indexOf("a=candidate:")?e.substring(12):e.substring(10)).split(" "))[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:void 0===n[t[r]]&&(n[t[r]]=t[r+1])}return n},u.writeCandidate=function(e){var t=[],n=(t.push(e.foundation),e.component),n=(t.push("rtp"===n?1:"rtcp"===n?2:n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port),e.type);return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},u.parseIceOptions=function(e){return e.substring(14).split(" ")},u.parseRtpMap=function(e){var e=e.substring(9).split(" "),t={payloadType:parseInt(e.shift(),10)},e=e[0].split("/");return t.name=e[0],t.clockRate=parseInt(e[1],10),t.channels=3===e.length?parseInt(e[2],10):1,t.numChannels=t.channels,t},u.writeRtpMap=function(e){var t=e.payloadType,n=(void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType),e.channels||e.numChannels||1);return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},u.parseExtmap=function(e){e=e.substring(9).split(" ");return{id:parseInt(e[0],10),direction:0<e[0].indexOf("/")?e[0].split("/")[1]:"sendrecv",uri:e[1],attributes:e.slice(2).join(" ")}},u.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},u.parseFmtp=function(e){for(var t={},n=void 0,r=e.substring(e.indexOf(" ")+1).split(";"),o=0;o<r.length;o++)t[(n=r[o].trim().split("="))[0].trim()]=n[1];return t},u.writeFmtp=function(t){var n,e="",r=t.payloadType;return void 0!==t.preferredPayloadType&&(r=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length&&(n=[],Object.keys(t.parameters).forEach(function(e){void 0!==t.parameters[e]?n.push(e+"="+t.parameters[e]):n.push(e)}),e+="a=fmtp:"+r+" "+n.join(";")+"\r\n"),e},u.parseRtcpFb=function(e){e=e.substring(e.indexOf(" ")+1).split(" ");return{type:e.shift(),parameter:e.join(" ")}},u.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},u.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},r=e.indexOf(":",t);return-1<r?(n.attribute=e.substring(t+1,r),n.value=e.substring(r+1)):n.attribute=e.substring(t+1),n},u.parseSsrcGroup=function(e){e=e.substring(13).split(" ");return{semantics:e.shift(),ssrcs:e.map(function(e){return parseInt(e,10)})}},u.getMid=function(e){e=u.matchPrefix(e,"a=mid:")[0];if(e)return e.substring(6)},u.parseFingerprint=function(e){e=e.substring(14).split(" ");return{algorithm:e[0].toLowerCase(),value:e[1].toUpperCase()}},u.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:u.matchPrefix(e+t,"a=fingerprint:").map(u.parseFingerprint)}},u.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},u.parseCryptoLine=function(e){e=e.substring(9).split(" ");return{tag:parseInt(e[0],10),cryptoSuite:e[1],keyParams:e[2],sessionParams:e.slice(3)}},u.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===r(e.keyParams)?u.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},u.parseCryptoKeyParams=function(e){return 0!==e.indexOf("inline:")?null:{keyMethod:"inline",keySalt:(e=e.substring(7).split("|"))[0],lifeTime:e[1],mkiValue:e[2]?e[2].split(":")[0]:void 0,mkiLength:e[2]?e[2].split(":")[1]:void 0}},u.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},u.getCryptoParameters=function(e,t){return u.matchPrefix(e+t,"a=crypto:").map(u.parseCryptoLine)},u.getIceParameters=function(e,t){var n=u.matchPrefix(e+t,"a=ice-ufrag:")[0],e=u.matchPrefix(e+t,"a=ice-pwd:")[0];return n&&e?{usernameFragment:n.substring(12),password:e.substring(10)}:null},u.writeIceParameters=function(e){var t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},u.parseRtpParameters=function(e){var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=u.splitLines(e)[0].split(" ");t.profile=n[2];for(var r=3;r<n.length;r++){var o=n[r],i=u.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(i){var s=u.parseRtpMap(i),i=u.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=i.length?u.parseFmtp(i[0]):{},s.rtcpFeedback=u.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(u.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}u.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(u.parseExtmap(e))});var a=u.matchPrefix(e,"a=rtcp-fb:* ").map(u.parseRtcpFb);return t.codecs.forEach(function(e){a.forEach(function(t){e.rtcpFeedback.find(function(e){return e.type===t.type&&e.parameter===t.parameter})||e.rtcpFeedback.push(t)})}),t},u.writeRtpDescription=function(e,t){var n="",r=(n=(n=(n=(n=(n+="m="+e+" ")+(0<t.codecs.length?"9":"0"))+(" "+(t.profile||"UDP/TLS/RTP/SAVPF")+" "))+(t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n"))+"c=IN IP4 0.0.0.0\r\n"+"a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n=(n=(n+=u.writeRtpMap(e))+u.writeFmtp(e))+u.writeRtcpFb(e)}),0);return t.codecs.forEach(function(e){e.maxptime>r&&(r=e.maxptime)}),0<r&&(n+="a=maxptime:"+r+"\r\n"),t.headerExtensions&&t.headerExtensions.forEach(function(e){n+=u.writeExtmap(e)}),n},u.parseRtpEncodingParameters=function(e){var t=[],n=u.parseRtpParameters(e),r=-1!==n.fecMechanisms.indexOf("RED"),o=-1!==n.fecMechanisms.indexOf("ULPFEC"),i=u.matchPrefix(e,"a=ssrc:").map(function(e){return u.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),s=0<i.length&&i[0].ssrc,a=void 0,i=u.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substring(17).split(" ").map(function(e){return parseInt(e,10)})}),c=(0<i.length&&1<i[0].length&&i[0][0]===s&&(a=i[0][1]),n.codecs.forEach(function(e){"RTX"===e.name.toUpperCase()&&e.parameters.apt&&(e={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)},s&&a&&(e.rtx={ssrc:a}),t.push(e),r)&&((e=JSON.parse(JSON.stringify(e))).fec={ssrc:s,mechanism:o?"red+ulpfec":"red"},t.push(e))}),0===t.length&&s&&t.push({ssrc:s}),u.matchPrefix(e,"b="));return c.length&&(c=0===c[0].indexOf("b=TIAS:")?parseInt(c[0].substring(7),10):0===c[0].indexOf("b=AS:")?1e3*parseInt(c[0].substring(5),10)*.95-16e3:void 0,t.forEach(function(e){e.maxBitrate=c})),t},u.parseRtcpParameters=function(e){var t={},n=u.matchPrefix(e,"a=ssrc:").map(function(e){return u.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0],n=(n&&(t.cname=n.value,t.ssrc=n.ssrc),u.matchPrefix(e,"a=rtcp-rsize")),n=(t.reducedSize=0<n.length,t.compound=0===n.length,u.matchPrefix(e,"a=rtcp-mux"));return t.mux=0<n.length,t},u.writeRtcpParameters=function(e){var t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},u.parseMsid=function(e){var t=void 0,n=u.matchPrefix(e,"a=msid:");return 1===n.length?{stream:(t=n[0].substring(7).split(" "))[0],track:t[1]}:0<(n=u.matchPrefix(e,"a=ssrc:").map(function(e){return u.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute})).length?{stream:(t=n[0].value.split(" "))[0],track:t[1]}:void 0},u.parseSctpDescription=function(e){var t=u.parseMLine(e),n=u.matchPrefix(e,"a=max-message-size:"),r=void 0,n=(0<n.length&&(r=parseInt(n[0].substring(19),10)),isNaN(r)&&(r=65536),u.matchPrefix(e,"a=sctp-port:"));return 0<n.length?{port:parseInt(n[0].substring(12),10),protocol:t.fmt,maxMessageSize:r}:0<(n=u.matchPrefix(e,"a=sctpmap:")).length?(t=n[0].substring(10).split(" "),{port:parseInt(t[0],10),protocol:t[1],maxMessageSize:r}):void 0},u.writeSctpDescription=function(e,t){var n=[],n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"];return void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},u.generateSessionId=function(){return Math.random().toString().substr(2,22)},u.writeSessionBoilerplate=function(e,t,n){t=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||u.generateSessionId())+" "+t+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},u.getDirection=function(e,t){for(var n=u.splitLines(e),r=0;r<n.length;r++)switch(n[r]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[r].substring(2)}return t?u.getDirection(t):"sendrecv"},u.getKind=function(e){return u.splitLines(e)[0].split(" ")[0].substring(2)},u.isRejected=function(e){return"0"===e.split(" ",2)[1]},u.parseMLine=function(e){e=u.splitLines(e)[0].substring(2).split(" ");return{kind:e[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}},u.parseOLine=function(e){e=u.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:e[0],sessionId:e[1],sessionVersion:parseInt(e[2],10),netType:e[3],addressType:e[4],address:e[5]}},u.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=u.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"===(void 0===t?"undefined":r(t))&&(t.exports=u)},{}]},{},[1])(1)}),!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).SimpleWebRTC=e()}(function(){return function r(o,i,s){function a(t,e){if(!i[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}n=i[t]={exports:{}},o[t][0].call(n.exports,function(e){return a(o[t][1][e]||e)},n,n.exports,r,o,i,s)}return i[t].exports}for(var c="function"==typeof require&&require,e=0;e<s.length;e++)a(s[e]);return a}({1:[function(e,t,n){function r(e){if(e){var t,n=e;for(t in r.prototype)n[t]=r.prototype[t];return n}}(n.Emitter=r).prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)this._callbacks={};else{var n=this._callbacks["$"+e];if(n)if(1==arguments.length)delete this._callbacks["$"+e];else{for(var r,o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}0===n.length&&delete this._callbacks["$"+e]}}return this},r.prototype.emitReserved=r.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n)for(var r=0,o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],2:[function(e,t,n){var s=e("webrtc-adapter");t.exports=function(e,t,n){var r,o=t,i={autoplay:!0,mirror:!1,muted:!1,audio:!1,disableContextMenu:!1};if(n)for(r in n)i[r]=n[r];return o?"audio"===o.tagName.toLowerCase()&&(i.audio=!0):o=document.createElement(i.audio?"audio":"video"),i.disableContextMenu&&(o.oncontextmenu=function(e){e.preventDefault()}),i.autoplay&&(o.autoplay="autoplay"),o.muted=!!i.muted,i.audio||["","moz","webkit","o","ms"].forEach(function(e){o.style[e?e+"Transform":"transform"]=i.mirror?"scaleX(-1)":"scaleX(1)"}),"safari"===s.browserDetails.browser&&o.setAttribute("playsinline",!0),o.srcObject=e,o}},{"webrtc-adapter":85}],3:[function(t,o,e){!function(e){!function(){"use strict";var n=t("possible-typed-array-names"),r="undefined"==typeof globalThis?e:globalThis;o.exports=function(){for(var e=[],t=0;t<n.length;t++)"function"==typeof r[n[t]]&&(e[e.length]=n[t]);return e}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"possible-typed-array-names":63}],4:[function(e,t,n){"use strict";n.byteLength=function(e){var e=p(e),t=e[0],e=e[1];return 3*(t+e)/4-e},n.toByteArray=function(e){var t,n,r=p(e),o=r[0],r=r[1],i=new u(function(e,t){return 3*(e+t)/4-t}(o,r)),s=0,a=0<r?o-4:o;for(n=0;n<a;n+=4)t=c[e.charCodeAt(n)]<<18|c[e.charCodeAt(n+1)]<<12|c[e.charCodeAt(n+2)]<<6|c[e.charCodeAt(n+3)],i[s++]=t>>16&255,i[s++]=t>>8&255,i[s++]=255&t;2===r&&(t=c[e.charCodeAt(n)]<<2|c[e.charCodeAt(n+1)]>>4,i[s++]=255&t);1===r&&(t=c[e.charCodeAt(n)]<<10|c[e.charCodeAt(n+1)]<<4|c[e.charCodeAt(n+2)]>>2,i[s++]=t>>8&255,i[s++]=255&t);return i},n.fromByteArray=function(e){for(var t,n=e.length,r=n%3,o=[],i=0,s=n-r;i<s;i+=16383)o.push(function(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(function(e){return a[e>>18&63]+a[e>>12&63]+a[e>>6&63]+a[63&e]}(r));return o.join("")}(e,i,s<i+16383?s:i+16383));1==r?(t=e[n-1],o.push(a[t>>2]+a[t<<4&63]+"==")):2==r&&(t=(e[n-2]<<8)+e[n-1],o.push(a[t>>10]+a[t>>4&63]+a[t<<2&63]+"="));return o.join("")};for(var a=[],c=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,i=r.length;o<i;++o)a[o]=r[o],c[r.charCodeAt(o)]=o;function p(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("="),t=(e=-1===e?t:e)===t?0:4-e%4;return[e,t]}c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},{}],5:[function(A,e,x){!function(e){!function(){"use strict";var P=A("base64-js"),i=A("ieee754"),t=(x.Buffer=d,x.SlowBuffer=function(e){+e!=e&&(e=0);return d.alloc(+e)},x.INSPECT_MAX_BYTES=50,2147483647);function c(e){if(t<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');e=new Uint8Array(e);return e.__proto__=d.prototype,e}function d(e,t,n){if("number"!=typeof e)return r(e,t,n);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return s(e)}function r(e,t,n){if("string"==typeof e){var r=e,o=t;if(d.isEncoding(o="string"==typeof o&&""!==o?o:"utf8"))return i=0|f(r,o),s=c(i),s=(r=s.write(r,o))!==i?s.slice(0,r):s;throw new TypeError("Unknown encoding: "+o)}if(ArrayBuffer.isView(e))return u(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(O(e,ArrayBuffer)||e&&O(e.buffer,ArrayBuffer)){var i=e,r=t,s=n;if(r<0||i.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(i.byteLength<r+(s||0))throw new RangeError('"length" is outside of buffer bounds');return(i=void 0===r&&void 0===s?new Uint8Array(i):void 0===s?new Uint8Array(i,r):new Uint8Array(i,r,s)).__proto__=d.prototype,i}if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');o=e.valueOf&&e.valueOf();if(null!=o&&o!==e)return d.from(o,t,n);var a=function(e){{var t,n;if(d.isBuffer(e))return t=0|p(e.length),0!==(n=c(t)).length&&e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||j(e.length)?c(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return d.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function o(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function s(e){return o(e),c(e<0?0:0|p(e))}function u(e){for(var t=e.length<0?0:0|p(e.length),n=c(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function p(e){if(t<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+t.toString(16)+" bytes");return 0|e}function f(e,t){if(d.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||O(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=2<arguments.length&&!0===arguments[2];if(!r&&0===n)return 0;for(var o=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return _(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return R(e).length;default:if(o)return r?-1:_(e).length;t=(""+t).toLowerCase(),o=!0}}function n(e,t,n){var r,o=!1;if((t=void 0===t||t<0?0:t)>this.length)return"";if((n=void 0===n||n>this.length?this.length:n)<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":var i=this,s=t,a=n,c=i.length;(!a||a<0||c<a)&&(a=c);for(var u="",p=s=!s||s<0?0:s;p<a;++p)u+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(i[p]);return u;case"utf8":case"utf-8":return k(this,t,n);case"ascii":var d=this,c=t,f=n,l="";f=Math.min(d.length,f);for(var h=c;h<f;++h)l+=String.fromCharCode(127&d[h]);return l;case"latin1":case"binary":var m=this,s=t,y=n,g="";y=Math.min(m.length,y);for(var v=s;v<y;++v)g+=String.fromCharCode(m[v]);return g;case"base64":return b=this,r=n,0===(C=t)&&r===b.length?P.fromByteArray(b):P.fromByteArray(b.slice(C,r));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var b=t,C=n,S=this.slice(b,C),w="",T=0;T<S.length;T+=2)w+=String.fromCharCode(S[T]+256*S[T+1]);return w;default:if(o)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function a(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function l(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),(n=(n=j(n=+n)?o?0:e.length-1:n)<0?e.length+n:n)>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=d.from(t,r)),d.isBuffer(t))return 0===t.length?-1:h(e,t,n,r,o);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?(o?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,n):h(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function h(e,t,n,r,o){var i=1,s=e.length,a=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s/=i=2,a/=2,n/=2}function c(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(o)for(var u=-1,p=n;p<s;p++)if(c(e,p)===c(t,-1===u?0:p-u)){if(p-(u=-1===u?p:u)+1===a)return u*i}else-1!==u&&(p-=p-u),u=-1;else for(p=n=s<n+a?s-a:n;0<=p;p--){for(var d=!0,f=0;f<a;f++)if(c(e,p+f)!==c(t,f)){d=!1;break}if(d)return p}return-1}function y(e,t,n,r){return E(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function g(e,t,n,r){return E(function(e,t){for(var n,r,o=[],i=0;i<e.length&&!((t-=2)<0);++i)n=e.charCodeAt(i),r=n>>8,o.push(n%256),o.push(r);return o}(t,e.length-n),e,n,r)}function k(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,s,a,c,u=e[o],p=null,d=239<u?4:223<u?3:191<u?2:1;if(o+d<=n)switch(d){case 1:u<128&&(p=u);break;case 2:128==(192&(i=e[o+1]))&&127<(c=(31&u)<<6|63&i)&&(p=c);break;case 3:i=e[o+1],s=e[o+2],128==(192&i)&&128==(192&s)&&2047<(c=(15&u)<<12|(63&i)<<6|63&s)&&(c<55296||57343<c)&&(p=c);break;case 4:i=e[o+1],s=e[o+2],a=e[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&65535<(c=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)&&c<1114112&&(p=c)}null===p?(p=65533,d=1):65535<p&&(r.push((p-=65536)>>>10&1023|55296),p=56320|1023&p),r.push(p),o+=d}var f=r,l=f.length;if(l<=v)return String.fromCharCode.apply(String,f);for(var h="",m=0;m<l;)h+=String.fromCharCode.apply(String,f.slice(m,m+=v));return h}x.kMaxLength=t,(d.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&d[Symbol.species]===d&&Object.defineProperty(d,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),d.poolSize=8192,d.from=r,d.prototype.__proto__=Uint8Array.prototype,d.__proto__=Uint8Array,d.alloc=function(e,t,n){return t=t,n=n,o(e=e),!(e<=0)&&void 0!==t?"string"==typeof n?c(e).fill(t,n):c(e).fill(t):c(e)},d.allocUnsafe=s,d.allocUnsafeSlow=s,d.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==d.prototype},d.compare=function(e,t){if(O(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),O(t,Uint8Array)&&(t=d.from(t,t.offset,t.byteLength)),!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},d.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);if(void 0===t)for(o=t=0;o<e.length;++o)t+=e[o].length;for(var n=d.allocUnsafe(t),r=0,o=0;o<e.length;++o){var i=e[o];if(O(i,Uint8Array)&&(i=d.from(i)),!d.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,r),r+=i.length}return n},d.byteLength=f,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)a(this,t,t+1);return this},d.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)a(this,t,t+3),a(this,t+1,t+2);return this},d.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)a(this,t,t+7),a(this,t+1,t+6),a(this,t+2,t+5),a(this,t+3,t+4);return this},d.prototype.toLocaleString=d.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?k(this,0,e):n.apply(this,arguments)},d.prototype.equals=function(e){if(d.isBuffer(e))return this===e||0===d.compare(this,e);throw new TypeError("Argument must be a Buffer")},d.prototype.inspect=function(){var e="",t=x.INSPECT_MAX_BYTES,e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim();return this.length>t&&(e+=" ... "),"<Buffer "+e+">"},d.prototype.compare=function(e,t,n,r,o){if(O(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),!d.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),(t=void 0===t?0:t)<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(o<=r&&n<=t)return 0;if(o<=r)return-1;if(n<=t)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(i,s),c=this.slice(r,o),u=e.slice(t,n),p=0;p<a;++p)if(c[p]!==u[p]){i=c[p],s=u[p];break}return i<s?-1:s<i?1:0},d.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},d.prototype.indexOf=function(e,t,n){return l(this,e,t,n,!0)},d.prototype.lastIndexOf=function(e,t,n){return l(this,e,t,n,!1)},d.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||o<n)&&(n=o),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var i,s,a,c=!1;;)switch(r){case"hex":var u=this,p=e,d=t,f=n,l=(d=Number(d)||0,u.length-d);(!f||l<(f=Number(f)))&&(f=l),(l=p.length)/2<f&&(f=l/2);for(var h=0;h<f;++h){var m=parseInt(p.substr(2*h,2),16);if(j(m))return h;u[d+h]=m}return h;case"utf8":case"utf-8":return l=t,a=n,E(_(e,(s=this).length-l),s,l,a);case"ascii":return y(this,e,t,n);case"latin1":case"binary":return y(this,e,t,n);case"base64":return s=this,a=t,i=n,E(R(e),s,a,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return g(this,e,t,n);default:if(c)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),c=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var v=4096;function m(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function b(e,t,n,r,o,i){if(!d.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(o<t||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function C(e,t,n,r){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function S(e,t,n,r,o){return t=+t,n>>>=0,o||C(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function w(e,t,n,r,o){return t=+t,n>>>=0,o||C(e,0,n,8),i.write(e,t,n,r,52,8),n+8}d.prototype.slice=function(e,t){var n=this.length,n=((e=~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),t<e&&(t=e),this.subarray(e,t));return n.__proto__=d.prototype,n},d.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||m(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},d.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||m(e,t,this.length);for(var r=this[e+--t],o=1;0<t&&(o*=256);)r+=this[e+--t]*o;return r},d.prototype.readUInt8=function(e,t){return e>>>=0,t||m(e,1,this.length),this[e]},d.prototype.readUInt16LE=function(e,t){return e>>>=0,t||m(e,2,this.length),this[e]|this[e+1]<<8},d.prototype.readUInt16BE=function(e,t){return e>>>=0,t||m(e,2,this.length),this[e]<<8|this[e+1]},d.prototype.readUInt32LE=function(e,t){return e>>>=0,t||m(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},d.prototype.readUInt32BE=function(e,t){return e>>>=0,t||m(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},d.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||m(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return(o*=128)<=r&&(r-=Math.pow(2,8*t)),r},d.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||m(e,t,this.length);for(var r=t,o=1,i=this[e+--r];0<r&&(o*=256);)i+=this[e+--r]*o;return(o*=128)<=i&&(i-=Math.pow(2,8*t)),i},d.prototype.readInt8=function(e,t){return e>>>=0,t||m(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},d.prototype.readInt16LE=function(e,t){e>>>=0,t||m(e,2,this.length);t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},d.prototype.readInt16BE=function(e,t){e>>>=0,t||m(e,2,this.length);t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},d.prototype.readInt32LE=function(e,t){return e>>>=0,t||m(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},d.prototype.readInt32BE=function(e,t){return e>>>=0,t||m(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},d.prototype.readFloatLE=function(e,t){return e>>>=0,t||m(e,4,this.length),i.read(this,e,!0,23,4)},d.prototype.readFloatBE=function(e,t){return e>>>=0,t||m(e,4,this.length),i.read(this,e,!1,23,4)},d.prototype.readDoubleLE=function(e,t){return e>>>=0,t||m(e,8,this.length),i.read(this,e,!0,52,8)},d.prototype.readDoubleBE=function(e,t){return e>>>=0,t||m(e,8,this.length),i.read(this,e,!1,52,8)},d.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||b(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},d.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||b(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;0<=--o&&(i*=256);)this[t+o]=e/i&255;return t+n},d.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||b(this,e,t,1,255,0),this[t]=255&e,t+1},d.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||b(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||b(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||b(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},d.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||b(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeIntLE=function(e,t,n,r){e=+e,t>>>=0,r||b(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var o=0,i=1,s=0;for(this[t]=255&e;++o<n&&(i*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+n},d.prototype.writeIntBE=function(e,t,n,r){e=+e,t>>>=0,r||b(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var o=n-1,i=1,s=0;for(this[t+o]=255&e;0<=--o&&(i*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+n},d.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||b(this,e,t,1,127,-128),this[t]=255&(e=e<0?255+e+1:e),t+1},d.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||b(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||b(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||b(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},d.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||b(this,e,t,4,2147483647,-2147483648),this[t]=(e=e<0?4294967295+e+1:e)>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeFloatLE=function(e,t,n){return S(this,e,t,!0,n)},d.prototype.writeFloatBE=function(e,t,n){return S(this,e,t,!1,n)},d.prototype.writeDoubleLE=function(e,t,n){return w(this,e,t,!0,n)},d.prototype.writeDoubleBE=function(e,t,n){return w(this,e,t,!1,n)},d.prototype.copy=function(e,t,n,r){if(!d.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n=n||0,r||0===r||(r=this.length),t>=e.length&&(t=e.length),(r=0<r&&r<n?n:r)===n)return 0;if(0===e.length||0===this.length)return 0;if((t=t||0)<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length);var o=(r=e.length-t<r-n?e.length-t+n:r)-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var i=o-1;0<=i;--i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return o},d.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!d.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var o;1===e.length&&(o=e.charCodeAt(0),"utf8"===r&&o<128||"latin1"===r)&&(e=o)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");var i;if(!(n<=t))if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(i=t;i<n;++i)this[i]=e;else{var s=d.isBuffer(e)?e:d.from(e,r),a=s.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=s[i%a]}return this};var T=/[^+/0-9A-Za-z-_]/g;function _(e,t){t=t||1/0;for(var n,r=e.length,o=null,i=[],s=0;s<r;++s){if(55295<(n=e.charCodeAt(s))&&n<57344){if(!o){if(56319<n){-1<(t-=3)&&i.push(239,191,189);continue}if(s+1===r){-1<(t-=3)&&i.push(239,191,189);continue}o=n;continue}if(n<56320){-1<(t-=3)&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&-1<(t-=3)&&i.push(239,191,189);if(o=null,n<128){if(--t<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function R(e){return P.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(T,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function E(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function O(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function j(e){return e!=e}}.call(this)}.call(this,A("buffer").Buffer)},{"base64-js":4,buffer:5,ieee754:53}],6:[function(e,t,n){"use strict";var r=e("get-intrinsic"),o=e("./"),i=o(r("String.prototype.indexOf"));t.exports=function(e,t){t=r(e,!!t);return"function"==typeof t&&-1<i(e,".prototype.")?o(t):t}},{"./":7,"get-intrinsic":43}],7:[function(e,t,n){"use strict";function r(){return p(o,c,arguments)}var o=e("function-bind"),i=e("get-intrinsic"),s=e("set-function-length"),a=e("es-errors/type"),c=i("%Function.prototype.apply%"),u=i("%Function.prototype.call%"),p=i("%Reflect.apply%",!0)||o.call(u,c),e=e("es-define-property"),d=i("%Math.max%");t.exports=function(e){if("function"!=typeof e)throw new a("a function is required");var t=p(o,u,arguments);return s(t,1+d(0,e.length-(arguments.length-1)),!0)};e?e(t.exports,"apply",{value:r}):t.exports.apply=r},{"es-define-property":31,"es-errors/type":37,"function-bind":42,"get-intrinsic":43,"set-function-length":72}],8:[function(n,o,r){!function(t){!function(){r.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+o.exports.humanize(this.diff),this.useColors){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");let t=0,n=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(t++,"%c"===e)&&(n=t)}),e.splice(n,0,r)}},r.save=function(e){try{e?r.storage.setItem("debug",e):r.storage.removeItem("debug")}catch(e){}},r.load=function(){let e;try{e=r.storage.getItem("debug")}catch(e){}!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG);return e},r.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},r.storage=function(){try{return localStorage}catch(e){}}(),r.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],r.log=console.debug||console.log||(()=>{}),o.exports=n("./common")(r);var e=o.exports["formatters"];e.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}.call(this)}.call(this,n("_process"))},{"./common":9,_process:64}],9:[function(e,t,n){t.exports=function(t){function a(e){let n,t=null,r,o;function s(...o){if(s.enabled){const i=s;var e=Number(new Date),t=e-(n||e);i.diff=t,i.prev=n,i.curr=e,n=e,o[0]=a.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");let r=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(e,t)=>{if("%%"===e)return"%";r++;var n,t=a.formatters[t];return"function"==typeof t&&(n=o[r],e=t.call(i,n),o.splice(r,1),r--),e}),a.formatArgs.call(i,o),(i.log||a.log).apply(i,o)}}return s.namespace=e,s.useColors=a.useColors(),s.color=a.selectColor(e),s.extend=i,s.destroy=a.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==t?t:(r!==a.namespaces&&(r=a.namespaces,o=a.enabled(e)),o),set:e=>{t=e}}),"function"==typeof a.init&&a.init(s),s}function i(e,t){t=a(this.namespace+(void 0===t?":":t)+e);return t.log=this.log,t}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return((a.debug=a).default=a).coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},a.disable=function(){var e=[...a.names.map(n),...a.skips.map(n).map(e=>"-"+e)].join(",");return a.enable(""),e},a.enable=function(e){a.save(e),a.namespaces=e,a.names=[],a.skips=[];let t;var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?a.skips.push(new RegExp("^"+e.slice(1)+"$")):a.names.push(new RegExp("^"+e+"$")))},a.enabled=function(e){if("*"===e[e.length-1])return!0;let t,n;for(t=0,n=a.skips.length;t<n;t++)if(a.skips[t].test(e))return!1;for(t=0,n=a.names.length;t<n;t++)if(a.names[t].test(e))return!0;return!1},a.humanize=e("ms"),a.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach(e=>{a[e]=t[e]}),a.names=[],a.skips=[],a.formatters={},a.selectColor=function(t){let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return a.colors[Math.abs(n)%a.colors.length]},a.enable(a.load()),a}},{ms:62}],10:[function(e,t,n){"use strict";var c=e("es-define-property"),u=e("es-errors/syntax"),p=e("es-errors/type"),d=e("gopd");t.exports=function(e,t,n){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new p("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=typeof t)throw new p("`property` must be a string or a symbol`");if(3<arguments.length&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new p("`nonEnumerable`, if provided, must be a boolean or null");if(4<arguments.length&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new p("`nonWritable`, if provided, must be a boolean or null");if(5<arguments.length&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new p("`nonConfigurable`, if provided, must be a boolean or null");if(6<arguments.length&&"boolean"!=typeof arguments[6])throw new p("`loose`, if provided, must be a boolean");var r=3<arguments.length?arguments[3]:null,o=4<arguments.length?arguments[4]:null,i=5<arguments.length?arguments[5]:null,s=6<arguments.length&&arguments[6],a=!!d&&d(e,t);if(c)c(e,t,{configurable:null===i&&a?a.configurable:!i,enumerable:null===r&&a?a.enumerable:!r,value:n,writable:null===o&&a?a.writable:!o});else{if(!s&&(r||o||i))throw new u("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=n}}},{"es-define-property":31,"es-errors/syntax":36,"es-errors/type":37,gopd:45}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.hasCORS=void 0;let r=!1;try{r="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}n.hasCORS=r},{}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.decode=n.encode=void 0,n.encode=function(e){let t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},n.decode=function(e){var n={},r=e.split("&");for(let e=0,t=r.length;e<t;e++){var o=r[e].split("=");n[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return n}},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.parse=void 0;const a=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,c=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];n.parse=function(e){if(2e3<e.length)throw"URI too long";var t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let o=a.exec(e||""),i={},s=14;for(;s--;)i[c[s]]=o[s]||"";return-1!=n&&-1!=r&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=function(e){var t=e.replace(/\/{2,9}/g,"/").split("/");"/"!=e.slice(0,1)&&0!==e.length||t.splice(0,1);"/"==e.slice(-1)&&t.splice(t.length-1,1);return t}(i.path),i.queryKey=function(e){const r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,n){t&&(r[t]=n)}),r}(i.query),i}},{}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.yeast=n.decode=n.encode=void 0;const r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o={};let i=0,s=0,a;function c(e){let t="";for(;t=r[e%64]+t,0<(e=Math.floor(e/64)););return t}for(n.encode=c,n.decode=function(e){let t=0;for(s=0;s<e.length;s++)t=64*t+o[e.charAt(s)];return t},n.yeast=function(){var e=c(+new Date);return e!==a?(i=0,a=e):e+"."+c(i++)};s<64;s++)o[r[s]]=s},{}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.globalThisShim=void 0,n.globalThisShim="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},{}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.nextTick=n.parse=n.installTimerFunctions=n.transports=n.TransportError=n.Transport=n.protocol=n.Socket=void 0;const r=e("./socket.js");Object.defineProperty(n,"Socket",{enumerable:!0,get:function(){return r.Socket}}),n.protocol=r.Socket.protocol;var o=e("./transport.js"),i=(Object.defineProperty(n,"Transport",{enumerable:!0,get:function(){return o.Transport}}),Object.defineProperty(n,"TransportError",{enumerable:!0,get:function(){return o.TransportError}}),e("./transports/index.js")),s=(Object.defineProperty(n,"transports",{enumerable:!0,get:function(){return i.transports}}),e("./util.js")),a=(Object.defineProperty(n,"installTimerFunctions",{enumerable:!0,get:function(){return s.installTimerFunctions}}),e("./contrib/parseuri.js")),c=(Object.defineProperty(n,"parse",{enumerable:!0,get:function(){return a.parse}}),e("./transports/websocket-constructor.js"));Object.defineProperty(n,"nextTick",{enumerable:!0,get:function(){return c.nextTick}})},{"./contrib/parseuri.js":13,"./socket.js":17,"./transport.js":18,"./transports/index.js":19,"./transports/websocket-constructor.js":21,"./util.js":25}],17:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Socket=void 0;const o=e("./transports/index.js"),i=e("./util.js"),s=e("./contrib/parseqs.js"),a=e("./contrib/parseuri.js");var r=r(e("debug")),c=e("@socket.io/component-emitter");const u=e("engine.io-parser"),p=e("./transports/websocket-constructor.js"),d=(0,r.default)("engine.io-client:socket");class f extends c.Emitter{constructor(e,t={}){super(),this.binaryType=p.defaultBinaryType,this.writeBuffer=[],e&&"object"==typeof e&&(t=e,e=null),e?(e=(0,a.parse)(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=(0,a.parse)(t.host).host),(0,i.installTimerFunctions)(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=(0,s.decode)(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname)&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1)),this.open()}createTransport(e){d('creating transport "%s"',e);var t=Object.assign({},this.opts.query),t=(t.EIO=u.protocol,t.transport=e,this.id&&(t.sid=this.id),Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]));return d("options: %j",t),new o.transports[e](t)}open(){let e;if(this.opts.rememberUpgrade&&f.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return d("error while creating transport: %s",e),this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){d("setting transport %s",e.name),this.transport&&(d("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),(this.transport=e).on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",e=>this.onClose("transport close",e))}probe(n){d('probing transport "%s"',n);let r=this.createTransport(n),t=!1;f.priorWebsocketSuccess=!1;const e=()=>{t||(d('probe transport "%s" opened',n),r.send([{type:"ping",data:"probe"}]),r.once("packet",e=>{t||("pong"===e.type&&"probe"===e.data?(d('probe transport "%s" pong',n),this.upgrading=!0,this.emitReserved("upgrading",r),r&&(f.priorWebsocketSuccess="websocket"===r.name,d('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{t||"closed"!==this.readyState&&(d("changing transport and sending upgrade packet"),u(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())}))):(d('probe transport "%s" failed',n),(e=new Error("probe error")).transport=r.name,this.emitReserved("upgradeError",e)))}))};function o(){t||(t=!0,u(),r.close(),r=null)}const i=e=>{var t=new Error("probe error: "+e);t.transport=r.name,o(),d('probe transport "%s" failed because of error: %s',n,e),this.emitReserved("upgradeError",t)};function s(){i("transport closed")}function a(){i("socket closed")}function c(e){r&&e.name!==r.name&&(d('"%s" works - aborting "%s"',e.name,r.name),o())}const u=()=>{r.removeListener("open",e),r.removeListener("error",i),r.removeListener("close",s),this.off("close",a),this.off("upgrading",c)};r.once("open",e),r.once("error",i),r.once("close",s),this.once("close",a),this.once("upgrading",c),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==n?this.setTimeoutFn(()=>{t||r.open()},200):r.open()}onOpen(){if(d("socket open"),this.readyState="open",f.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){d("starting upgrade probes");let e=0;for(var t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(d('socket receive: type "%s", data "%s"',e.type,e.data),this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}else d('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),(this.prevBufferLen=0)===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){var e;"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(e=this.getWritablePackets(),d("flushing %d packets in socket",e.length),this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush"))}getWritablePackets(){if(this.maxPayload&&"polling"===this.transport.name&&1<this.writeBuffer.length){let t=1;for(let e=0;e<this.writeBuffer.length;e++){var n=this.writeBuffer[e].data;if(n&&(t+=(0,i.byteLength)(n)),0<e&&t>this.maxPayload)return d("only send %d out of %d packets",e,this.writeBuffer.length),this.writeBuffer.slice(0,e);t+=2}d("payload size is %d (max: %d)",t,this.maxPayload)}return this.writeBuffer}write(e,t,n){return this.sendPacket("message",e,t,n),this}send(e,t,n){return this.sendPacket("message",e,t,n),this}sendPacket(e,t,n,r){"function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState&&((n=n||{}).compress=!1!==n.compress,this.emitReserved("packetCreate",e={type:e,data:t,options:n}),this.writeBuffer.push(e),r&&this.once("flush",r),this.flush())}close(){const e=()=>{this.onClose("forced close"),d("socket closing - telling transport to close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{(this.upgrading?n:e)()}):(this.upgrading?n:e)()),this}onError(e){d("socket error %j",e),f.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(d('socket close with reason: "%s"',e),this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){var t=[];let n=0;for(var r=e.length;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}(n.Socket=f).protocol=u.protocol},{"./contrib/parseqs.js":12,"./contrib/parseuri.js":13,"./transports/index.js":19,"./transports/websocket-constructor.js":21,"./util.js":25,"@socket.io/component-emitter":1,debug:8,"engine.io-parser":30}],18:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Transport=n.TransportError=void 0;const o=e("engine.io-parser");var i=e("@socket.io/component-emitter");const s=e("./util.js");r=r(e("debug"));const a=e("./contrib/parseqs.js"),c=(0,r.default)("engine.io-client:transport");class u extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}n.TransportError=u;class p extends i.Emitter{constructor(e){super(),(this.writable=!1,s.installTimerFunctions)(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,n){return super.emitReserved("error",new u(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState?this.write(e):c("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){e=(0,o.decodePacket)(e,this.socket.binaryType);this.onPacket(e)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){var e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){e=(0,a.encode)(e);return e.length?"?"+e:""}}n.Transport=p},{"./contrib/parseqs.js":12,"./util.js":25,"@socket.io/component-emitter":1,debug:8,"engine.io-parser":30}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.transports=void 0;var r=e("./polling.js"),o=e("./websocket.js"),e=e("./webtransport.js");n.transports={websocket:o.WS,webtransport:e.WT,polling:r.Polling}},{"./polling.js":20,"./websocket.js":22,"./webtransport.js":23}],20:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=(Object.defineProperty(n,"__esModule",{value:!0}),n.Request=n.Polling=void 0,e("../transport.js")),r=r(e("debug"));const i=e("../contrib/yeast.js"),s=e("engine.io-parser"),a=e("./xmlhttprequest.js");var c=e("@socket.io/component-emitter");const u=e("../util.js");e=e("../globalThis.js");const p=(0,r.default)("engine.io-client:polling");function d(){}const f=null!=new a.XHR({xdomain:!1}).responseType;class l extends o.Transport{constructor(t){if(super(t),this.polling=!1,"undefined"!=typeof location){var n="https:"===location.protocol;let e=location.port;e=e||(n?"443":"80"),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||e!==t.port}n=t&&t.forceBase64;this.supportsBinary=f&&!n,this.opts.withCredentials&&(this.cookieJar=(0,a.createCookieJar)())}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{p("paused"),this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(p("we are currently polling - waiting to pause"),e++,this.once("pollComplete",function(){p("pre-pause polling complete"),--e||t()})),this.writable||(p("we are currently writing - waiting to pause"),e++,this.once("drain",function(){p("pre-pause writing complete"),--e||t()}))}else t()}poll(){p("polling"),this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){p("polling got data %s",e);(0,s.decodePayload)(e,this.socket.binaryType).forEach(e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState?this.poll():p('ignoring poll - transport state "%s"',this.readyState))}doClose(){var e=()=>{p("writing close packet"),this.write([{type:"close"}])};"open"===this.readyState?(p("transport open - closing"),e()):(p("transport not open - deferring close"),this.once("open",e))}write(e){(this.writable=!1,s.encodePayload)(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){var e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=(0,i.yeast)()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new h(this.uri(),e)}doWrite(e,t){e=this.request({method:"POST",data:e});e.on("success",t),e.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){p("xhr poll");var e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}n.Polling=l;class h extends c.Emitter{constructor(e,t){super(),(0,u.installTimerFunctions)(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=void 0!==t.data?t.data:null,this.create()}create(){var e,t=(0,u.pick)(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;const n=this.xhr=new a.XHR(t);try{p("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders)for(var r in n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(r)&&n.setRequestHeader(r,this.opts.extraHeaders[r])}catch(e){}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}null!=(e=this.opts.cookieJar)&&e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&null!=(e=this.opts.cookieJar)&&e.parseCookies(n),4===n.readyState&&(200===n.status||1223===n.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"==typeof n.status?n.status:0)},0))},p("xhr data %s",this.data),n.send(this.data)}catch(e){return void this.setTimeoutFn(()=>{this.onError(e)},0)}"undefined"!=typeof document&&(this.index=h.requestsCount++,h.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=d,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete h.requests[this.index],this.xhr=null}}onLoad(){var e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}function m(){for(var e in h.requests)h.requests.hasOwnProperty(e)&&h.requests[e].abort()}(n.Request=h).requestsCount=0,h.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",m):"function"==typeof addEventListener&&(r="onpagehide"in e.globalThisShim?"pagehide":"unload",addEventListener(r,m,!1)))},{"../contrib/yeast.js":14,"../globalThis.js":15,"../transport.js":18,"../util.js":25,"./xmlhttprequest.js":24,"@socket.io/component-emitter":1,debug:8,"engine.io-parser":30}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.defaultBinaryType=n.usingBrowserWebSocket=n.WebSocket=n.nextTick=void 0;e=e("../globalThis.js");n.nextTick="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),n.WebSocket=e.globalThisShim.WebSocket||e.globalThisShim.MozWebSocket,n.usingBrowserWebSocket=!0,n.defaultBinaryType="arraybuffer"},{"../globalThis.js":15}],22:[function(p,e,d){!function(u){!function(){"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},t=(Object.defineProperty(d,"__esModule",{value:!0}),d.WS=void 0,p("../transport.js"));const n=p("../contrib/yeast.js"),r=p("../util.js"),o=p("./websocket-constructor.js");e=e(p("debug"));const i=p("engine.io-parser"),s=(0,e.default)("engine.io-client:websocket"),a="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class c extends t.Transport{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(this.check()){var e=this.uri(),t=this.opts.protocols,n=a?{}:(0,r.pick)(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=o.usingBrowserWebSocket&&!a?t?new o.WebSocket(e,t):new o.WebSocket(e):new o.WebSocket(e,t,n)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const n=t[e],r=e===t.length-1;(0,i.encodePacket)(n,this.supportsBinary,e=>{var t={};o.usingBrowserWebSocket||(n.options&&(t.compress=n.options.compress),this.opts.perMessageDeflate&&("string"==typeof e?u.byteLength(e):e.length)<this.opts.perMessageDeflate.threshold&&(t.compress=!1));try{o.usingBrowserWebSocket?this.ws.send(e):this.ws.send(e,t)}catch(e){s("websocket closed before onclose event")}r&&(0,o.nextTick)(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){var e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=(0,n.yeast)()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!o.WebSocket}}d.WS=c}.call(this)}.call(this,p("buffer").Buffer)},{"../contrib/yeast.js":14,"../transport.js":18,"../util.js":25,"./websocket-constructor.js":21,buffer:5,debug:8,"engine.io-parser":30}],23:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=(Object.defineProperty(n,"__esModule",{value:!0}),n.WT=void 0,e("../transport.js"));const i=e("./websocket-constructor.js"),s=e("engine.io-parser"),a=(0,r(e("debug")).default)("engine.io-client:webtransport");class c extends o.Transport{get name(){return"webtransport"}doOpen(){"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{a("transport closed gracefully"),this.onClose()}).catch(e=>{a("transport closed due to %s",e),this.onError("webtransport error",e)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(e=>{var t=(0,s.createPacketDecoderStream)(Number.MAX_SAFE_INTEGER,this.socket.binaryType);const n=e.readable.pipeThrough(t).getReader();t=(0,s.createPacketEncoderStream)();t.readable.pipeTo(e.writable),this.writer=t.writable.getWriter();const r=()=>{n.read().then(({done:e,value:t})=>{e?a("session is closed"):(a("received chunk: %o",t),this.onPacket(t),r())}).catch(e=>{a("an error occurred while reading: %s",e)})};r();e={type:"open"};this.query.sid&&(e.data=`{"sid":"${this.query.sid}"}`),this.writer.write(e).then(()=>this.onOpen())})}))}write(t){this.writable=!1;for(let e=0;e<t.length;e++){var n=t[e];const r=e===t.length-1;this.writer.write(n).then(()=>{r&&(0,i.nextTick)(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null!=(e=this.transport)&&e.close()}}n.WT=c},{"../transport.js":18,"./websocket-constructor.js":21,debug:8,"engine.io-parser":30}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createCookieJar=n.XHR=void 0;const r=e("../contrib/has-cors.js"),o=e("../globalThis.js");n.XHR=function(e){e=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||r.hasCORS))return new XMLHttpRequest}catch(e){}if(!e)try{return new o.globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(e){}},n.createCookieJar=function(){}},{"../contrib/has-cors.js":11,"../globalThis.js":15}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.byteLength=n.installTimerFunctions=n.pick=void 0;const r=e("./globalThis.js");n.pick=function(n,...e){return e.reduce((e,t)=>(n.hasOwnProperty(t)&&(e[t]=n[t]),e),{})};const o=r.globalThisShim.setTimeout,i=r.globalThisShim.clearTimeout;n.installTimerFunctions=function(e,t){t.useNativeTimers?(e.setTimeoutFn=o.bind(r.globalThisShim),e.clearTimeoutFn=i.bind(r.globalThisShim)):(e.setTimeoutFn=r.globalThisShim.setTimeout.bind(r.globalThisShim),e.clearTimeoutFn=r.globalThisShim.clearTimeout.bind(r.globalThisShim))};n.byteLength=function(e){if("string"!=typeof e)return Math.ceil(1.33*(e.byteLength||e.size));{var o=e;let n=0,r=0;for(let e=0,t=o.length;e<t;e++)(n=o.charCodeAt(e))<128?r+=1:n<2048?r+=2:n<55296||57344<=n?r+=3:(e++,r+=4);return r}}},{"./globalThis.js":15}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ERROR_PACKET=n.PACKET_TYPES_REVERSE=n.PACKET_TYPES=void 0;const r=Object.create(null),o=((n.PACKET_TYPES=r).open="0",r.close="1",r.ping="2",r.pong="3",r.message="4",r.upgrade="5",r.noop="6",Object.create(null));n.PACKET_TYPES_REVERSE=o,Object.keys(r).forEach(e=>{o[r[e]]=e});n.ERROR_PACKET={type:"error",data:"parser error"}},{}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.decode=n.encode=void 0;const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<i.length;e++)d[i.charCodeAt(e)]=e;n.encode=e=>{let t=new Uint8Array(e),n,r=t.length,o="";for(n=0;n<r;n+=3)o=(o=(o=(o+=i[t[n]>>2])+i[(3&t[n])<<4|t[n+1]>>4])+i[(15&t[n+1])<<2|t[n+2]>>6])+i[63&t[n+2]];return r%3==2?o=o.substring(0,o.length-1)+"=":r%3==1&&(o=o.substring(0,o.length-2)+"=="),o};n.decode=e=>{let t=.75*e.length,n=e.length,r,o=0,i,s,a,c;"="===e[e.length-1]&&(t--,"="===e[e.length-2])&&t--;var u=new ArrayBuffer(t),p=new Uint8Array(u);for(r=0;r<n;r+=4)i=d[e.charCodeAt(r)],s=d[e.charCodeAt(r+1)],a=d[e.charCodeAt(r+2)],c=d[e.charCodeAt(r+3)],p[o++]=i<<2|s>>4,p[o++]=(15&s)<<4|a>>2,p[o++]=(3&a)<<6|63&c;return u}},{}],28:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.decodePacket=void 0;const r=e("./commons.js"),o=e("./contrib/base64-arraybuffer.js"),i="function"==typeof ArrayBuffer;n.decodePacket=(e,t)=>{var n;return"string"!=typeof e?{type:"message",data:a(e,t)}:"b"===(n=e.charAt(0))?{type:"message",data:s(e.substring(1),t)}:r.PACKET_TYPES_REVERSE[n]?1<e.length?{type:r.PACKET_TYPES_REVERSE[n],data:e.substring(1)}:{type:r.PACKET_TYPES_REVERSE[n]}:r.ERROR_PACKET};const s=(e,t)=>{var n;return i?(n=(0,o.decode)(e),a(n,t)):{base64:!0,data:e}},a=(e,t)=>"blob"!==t?e instanceof ArrayBuffer?e:e.buffer:e instanceof Blob?e:new Blob([e])},{"./commons.js":26,"./contrib/base64-arraybuffer.js":27}],29:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.encodePacket=n.encodePacketToBinary=void 0;const o=e("./commons.js"),i="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),s="function"==typeof ArrayBuffer,a=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,r=({type:e,data:t},n,r)=>i&&t instanceof Blob?n?r(t):c(t,r):s&&(t instanceof ArrayBuffer||a(t))?n?r(t):c(new Blob([t]),r):r(o.PACKET_TYPES[e]+(t||"")),c=(n.encodePacket=r,(e,t)=>{const n=new FileReader;return n.onload=function(){var e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)});function u(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let p;n.encodePacketToBinary=function(e,t){return i&&e.data instanceof Blob?e.data.arrayBuffer().then(u).then(t):s&&(e.data instanceof ArrayBuffer||a(e.data))?t(u(e.data)):void r(e,!1,e=>{p=p||new TextEncoder,t(p.encode(e))})}},{"./commons.js":26}],30:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.decodePayload=n.decodePacket=n.encodePayload=n.encodePacket=n.protocol=n.createPacketDecoderStream=n.createPacketEncoderStream=void 0;const s=e("./encodePacket.js"),d=(Object.defineProperty(n,"encodePacket",{enumerable:!0,get:function(){return s.encodePacket}}),e("./decodePacket.js")),f=(Object.defineProperty(n,"decodePacket",{enumerable:!0,get:function(){return d.decodePacket}}),e("./commons.js")),a=String.fromCharCode(30);n.encodePayload=(e,n)=>{const r=e.length,o=new Array(r);let i=0;e.forEach((e,t)=>{(0,s.encodePacket)(e,!1,e=>{o[t]=e,++i===r&&n(o.join(a))})})};n.decodePayload=(e,t)=>{var n=e.split(a),r=[];for(let e=0;e<n.length;e++){var o=(0,d.decodePacket)(n[e],t);if(r.push(o),"error"===o.type)break}return r},n.createPacketEncoderStream=function(){return new TransformStream({transform(o,i){(0,s.encodePacketToBinary)(o,e=>{var t,n=e.length;let r;n<126?(r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,n)):n<65536?(r=new Uint8Array(3),(t=new DataView(r.buffer)).setUint8(0,126),t.setUint16(1,n)):(r=new Uint8Array(9),(t=new DataView(r.buffer)).setUint8(0,127),t.setBigUint64(1,BigInt(n))),o.data&&"string"!=typeof o.data&&(r[0]|=128),i.enqueue(r),i.enqueue(e)})}})};let l;function h(e){return e.reduce((e,t)=>e+t.length,0)}function m(t,n){if(t[0].length===n)return t.shift();var r=new Uint8Array(n);let o=0;for(let e=0;e<n;e++)r[e]=t[0][o++],o===t[0].length&&(t.shift(),o=0);return t.length&&o<t[0].length&&(t[0]=t[0].slice(o)),r}n.createPacketDecoderStream=function(i,s){l=l||new TextDecoder;const a=[];let c=0,u=-1,p=!1;return new TransformStream({transform(e,t){for(a.push(e);;){if(0===c){if(h(a)<1)break;var n=m(a,1);p=128==(128&n[0]),u=127&n[0],c=u<126?3:126===u?1:2}else if(1===c){if(h(a)<2)break;n=m(a,2);u=new DataView(n.buffer,n.byteOffset,n.length).getUint16(0),c=3}else if(2===c){if(h(a)<8)break;var r=m(a,8),r=new DataView(r.buffer,r.byteOffset,r.length),o=r.getUint32(0);if(o>Math.pow(2,21)-1){t.enqueue(f.ERROR_PACKET);break}u=o*Math.pow(2,32)+r.getUint32(4),c=3}else{if(h(a)<u)break;o=m(a,u);t.enqueue((0,d.decodePacket)(p?o:l.decode(o),s)),c=0}if(0===u||u>i){t.enqueue(f.ERROR_PACKET);break}}}})},n.protocol=4},{"./commons.js":26,"./decodePacket.js":28,"./encodePacket.js":29}],31:[function(t,e,n){"use strict";t=t("get-intrinsic")("%Object.defineProperty%",!0)||!1;if(t)try{t({},"a",{value:1})}catch(e){t=!1}e.exports=t},{"get-intrinsic":43}],32:[function(e,t,n){"use strict";t.exports=EvalError},{}],33:[function(e,t,n){"use strict";t.exports=Error},{}],34:[function(e,t,n){"use strict";t.exports=RangeError},{}],35:[function(e,t,n){"use strict";t.exports=ReferenceError},{}],36:[function(e,t,n){"use strict";t.exports=SyntaxError},{}],37:[function(e,t,n){"use strict";t.exports=TypeError},{}],38:[function(e,t,n){"use strict";t.exports=URIError},{}],39:[function(e,t,n){var r=e("wildemitter"),e=e("util");function o(e){r.call(this);var t,n=e||{};for(t in this.config={chunksize:16384,pacing:0},n)this.config[t]=n[t];this.file=null,this.channel=null}function i(){r.call(this),this.receiveBuffer=[],this.received=0,this.metadata={},this.channel=null}e.inherits(o,r),o.prototype.send=function(n,r){function o(){var e=new window.FileReader,t=(e.onload=function(e){i.channel.send(e.target.result),i.emit("progress",a,n.size,e.target.result),n.size>a+e.target.result.byteLength?s?window.setTimeout(o,i.config.pacing):r.bufferedAmount<=r.bufferedAmountLowThreshold&&window.setTimeout(o,0):(i.emit("progress",n.size,n.size,null),i.emit("sentFile")),a+=i.config.chunksize},n.slice(a,a+i.config.chunksize));e.readAsArrayBuffer(t)}var i=this,s=(this.file=n,"number"!=typeof(this.channel=r).bufferedAmountLowThreshold),a=0;s||(r.bufferedAmountLowThreshold=8*this.config.chunksize,r.addEventListener("bufferedamountlow",o)),window.setTimeout(o,0)},e.inherits(i,r),i.prototype.receive=function(e,t){var n=this;e&&(this.metadata=e),(this.channel=t).binaryType="arraybuffer",this.channel.onmessage=function(e){var t=e.data.byteLength;n.received+=t,n.receiveBuffer.push(e.data),n.emit("progress",n.received,n.metadata.size,e.data),n.received===n.metadata.size?(n.emit("receivedFile",new window.Blob(n.receiveBuffer),n.metadata),n.receiveBuffer=[]):n.received>n.metadata.size&&(console.error("received more than expected, discarding..."),n.receiveBuffer=[])}},t.exports={},t.exports.support="undefined"!=typeof window&&window&&window.File&&window.FileReader&&window.Blob,t.exports.Sender=o,t.exports.Receiver=i},{util:84,wildemitter:98}],40:[function(e,t,n){"use strict";var v=e("is-callable"),b=Object.prototype.toString,C=Object.prototype.hasOwnProperty;t.exports=function(e,t,n){if(!v(t))throw new TypeError("iterator must be a function");var r;if(3<=arguments.length&&(r=n),"[object Array]"===b.call(e))for(var o=e,i=t,s=r,a=0,c=o.length;a<c;a++)C.call(o,a)&&(null==s?i(o[a],a,o):i.call(s,o[a],a,o));else if("string"==typeof e)for(var u=e,p=t,d=r,f=0,l=u.length;f<l;f++)null==d?p(u.charAt(f),f,u):p.call(d,u.charAt(f),f,u);else{var h,m=e,y=t,g=r;for(h in m)C.call(m,h)&&(null==g?y(m[h],h,m):y.call(g,m[h],h,m))}}},{"is-callable":56}],41:[function(e,t,n){"use strict";function c(e,t){for(var n=[],r=0;r<e.length;r+=1)n[r]=e[r];for(var o=0;o<t.length;o+=1)n[o+e.length]=t[o];return n}var u=Object.prototype.toString,p=Math.max;t.exports=function(t){var n=this;if("function"!=typeof n||"[object Function]"!==u.apply(n))throw new TypeError("Function.prototype.bind called on incompatible "+n);for(var r,e,o=function(e,t){for(var n=[],r=t||0,o=0;r<e.length;r+=1,o+=1)n[o]=e[r];return n}(arguments,1),i=p(0,n.length-o.length),s=[],a=0;a<i;a++)s[a]="$"+a;return r=Function("binder","return function ("+function(e,t){for(var n="",r=0;r<e.length;r+=1)n+=e[r],r+1<e.length&&(n+=t);return n}(s,",")+"){ return binder.apply(this,arguments); }")(function(){var e;return this instanceof r?(e=n.apply(this,c(o,arguments)),Object(e)===e?e:this):n.apply(t,c(o,arguments))}),n.prototype&&((e=function(){}).prototype=n.prototype,r.prototype=new e,e.prototype=null),r}},{}],42:[function(e,t,n){"use strict";e=e("./implementation");t.exports=Function.prototype.bind||e},{"./implementation":41}],43:[function(e,t,n){"use strict";var r,o=e("es-errors"),i=e("es-errors/eval"),s=e("es-errors/range"),a=e("es-errors/ref"),f=e("es-errors/syntax"),l=e("es-errors/type"),c=e("es-errors/uri"),u=Function,p=function(e){try{return u('"use strict"; return ('+e+").constructor;")()}catch(e){}},h=Object.getOwnPropertyDescriptor;if(h)try{h({},"")}catch(e){h=null}function d(){throw new l}var m=h?function(){try{return d}catch(e){try{return h(arguments,"callee").get}catch(e){return d}}}():d,y=e("has-symbols")(),g=e("has-proto")(),v=Object.getPrototypeOf||(g?function(e){return e.__proto__}:null),b={},g="undefined"!=typeof Uint8Array&&v?v(Uint8Array):r,C={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":y&&v?v([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":b,"%AsyncGenerator%":b,"%AsyncGeneratorFunction%":b,"%AsyncIteratorPrototype%":b,"%Atomics%":"undefined"==typeof Atomics?r:Atomics,"%BigInt%":"undefined"==typeof BigInt?r:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?r:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":o,"%eval%":eval,"%EvalError%":i,"%Float32Array%":"undefined"==typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":u,"%GeneratorFunction%":b,"%Int8Array%":"undefined"==typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":y&&v?v(v([][Symbol.iterator]())):r,"%JSON%":"object"==typeof JSON?JSON:r,"%Map%":"undefined"==typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&y&&v?v((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?r:Promise,"%Proxy%":"undefined"==typeof Proxy?r:Proxy,"%RangeError%":s,"%ReferenceError%":a,"%Reflect%":"undefined"==typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&y&&v?v((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":y&&v?v(""[Symbol.iterator]()):r,"%Symbol%":y?Symbol:r,"%SyntaxError%":f,"%ThrowTypeError%":m,"%TypedArray%":g,"%TypeError%":l,"%Uint8Array%":"undefined"==typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?r:Uint32Array,"%URIError%":c,"%WeakMap%":"undefined"==typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?r:WeakSet};if(v)try{null.error}catch(e){o=v(v(e));C["%Error.prototype%"]=o}function S(e){var t,n;return"%AsyncFunction%"===e?t=p("async function () {}"):"%GeneratorFunction%"===e?t=p("function* () {}"):"%AsyncGeneratorFunction%"===e?t=p("async function* () {}"):"%AsyncGenerator%"===e?(n=S("%AsyncGeneratorFunction%"))&&(t=n.prototype):"%AsyncIteratorPrototype%"===e&&(n=S("%AsyncGenerator%"))&&v&&(t=v(n.prototype)),C[e]=t}var w={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},i=e("function-bind"),T=e("hasown"),P=i.call(Function.call,Array.prototype.concat),k=i.call(Function.apply,Array.prototype.splice),_=i.call(Function.call,String.prototype.replace),R=i.call(Function.call,String.prototype.slice),E=i.call(Function.call,RegExp.prototype.exec),O=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,j=/\\(\\)?/g;t.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new l("intrinsic name must be a non-empty string");if(1<arguments.length&&"boolean"!=typeof t)throw new l('"allowMissing" argument must be a boolean');if(null===E(/^%?[^%]*%?$/,e))throw new f("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=function(e){var t=R(e,0,1),n=R(e,-1);if("%"===t&&"%"!==n)throw new f("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new f("invalid intrinsic syntax, expected opening `%`");var o=[];return _(e,O,function(e,t,n,r){o[o.length]=n?_(r,j,"$1"):t||e}),o}(e),r=0<n.length?n[0]:"",o=function(e,t){var n,r=e;if(T(w,r)&&(r="%"+(n=w[r])[0]+"%"),T(C,r)){var o=C[r];if(void 0!==(o=o===b?S(r):o)||t)return{alias:n,name:r,value:o};throw new l("intrinsic "+e+" exists, but is not available. Please file an issue!")}throw new f("intrinsic "+e+" does not exist!")}("%"+r+"%",t),i=(o.name,o.value),s=!1,o=o.alias;o&&(r=o[0],k(n,P([0,1],o)));for(var a=1,c=!0;a<n.length;a+=1){var u=n[a],p=R(u,0,1),d=R(u,-1);if(('"'===p||"'"===p||"`"===p||'"'===d||"'"===d||"`"===d)&&p!==d)throw new f("property names with quotes must have matching quotes");if("constructor"!==u&&c||(s=!0),T(C,p="%"+(r+="."+u)+"%"))i=C[p];else if(null!=i){if(!(u in i)){if(t)return;throw new l("base intrinsic for "+e+" exists, but the property is not available.")}i=h&&a+1>=n.length?(c=!!(d=h(i,u)))&&"get"in d&&!("originalValue"in d.get)?d.get:i[u]:(c=T(i,u),i[u]),c&&!s&&(C[p]=i)}}return i}},{"es-errors":33,"es-errors/eval":32,"es-errors/range":34,"es-errors/ref":35,"es-errors/syntax":36,"es-errors/type":37,"es-errors/uri":38,"function-bind":42,"has-proto":48,"has-symbols":49,hasown:52}],44:[function(e,t,n){var i=e("webrtc-adapter");t.exports=function(t,e){var n,r=2===arguments.length,o=r?e:t;"getDisplayMedia"in window.navigator.mediaDevices?window.navigator.mediaDevices.getDisplayMedia(t).then(function(e){o(null,e)}).catch(function(e){o(e)}):"chrome"===i.browserDetails.browser?sessionStorage.getScreenMediaJSExtensionId?chrome.runtime.sendMessage(sessionStorage.getScreenMediaJSExtensionId,{type:"getScreen",id:1},null,function(e){e&&""!==e.sourceId?((t=r&&t||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3}}}).video.mandatory.chromeMediaSourceId=e.sourceId,window.navigator.mediaDevices.getUserMedia(t).then(function(e){o(null,e)}).catch(function(e){o(e)})):((e=new Error("NavigatorUserMediaError")).name="NotAllowedError",o(e))}):window.cefGetScreenMedia?window.cefGetScreenMedia(function(e){e?((t=r&&t||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3}}}).video.mandatory.chromeMediaSourceId=e,window.navigator.mediaDevices.getUserMedia(t).then(function(e){o(null,e)}).catch(function(e){o(e)})):((e=new Error("cefGetScreenMediaError")).name="CEF_GETSCREENMEDIA_CANCELED",o(e))}):((n=new Error("Screensharing is not supported")).name="NotSupportedError",o(n)):"firefox"===i.browserDetails.browser&&33<=i.browserDetails.version?(t=r&&t||{video:{mediaSource:"window"}},window.navigator.mediaDevices.getUserMedia(t).then(function(e){o(null,e)}).catch(function(e){o(e)})):((n=new Error("Screensharing is not supported")).name="NotSupportedError",o(n))}},{"webrtc-adapter":85}],45:[function(t,e,n){"use strict";t=t("get-intrinsic")("%Object.getOwnPropertyDescriptor%",!0);if(t)try{t([],"length")}catch(e){t=null}e.exports=t},{"get-intrinsic":43}],46:[function(e,t,n){var h,m=e("wildemitter");"undefined"!=typeof window&&(h=window.AudioContext||window.webkitAudioContext);var y=null;t.exports=function(e,t){var r=new m;if(h){var n,o,i,s=(t=t||{}).smoothing||.1,a=t.interval||50,c=t.threshold,u=t.play,p=t.history||10,d=!0;y=t.audioContext||y||new h,(i=y.createAnalyser()).fftSize=512,i.smoothingTimeConstant=s,o=new Float32Array(i.frequencyBinCount),e.jquery&&(e=e[0]),c=(e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(n=y.createMediaElementSource(e),void 0===u&&(u=!0)):n=y.createMediaStreamSource(e),c||-50),n.connect(i),u&&i.connect(y.destination),r.speaking=!1,r.suspend=function(){return y.suspend()},r.resume=function(){return y.resume()},Object.defineProperty(r,"state",{get:function(){return y.state}}),y.onstatechange=function(){r.emit("state_change",y.state)},r.setThreshold=function(e){c=e},r.setInterval=function(e){a=e},r.stop=function(){d=!1,r.emit("volume_change",-100,c),r.speaking&&(r.speaking=!1,r.emit("stopped_speaking")),i.disconnect(),n.disconnect()},r.speakingHistory=[];for(var f=0;f<p;f++)r.speakingHistory.push(0);function l(){setTimeout(function(){if(d){var e=function(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var r=4,o=t.length;r<o;r++)t[r]>n&&t[r]<0&&(n=t[r]);return n}(i,o),t=(r.emit("volume_change",e,c),0);if(c<e&&!r.speaking){for(var n=r.speakingHistory.length-3;n<r.speakingHistory.length;n++)t+=r.speakingHistory[n];2<=t&&(r.speaking=!0,r.emit("speaking"))}else if(e<c&&r.speaking){for(n=0;n<r.speakingHistory.length;n++)t+=r.speakingHistory[n];0==t&&(r.speaking=!1,r.emit("stopped_speaking"))}r.speakingHistory.shift(),r.speakingHistory.push(+(c<e)),l()}},a)}l()}return r}},{wildemitter:98}],47:[function(e,t,n){"use strict";function r(){return!!o}var o=e("es-define-property");r.hasArrayLengthDefineBug=function(){if(!o)return null;try{return 1!==o([],"length",{value:1}).length}catch(e){return!0}},t.exports=r},{"es-define-property":31}],48:[function(e,t,n){"use strict";var r={__proto__:null,foo:{}},o=Object;t.exports=function(){return{__proto__:r}.foo===r.foo&&!(r instanceof o)}},{}],49:[function(e,t,n){"use strict";var r="undefined"!=typeof Symbol&&Symbol,o=e("./shams");t.exports=function(){return"function"==typeof r&&"function"==typeof Symbol&&"symbol"==typeof r("foo")&&"symbol"==typeof Symbol("bar")&&o()}},{"./shams":50}],50:[function(e,t,n){"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"!=typeof Symbol.iterator){var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){n=Object.getOwnPropertyDescriptor(e,t);if(42!==n.value||!0!==n.enumerable)return!1}}return!0}},{}],51:[function(e,t,n){"use strict";var r=e("has-symbols/shams");t.exports=function(){return r()&&!!Symbol.toStringTag}},{"has-symbols/shams":50}],52:[function(e,t,n){"use strict";var r=Function.prototype.call,o=Object.prototype.hasOwnProperty,e=e("function-bind");t.exports=e.call(r,o)},{"function-bind":42}],53:[function(e,t,n){n.read=function(e,t,n,r,o){var i,s,a=8*o-r-1,c=(1<<a)-1,u=c>>1,p=-7,d=n?o-1:0,f=n?-1:1,o=e[t+d];for(d+=f,i=o&(1<<-p)-1,o>>=-p,p+=a;0<p;i=256*i+e[t+d],d+=f,p-=8);for(s=i&(1<<-p)-1,i>>=-p,p+=r;0<p;s=256*s+e[t+d],d+=f,p-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(o?-1:1);s+=Math.pow(2,r),i-=u}return(o?-1:1)*s*Math.pow(2,i-r)},n.write=function(e,t,n,r,o,i){var s,a,c=8*i-o-1,u=(1<<c)-1,p=u>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,l=r?1:-1,i=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(r=Math.pow(2,-s))<1&&(s--,r*=2),2<=(t+=1<=s+p?d/r:d*Math.pow(2,1-p))*r&&(s++,r/=2),u<=s+p?(a=0,s=u):1<=s+p?(a=(t*r-1)*Math.pow(2,o),s+=p):(a=t*Math.pow(2,p-1)*Math.pow(2,o),s=0));8<=o;e[n+f]=255&a,f+=l,a/=256,o-=8);for(s=s<<o|a,c+=o;0<c;e[n+f]=255&s,f+=l,s/=256,c-=8);e[n+f-l]|=128*i}},{}],54:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){var n;t&&(e.super_=t,(n=function(){}).prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e)}},{}],55:[function(e,t,n){"use strict";function r(e){return!(i&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===s(e)}function o(e){return!!r(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&0<=e.length&&"[object Array]"!==s(e)&&"[object Function]"===s(e.callee)}var i=e("has-tostringtag/shams")(),s=e("call-bind/callBound")("Object.prototype.toString"),e=function(){return r(arguments)}();r.isLegacyArguments=o,t.exports=e?r:o},{"call-bind/callBound":6,"has-tostringtag/shams":51}],56:[function(e,t,n){"use strict";var r,o,i=Function.prototype.toString,s="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof s&&"function"==typeof Object.defineProperty)try{r=Object.defineProperty({},"length",{get:function(){throw o}}),o={},s(function(){throw 42},null,r)}catch(e){e!==o&&(s=null)}else s=null;function a(e){try{var t=i.call(e);return u.test(t)}catch(e){return}}function c(e){try{return a(e)?!1:(i.call(e),!0)}catch(e){return!1}}var u=/^\s*class\b/,p=Object.prototype.toString,d="function"==typeof Symbol&&!!Symbol.toStringTag,f=!(0 in[,]),l=function(){return!1};"object"==typeof document&&p.call(document.all)===p.call(document.all)&&(l=function(e){if(!(!f&&e||void 0!==e&&"object"!=typeof e))try{var t=p.call(e);return("[object HTMLAllCollection]"===t||"[object HTML document.all class]"===t||"[object HTMLCollection]"===t||"[object Object]"===t)&&null==e("")}catch(e){}return!1}),t.exports=s?function(e){if(l(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;try{s(e,null,r)}catch(e){if(e!==o)return!1}return!a(e)&&c(e)}:function(e){var t;return!!l(e)||!!e&&!("function"!=typeof e&&"object"!=typeof e||!d&&(a(e)||"[object Function]"!==(t=p.call(e))&&"[object GeneratorFunction]"!==t&&!/^\[object HTML/.test(t)))&&c(e)}},{}],57:[function(e,t,n){"use strict";var r,o=Object.prototype.toString,i=Function.prototype.toString,s=/^\s*(?:function)?\*/,a=e("has-tostringtag/shams")(),c=Object.getPrototypeOf;t.exports=function(e){var t;return!("function"!=typeof e||!s.test(i.call(e))&&(a?!c||(void 0===r&&(t=function(){if(!a)return!1;try{return Function("return function*() {}")()}catch(e){}}(),r=!!t&&c(t)),c(e)!==r):"[object GeneratorFunction]"!==o.call(e)))}},{"has-tostringtag/shams":51}],58:[function(e,t,n){"use strict";var r=e("which-typed-array");t.exports=function(e){return!!r(e)}},{"which-typed-array":97}],59:[function(e,t,n){var r=e("util"),o=e("hark"),i=e("getscreenmedia"),s=e("wildemitter"),a=e("mockconsole");function c(e){s.call(this);var t,n=this.config={detectSpeakingEvents:!1,audioFallback:!1,media:{audio:!0,video:!0},harkOptions:null,logger:a};for(t in e)e.hasOwnProperty(t)&&(this.config[t]=e[t]);this.logger=n.logger,this._log=this.logger.log.bind(this.logger,"LocalMedia:"),this._logerror=this.logger.error.bind(this.logger,"LocalMedia:"),this.localStreams=[],this.localScreens=[],navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||this._logerror("Your browser does not support local media capture."),this._audioMonitors=[],this.on("localStreamStopped",this._stopAudioMonitor.bind(this)),this.on("localScreenStopped",this._stopAudioMonitor.bind(this))}r.inherits(c,s),c.prototype.start=function(e,t){var r=this,o=e||this.config.media;this.emit("localStreamRequested",o),navigator.mediaDevices.getUserMedia(o).then(function(n){if(o.audio&&r.config.detectSpeakingEvents&&r._setupAudioMonitor(n,r.config.harkOptions),r.localStreams.push(n),n.getTracks().forEach(function(e){e.addEventListener("ended",function(){var t;t=!0,n.getTracks().forEach(function(e){t="ended"===e.readyState&&t}),t&&r._removeStream(n)})}),r.emit("localStream",n),t)return t(null,n)}).catch(function(e){if(!r.config.audioFallback||"NotFoundError"!==e.name||!1===o.video)return r.emit("localStreamRequestFailed",o),t?t(e,null):void 0;o.video=!1,r.start(o,t)})},c.prototype.stop=function(e){this.stopStream(e),this.stopScreenShare(e)},c.prototype.stopStream=function(e){var t=this;e?-1<this.localStreams.indexOf(e)&&(e.getTracks().forEach(function(e){e.stop()}),this._removeStream(e)):this.localStreams.forEach(function(e){e.getTracks().forEach(function(e){e.stop()}),t._removeStream(e)})},c.prototype.startScreenShare=function(e,t){var r=this;this.emit("localScreenRequested"),"function"!=typeof e||t||(t=e,e=null),i(e,function(e,n){if(e?r.emit("localScreenRequestFailed"):(r.localScreens.push(n),n.getTracks().forEach(function(e){e.addEventListener("ended",function(){var t=!0;n.getTracks().forEach(function(e){t="ended"===e.readyState&&t}),t&&r._removeStream(n)})}),r.emit("localScreen",n)),t)return t(e,n)})},c.prototype.stopScreenShare=function(e){var t=this;e?-1<this.localScreens.indexOf(e)&&(e.getTracks().forEach(function(e){e.stop()}),this._removeStream(e)):this.localScreens.forEach(function(e){e.getTracks().forEach(function(e){e.stop()}),t._removeStream(e)})},c.prototype.mute=function(){this._audioEnabled(!1),this.emit("audioOff")},c.prototype.unmute=function(){this._audioEnabled(!0),this.emit("audioOn")},c.prototype.pauseVideo=function(){this._videoEnabled(!1),this.emit("videoOff")},c.prototype.resumeVideo=function(){this._videoEnabled(!0),this.emit("videoOn")},c.prototype.pause=function(){this.mute(),this.pauseVideo()},c.prototype.resume=function(){this.unmute(),this.resumeVideo()},c.prototype._audioEnabled=function(t){this.localStreams.forEach(function(e){e.getAudioTracks().forEach(function(e){e.enabled=!!t})})},c.prototype._videoEnabled=function(t){this.localStreams.forEach(function(e){e.getVideoTracks().forEach(function(e){e.enabled=!!t})})},c.prototype.isAudioEnabled=function(){var t=!0;return this.localStreams.forEach(function(e){e.getAudioTracks().forEach(function(e){t=t&&e.enabled})}),t},c.prototype.isVideoEnabled=function(){var t=!0;return this.localStreams.forEach(function(e){e.getVideoTracks().forEach(function(e){t=t&&e.enabled})}),t},c.prototype._removeStream=function(e){var t=this.localStreams.indexOf(e);-1<t?(this.localStreams.splice(t,1),this.emit("localStreamStopped",e)):-1<(t=this.localScreens.indexOf(e))&&(this.localScreens.splice(t,1),this.emit("localScreenStopped",e))},c.prototype._setupAudioMonitor=function(e,t){this._log("Setup audio");var n,t=o(e,t),r=this;t.on("speaking",function(){r.emit("speaking")}),t.on("stopped_speaking",function(){n&&clearTimeout(n),n=setTimeout(function(){r.emit("stoppedSpeaking")},1e3)}),t.on("volume_change",function(e,t){r.emit("volumeChange",e,t)}),this._audioMonitors.push({audio:t,stream:e})},c.prototype._stopAudioMonitor=function(n){var r=-1;this._audioMonitors.forEach(function(e,t){e.stream===n&&(r=t)}),-1<r&&(this._audioMonitors[r].audio.stop(),this._audioMonitors.splice(r,1))},t.exports=c},{getscreenmedia:44,hark:46,mockconsole:61,util:84,wildemitter:98}],60:[function(e,Le,Fe){!function(Ie){!function(){var r="__lodash_hash_undefined__",S=9007199254740991,w="[object Arguments]",F="[object Boolean]",N="[object Date]",T="[object Function]",B="[object GeneratorFunction]",P="[object Map]",U="[object Number]",k="[object Object]",z="[object Promise]",V="[object RegExp]",_="[object Set]",W="[object String]",G="[object Symbol]",n="[object WeakMap]",J="[object ArrayBuffer]",R="[object DataView]",q="[object Float32Array]",H="[object Float64Array]",K="[object Int8Array]",$="[object Int16Array]",Y="[object Int32Array]",X="[object Uint8Array]",Q="[object Uint8ClampedArray]",Z="[object Uint16Array]",ee="[object Uint32Array]",te=/\w*$/,ne=/^\[object .+?Constructor\]$/,re=/^(?:0|[1-9]\d*)$/,E={},e=(E[w]=E["[object Array]"]=E[J]=E[R]=E[F]=E[N]=E[q]=E[H]=E[K]=E[$]=E[Y]=E[P]=E[U]=E[k]=E[V]=E[_]=E[W]=E[G]=E[X]=E[Q]=E[Z]=E[ee]=!0,E["[object Error]"]=E[T]=E[n]=!1,"object"==typeof Ie&&Ie&&Ie.Object===Object&&Ie),t="object"==typeof self&&self&&self.Object===Object&&self,e=e||t||Function("return this")(),t="object"==typeof Fe&&Fe&&!Fe.nodeType&&Fe,o=t&&"object"==typeof Le&&Le&&!Le.nodeType&&Le,o=o&&o.exports===t;function oe(e,t){return e.set(t[0],t[1]),e}function ie(e,t){return e.add(t),e}function se(e,t,n,r){var o=-1,i=e?e.length:0;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}function ae(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function ce(e){var n=-1,r=Array(e.size);return e.forEach(function(e,t){r[++n]=[t,e]}),r}function i(t,n){return function(e){return t(n(e))}}function ue(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var t=Array.prototype,s=Function.prototype,a=Object.prototype,c=e["__core-js_shared__"],pe=(c=/[^.]+$/.exec(c&&c.keys&&c.keys.IE_PROTO||""))?"Symbol(src)_1."+c:"",de=s.toString,O=a.hasOwnProperty,u=a.toString,fe=RegExp("^"+de.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),c=o?e.Buffer:void 0,s=e.Symbol,le=e.Uint8Array,he=i(Object.getPrototypeOf,Object),me=Object.create,ye=a.propertyIsEnumerable,ge=t.splice,o=Object.getOwnPropertySymbols,t=c?c.isBuffer:void 0,ve=i(Object.keys,Object),c=b(e,"DataView"),p=b(e,"Map"),d=b(e,"Promise"),f=b(e,"Set"),e=b(e,"WeakMap"),l=b(Object,"create"),be=C(c),Ce=C(p),Se=C(d),we=C(f),Te=C(e),s=s?s.prototype:void 0,Pe=s?s.valueOf:void 0;function h(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function m(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function y(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function j(e){this.__data__=new m(e)}function ke(e,t){var n,r,o,i,s=D(e)||function(e){return function(e){return e&&"object"==typeof e}(e)&&xe(e)}(n=e)&&O.call(n,"callee")&&(!ye.call(n,"callee")||u.call(n)==w)?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],a=s.length,c=!!a;for(r in e)!t&&!O.call(e,r)||c&&("length"==r||(o=r,(i=null==(i=a)?S:i)&&("number"==typeof o||re.test(o))&&-1<o&&o%1==0&&o<i))||s.push(r);return s}function _e(e,t,n){var r=e[t];O.call(e,t)&&Ae(r,n)&&(void 0!==n||t in e)||(e[t]=n)}function g(e,t){for(var n=e.length;n--;)if(Ae(e[n][0],t))return n;return-1}function A(n,r,o,i,e,t,s){var a;if(void 0===(a=i?t?i(n,e,t,s):i(n):a)){if(!I(n))return n;e=D(n);if(e){if(a=function(e){var t=e.length,n=e.constructor(t);t&&"string"==typeof e[0]&&O.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(n),!r){var c=n,u=a,p=-1,d=c.length;for(u=u||Array(d);++p<d;)u[p]=c[p];return u}}else{var f,l,h=M(n),m=h==T||h==B;if(Me(n))return f=n,(l=r)?f.slice():(l=new f.constructor(f.length),f.copy(l),l);if(h==k||h==w||m&&!t){if(ae(n))return t?n:{};if(a="function"!=typeof(f=m?{}:n).constructor||je(f)?{}:function(e){return I(e)?me(e):{}}(he(f)),!r)return m=l=n,m=(g=a)&&Ee(m,L(m),g),Ee(l,Oe(l),m)}else{if(!E[h])return t?n:{};a=function(e,t,n,r){var o=e.constructor;switch(t){case J:return x(e);case F:case N:return new o(+e);case R:return function(e,t){t=t?x(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}(e,r);case q:case H:case K:case $:case Y:case X:case Q:case Z:case ee:return function(e,t){t=t?x(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}(e,r);case P:return function(e,t,n){return se(t?n(ce(e),!0):ce(e),oe,new e.constructor)}(e,r,n);case U:case W:return new o(e);case V:return function(e){var t=new e.constructor(e.source,te.exec(e));return t.lastIndex=e.lastIndex,t}(e);case _:return function(e,t,n){return se(t?n(ue(e),!0):ue(e),ie,new e.constructor)}(e,r,n);case G:return function(e){return Pe?Object(Pe.call(e)):{}}(e)}}(n,h,A,r)}}var y,g=(s=s||new j).get(n);if(g)return g;s.set(n,a);for(var v=(y=e?y:o?function(e,t,n){t=t(e);return D(e)?t:function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}(t,n(e))}(n,L,Oe):L(n))||n,b=function(e,t){y&&(e=n[t=e]),_e(a,t,A(e,r,o,i,t,n,s))},C=-1,S=v?v.length:0;++C<S&&!1!==b(v[C],C,v););}return a}function Re(e){var t;return I(e)&&(t=e,!(pe&&pe in t))&&(De(e)||ae(e)?fe:ne).test(C(e))}function x(e){var t=new e.constructor(e.byteLength);return new le(t).set(new le(e)),t}function Ee(e,t,n,r){n=n||{};for(var o=-1,i=t.length;++o<i;){var s=t[o],a=r?r(n[s],e[s],s,n,e):void 0;_e(n,s,void 0===a?e[s]:a)}return n}function v(e,t){var n,r,e=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?e["string"==typeof t?"string":"hash"]:e.map}function b(e,t){t=t;e=null==(e=e)?void 0:e[t];return Re(e)?e:void 0}h.prototype.clear=function(){this.__data__=l?l(null):{}},h.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},h.prototype.get=function(e){var t,n=this.__data__;return l?(t=n[e])===r?void 0:t:O.call(n,e)?n[e]:void 0},h.prototype.has=function(e){var t=this.__data__;return l?void 0!==t[e]:O.call(t,e)},h.prototype.set=function(e,t){return this.__data__[e]=l&&void 0===t?r:t,this},m.prototype.clear=function(){this.__data__=[]},m.prototype.delete=function(e){var t=this.__data__;return!((e=g(t,e))<0||(e==t.length-1?t.pop():ge.call(t,e,1),0))},m.prototype.get=function(e){var t=this.__data__;return(e=g(t,e))<0?void 0:t[e][1]},m.prototype.has=function(e){return-1<g(this.__data__,e)},m.prototype.set=function(e,t){var n=this.__data__,r=g(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},y.prototype.clear=function(){this.__data__={hash:new h,map:new(p||m),string:new h}},y.prototype.delete=function(e){return v(this,e).delete(e)},y.prototype.get=function(e){return v(this,e).get(e)},y.prototype.has=function(e){return v(this,e).has(e)},y.prototype.set=function(e,t){return v(this,e).set(e,t),this},j.prototype.clear=function(){this.__data__=new m},j.prototype.delete=function(e){return this.__data__.delete(e)},j.prototype.get=function(e){return this.__data__.get(e)},j.prototype.has=function(e){return this.__data__.has(e)},j.prototype.set=function(e,t){var n=this.__data__;if(n instanceof m){var r=n.__data__;if(!p||r.length<199)return r.push([e,t]),this;n=this.__data__=new y(r)}return n.set(e,t),this};var Oe=o?i(o,Object):function(){return[]},M=function(e){return u.call(e)};function je(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||a)}function C(e){if(null!=e){try{return de.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ae(e,t){return e===t||e!=e&&t!=t}(c&&M(new c(new ArrayBuffer(1)))!=R||p&&M(new p)!=P||d&&M(d.resolve())!=z||f&&M(new f)!=_||e&&M(new e)!=n)&&(M=function(e){var t=u.call(e),e=t==k?e.constructor:void 0,e=e?C(e):void 0;if(e)switch(e){case be:return R;case Ce:return P;case Se:return z;case we:return _;case Te:return n}return t});var D=Array.isArray;function xe(e){return null!=e&&"number"==typeof(t=e.length)&&-1<t&&t%1==0&&t<=S&&!De(e);var t}var Me=t||function(){return!1};function De(e){e=I(e)?u.call(e):"";return e==T||e==B}function I(e){var t=typeof e;return e&&("object"==t||"function"==t)}function L(e){return(xe(e)?ke:function(e){if(!je(e))return ve(e);var t,n=[];for(t in Object(e))O.call(e,t)&&"constructor"!=t&&n.push(t);return n})(e)}Le.exports=function(e){return A(e,!0,!0)}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],61:[function(e,t,n){function r(){}for(var o="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(","),i=o.length,s={};i--;)s[o[i]]=r;t.exports=s},{}],62:[function(e,t,n){var o=36e5,i=864e5;function s(e,t,n,r){t=1.5*n<=t;return Math.round(e/n)+" "+r+(t?"s":"")}t.exports=function(e,t){t=t||{};var n=typeof e;if(!("string"==n&&0<e.length)){if("number"==n&&isFinite(e))return(t.long?function(e){var t=Math.abs(e);if(i<=t)return s(e,t,i,"day");if(o<=t)return s(e,t,o,"hour");if(6e4<=t)return s(e,t,6e4,"minute");if(1e3<=t)return s(e,t,1e3,"second");return e+" ms"}:function(e){var t=Math.abs(e);if(i<=t)return Math.round(e/i)+"d";if(o<=t)return Math.round(e/o)+"h";if(6e4<=t)return Math.round(e/6e4)+"m";if(1e3<=t)return Math.round(e/1e3)+"s";return e+"ms"})(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}n=e;if(!(100<(n=String(n)).length)){n=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(n);if(n){var r=parseFloat(n[1]);switch((n[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return r*i;case"hours":case"hour":case"hrs":case"hr":case"h":return r*o;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}},{}],63:[function(e,t,n){"use strict";t.exports=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]},{}],64:[function(e,t,n){var r,o,t=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return(r=setTimeout)(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}var c,u=[],p=!1,d=-1;function f(){p&&c&&(p=!1,c.length?u=c.concat(u):d=-1,u.length)&&l()}function l(){if(!p){for(var e=a(f),t=(p=!0,u.length);t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,p=!1,!function(t){if(o===clearTimeout)return clearTimeout(t);if((o===s||!o)&&clearTimeout)return(o=clearTimeout)(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new h(e,t)),1!==u.length||p||a(l)},h.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=m,t.addListener=m,t.once=m,t.off=m,t.removeListener=m,t.removeAllListeners=m,t.emit=m,t.prependListener=m,t.prependOnceListener=m,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],65:[function(e,t,n){var r=e("util"),p=e("sdp-jingle-json"),o=e("wildemitter"),c=e("lodash.clonedeep");function i(e,t){var n,r=this;for(n in o.call(this),(e=e||{}).iceServers=e.iceServers||[],this.enableChromeNativeSimulcast=!1,t&&t.optional&&window.chrome&&null===navigator.appVersion.match(/Chromium\//)&&t.optional.forEach(function(e){e.enableChromeNativeSimulcast&&(r.enableChromeNativeSimulcast=!0)}),this.enableMultiStreamHacks=!1,t&&t.optional&&window.chrome&&t.optional.forEach(function(e){e.enableMultiStreamHacks&&(r.enableMultiStreamHacks=!0)}),this.restrictBandwidth=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetRestrictBandwidth&&(r.restrictBandwidth=e.andyetRestrictBandwidth)}),this.batchIceCandidates=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetBatchIce&&(r.batchIceCandidates=e.andyetBatchIce)}),this.batchedIceCandidates=[],t&&t.optional&&window.chrome&&t.optional.forEach(function(e){e.andyetFasterICE&&(r.eliminateDuplicateCandidates=e.andyetFasterICE)}),t&&t.optional&&t.optional.forEach(function(e){e.andyetDontSignalCandidates&&(r.dontSignalCandidates=e.andyetDontSignalCandidates)}),this.assumeSetLocalSuccess=!1,t&&t.optional&&t.optional.forEach(function(e){e.andyetAssumeSetLocalSuccess&&(r.assumeSetLocalSuccess=e.andyetAssumeSetLocalSuccess)}),window.navigator.mozGetUserMedia&&t&&t.optional&&(this.wtFirefox=0,t.optional.forEach(function(e){e.andyetFirefoxMakesMeSad&&(r.wtFirefox=e.andyetFirefoxMakesMeSad,0<r.wtFirefox)&&(r.firefoxcandidatebuffer=[])})),this.pc=new RTCPeerConnection(e,t),"function"==typeof this.pc.getLocalStreams?this.getLocalStreams=this.pc.getLocalStreams.bind(this.pc):this.getLocalStreams=function(){return[]},"function"==typeof this.pc.getSenders?this.getSenders=this.pc.getSenders.bind(this.pc):this.getSenders=function(){return[]},"function"==typeof this.pc.getRemoteStreams?this.getRemoteStreams=this.pc.getRemoteStreams.bind(this.pc):this.getRemoteStreams=function(){return[]},"function"==typeof this.pc.getReceivers?this.getReceivers=this.pc.getReceivers.bind(this.pc):this.getReceivers=function(){return[]},this.addStream=this.pc.addStream.bind(this.pc),this.removeStream=function(e){"function"==typeof r.pc.removeStream?r.pc.removeStream.apply(r.pc,arguments):"function"==typeof r.pc.removeTrack&&e.getTracks().forEach(function(e){r.pc.removeTrack(e)})},"function"==typeof this.pc.removeTrack&&(this.removeTrack=this.pc.removeTrack.bind(this.pc)),this.pc.onremovestream=this.emit.bind(this,"removeStream"),this.pc.onremovetrack=this.emit.bind(this,"removeTrack"),this.pc.onaddstream=this.emit.bind(this,"addStream"),this.pc.ontrack=this.emit.bind(this,"addTrack"),this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded"),this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange"),this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange"),this.pc.onicecandidate=this._onIce.bind(this),this.pc.ondatachannel=this._onDataChannel.bind(this),this.localDescription={contents:[]},this.remoteDescription={contents:[]},this.config={debug:!1,sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1},this.iceCredentials={local:{},remote:{}},e)this.config[n]=e[n];this.config.debug&&this.on("*",function(){(e.logger||console).log("PeerConnection event:",arguments)}),this.hadLocalStunCandidate=!1,this.hadRemoteStunCandidate=!1,this.hadLocalRelayCandidate=!1,this.hadRemoteRelayCandidate=!1,this.hadLocalIPv6Candidate=!1,this.hadRemoteIPv6Candidate=!1,this._remoteDataChannels=[],this._localDataChannels=[],this._candidateBuffer=[]}r.inherits(i,o),Object.defineProperty(i.prototype,"signalingState",{get:function(){return this.pc.signalingState}}),Object.defineProperty(i.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}}),i.prototype._role=function(){return this.isInitiator?"initiator":"responder"},i.prototype.addStream=function(t){(this.localStream=t).getTracks().forEach(function(e){this.pc.addTrack(e,t)})},i.prototype._checkLocalCandidate=function(e){e=p.toCandidateJSON(e);"srflx"==e.type?this.hadLocalStunCandidate=!0:"relay"==e.type&&(this.hadLocalRelayCandidate=!0),-1!=e.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)},i.prototype._checkRemoteCandidate=function(e){e=p.toCandidateJSON(e);"srflx"==e.type?this.hadRemoteStunCandidate=!0:"relay"==e.type&&(this.hadRemoteRelayCandidate=!0),-1!=e.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)},i.prototype.processIce=function(e,a){a=a||function(){};var c=this;if("closed"===this.pc.signalingState)return a();if(e.contents||e.jingle&&e.jingle.contents){var u=this.remoteDescription.contents.map(function(e){return e.name});(e.contents||e.jingle.contents).forEach(function(t){function e(){r.forEach(function(e){e=p.toCandidateSDP(e);c.pc.addIceCandidate(new RTCIceCandidate({candidate:e,sdpMLineIndex:o,sdpMid:i})).then(function(){},function(e){c.emit("error",e)}),c._checkRemoteCandidate(e)}),a()}var n=t.transport||{},r=n.candidates||[],o=u.indexOf(t.name),i=t.name,s=c.remoteDescription.contents.find(function(e){return e.name===t.name});c.iceCredentials.remote[t.name]&&n.ufrag&&c.iceCredentials.remote[t.name].ufrag!==n.ufrag?s?(s.transport.ufrag=n.ufrag,s.transport.pwd=n.pwd,(s={type:"offer",jingle:c.remoteDescription}).sdp=p.toSessionSDP(s.jingle,{sid:c.config.sdpSessionID,role:c._role(),direction:"incoming"}),c.pc.setRemoteDescription(new RTCSessionDescription(s)).then(function(){e()},function(e){c.emit("error",e)})):c.emit("error","ice restart failed to find matching content"):e()})}else{if(e.candidate&&0!==e.candidate.candidate.indexOf("a=")&&(e.candidate.candidate="a="+e.candidate.candidate),this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(e.candidate),a();c.pc.addIceCandidate(new RTCIceCandidate(e.candidate)).then(function(){},function(e){c.emit("error",e)}),c._checkRemoteCandidate(e.candidate.candidate),a()}},i.prototype.offer=function(e,r){var o=this,t=2===arguments.length,n=t&&e?e:{offerToReceiveAudio:1,offerToReceiveVideo:1};if(r=(r=t?r:e)||function(){},"closed"===this.pc.signalingState)return r("Already closed");this.pc.createOffer(n).then(function(t){var n={type:"offer",sdp:t.sdp};o.assumeSetLocalSuccess&&(o.emit("offer",n),r(null,n)),o._candidateBuffer=[],o.pc.setLocalDescription(t).then(function(){var e;o.config.useJingle&&((e=p.toSessionJSON(t.sdp,{role:o._role(),direction:"outgoing"})).sid=o.config.sid,(o.localDescription=e).contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(o.iceCredentials.local[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),n.jingle=e),n.sdp.split(/\r?\n/).forEach(function(e){0===e.indexOf("a=candidate:")&&o._checkLocalCandidate(e)}),o.assumeSetLocalSuccess||(o.emit("offer",n),r(null,n))},function(e){o.emit("error",e),r(e)})},function(e){o.emit("error",e),r(e)})},i.prototype.handleOffer=function(e,t){t=t||function(){};var n,r=this;e.type="offer",e.jingle&&(this.enableChromeNativeSimulcast&&e.jingle.contents.forEach(function(e){"video"===e.name&&(e.application.googConferenceFlag=!0)}),this.enableMultiStreamHacks&&e.jingle.contents.forEach(function(e){var t;"video"!==e.name||0!==(t=e.application.sources||[]).length&&"3735928559"===t[0].ssrc||(t.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),e.application.sources=t)}),0<r.restrictBandwidth&&2<=e.jingle.contents.length&&"video"===e.jingle.contents[1].name&&((n=e.jingle.contents[1]).application&&n.application.bandwidth&&n.application.bandwidth.bandwidth||(e.jingle.contents[1].application.bandwidth={type:"AS",bandwidth:r.restrictBandwidth.toString()},e.sdp=p.toSessionSDP(e.jingle,{sid:r.config.sdpSessionID,role:r._role(),direction:"outgoing"}))),e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(r.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),e.sdp=p.toSessionSDP(e.jingle,{sid:r.config.sdpSessionID,role:r._role(),direction:"incoming"}),r.remoteDescription=e.jingle),e.sdp.split(/\r?\n/).forEach(function(e){0===e.indexOf("a=candidate:")&&r._checkRemoteCandidate(e)}),r.pc.setRemoteDescription(new RTCSessionDescription(e)).then(function(){t()},t)},i.prototype.answerAudioOnly=function(e){this._answer({mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}},e)},i.prototype.answerBroadcastOnly=function(e){this._answer({mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},e)},i.prototype.answer=function(e,t){var n=2===arguments.length;this._answer(n&&e?e:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},n?t:e)},i.prototype.handleAnswer=function(e,t){t=t||function(){};var n=this;e.jingle&&(e.sdp=p.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle,e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})})),e.sdp.split(/\r?\n/).forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new RTCSessionDescription(e)).then(function(){n.wtFirefox&&window.setTimeout(function(){n.firefoxcandidatebuffer.forEach(function(e){n.pc.addIceCandidate(new RTCIceCandidate(e)).then(function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(e.candidate)}),n.firefoxcandidatebuffer=null},n.wtFirefox),t(null)},t)},i.prototype.close=function(){this.pc.close(),this._localDataChannels=[],this._remoteDataChannels=[],this.emit("close")},i.prototype._answer=function(e,s){s=s||function(){};var a=this;if(!this.pc.remoteDescription)throw new Error("remoteDescription not set");if("closed"===this.pc.signalingState)return s("Already closed");a.pc.createAnswer(e).then(function(t){var e,n,r,o=[],i=(a.enableChromeNativeSimulcast&&(t.jingle=p.toSessionJSON(t.sdp,{role:a._role(),direction:"outgoing"}),2<=t.jingle.contents.length)&&"video"===t.jingle.contents[1].name&&(e=t.jingle.contents[1].application.sourceGroups||[],n=!1,e.forEach(function(e){"SIM"==e.semantics&&(n=!0)}),!n)&&t.jingle.contents[1].application.sources.length&&((r=JSON.parse(JSON.stringify(t.jingle.contents[1].application.sources[0]))).ssrc=""+Math.floor(4294967295*Math.random()),t.jingle.contents[1].application.sources.push(r),o.push(t.jingle.contents[1].application.sources[0].ssrc),o.push(r.ssrc),e.push({semantics:"SIM",sources:o}),(o=JSON.parse(JSON.stringify(r))).ssrc=""+Math.floor(4294967295*Math.random()),t.jingle.contents[1].application.sources.push(o),e.push({semantics:"FID",sources:[r.ssrc,o.ssrc]}),t.jingle.contents[1].application.sourceGroups=e,t.sdp=p.toSessionSDP(t.jingle,{sid:a.config.sdpSessionID,role:a._role(),direction:"outgoing"})),{type:"answer",sdp:t.sdp});a.assumeSetLocalSuccess&&(r=c(i),a.emit("answer",r),s(null,r)),a._candidateBuffer=[],a.pc.setLocalDescription(t).then(function(){var e;a.config.useJingle&&((e=p.toSessionJSON(t.sdp,{role:a._role(),direction:"outgoing"})).sid=a.config.sid,a.localDescription=e,i.jingle=e),a.enableChromeNativeSimulcast&&(i.jingle||(i.jingle=p.toSessionJSON(t.sdp,{role:a._role(),direction:"outgoing"})),i.jingle.contents[1].application.sources.forEach(function(e,t){e.parameters=e.parameters.map(function(e){return"msid"===e.key&&(e.value+="-"+Math.floor(t/2)),e})}),i.sdp=p.toSessionSDP(i.jingle,{sid:a.sdpSessionID,role:a._role(),direction:"outgoing"})),i.sdp.split(/\r?\n/).forEach(function(e){0===e.indexOf("a=candidate:")&&a._checkLocalCandidate(e)}),a.assumeSetLocalSuccess||(e=c(i),a.emit("answer",e),s(null,e))},function(e){a.emit("error",e),s(e)})},function(e){a.emit("error",e),s(e)})},i.prototype._onIce=function(e){var r=this;if(e.candidate){if(!this.dontSignalCandidates){var t,n,e=e.candidate,o={candidate:{candidate:e.candidate,sdpMid:e.sdpMid,sdpMLineIndex:e.sdpMLineIndex}},i=(this._checkLocalCandidate(e.candidate),p.toCandidateJSON(e.candidate));if(!(this.eliminateDuplicateCandidates&&"relay"===i.type&&-1<(n=(t=this._candidateBuffer.filter(function(e){return"relay"===e.type}).map(function(e){return e.foundation+":"+e.component})).indexOf(i.foundation+":"+i.component))&&i.priority>>24>=t[n].priority>>24||"max-bundle"===this.config.bundlePolicy&&-1<(n=(t=this._candidateBuffer.filter(function(e){return i.type===e.type}).map(function(e){return e.address+":"+e.port})).indexOf(i.address+":"+i.port))||"require"===this.config.rtcpMuxPolicy&&"2"===i.component)){if(this._candidateBuffer.push(i),r.config.useJingle)if(e.sdpMid||(r.pc.remoteDescription&&"offer"===r.pc.remoteDescription.type?e.sdpMid=r.remoteDescription.contents[e.sdpMLineIndex].name:e.sdpMid=r.localDescription.contents[e.sdpMLineIndex].name),r.iceCredentials.local[e.sdpMid]||p.toSessionJSON(r.pc.localDescription.sdp,{role:r._role(),direction:"outgoing"}).contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(r.iceCredentials.local[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),o.jingle={contents:[{name:e.sdpMid,creator:r._role(),transport:{transportType:"iceUdp",ufrag:r.iceCredentials.local[e.sdpMid].ufrag,pwd:r.iceCredentials.local[e.sdpMid].pwd,candidates:[i]}}]},0<r.batchIceCandidates)return 0===r.batchedIceCandidates.length&&window.setTimeout(function(){var t={},n=(r.batchedIceCandidates.forEach(function(e){e=e.contents[0],t[e.name]||(t[e.name]=e),t[e.name].transport.candidates.push(e.transport.candidates[0])}),{jingle:{contents:[]}});Object.keys(t).forEach(function(e){n.jingle.contents.push(t[e])}),r.batchedIceCandidates=[],r.emit("ice",n)},r.batchIceCandidates),void r.batchedIceCandidates.push(o.jingle);this.emit("ice",o)}}}else this.emit("endOfCandidates")},i.prototype._onDataChannel=function(e){e=e.channel;this._remoteDataChannels.push(e),this.emit("addChannel",e)},i.prototype.createDataChannel=function(e,t){e=this.pc.createDataChannel(e,t);return this._localDataChannels.push(e),e},i.prototype.getStats=function(){if("function"!=typeof arguments[0])return this.pc.getStats.apply(this.pc,arguments);var t=arguments[0];this.pc.getStats().then(function(e){t(null,e)},function(e){t(e)})},t.exports=i},{"lodash.clonedeep":60,"sdp-jingle-json":66,util:84,wildemitter:98}],66:[function(e,t,n){var r=e("./lib/tosdp"),o=e("./lib/tojson");n.toIncomingSDPOffer=function(e){return r.toSessionSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingSDPOffer=function(e){return r.toSessionSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingSDPAnswer=function(e){return r.toSessionSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingSDPAnswer=function(e){return r.toSessionSDP(e,{role:"responder",direction:"outgoing"})},n.toIncomingMediaSDPOffer=function(e){return r.toMediaSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingMediaSDPOffer=function(e){return r.toMediaSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingMediaSDPAnswer=function(e){return r.toMediaSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingMediaSDPAnswer=function(e){return r.toMediaSDP(e,{role:"responder",direction:"outgoing"})},n.toCandidateSDP=r.toCandidateSDP,n.toMediaSDP=r.toMediaSDP,n.toSessionSDP=r.toSessionSDP,n.toIncomingJSONOffer=function(e,t){return o.toSessionJSON(e,{role:"responder",direction:"incoming",creators:t})},n.toOutgoingJSONOffer=function(e,t){return o.toSessionJSON(e,{role:"initiator",direction:"outgoing",creators:t})},n.toIncomingJSONAnswer=function(e,t){return o.toSessionJSON(e,{role:"initiator",direction:"incoming",creators:t})},n.toOutgoingJSONAnswer=function(e,t){return o.toSessionJSON(e,{role:"responder",direction:"outgoing",creators:t})},n.toIncomingMediaJSONOffer=function(e,t){return o.toMediaJSON(e,{role:"responder",direction:"incoming",creator:t})},n.toOutgoingMediaJSONOffer=function(e,t){return o.toMediaJSON(e,{role:"initiator",direction:"outgoing",creator:t})},n.toIncomingMediaJSONAnswer=function(e,t){return o.toMediaJSON(e,{role:"initiator",direction:"incoming",creator:t})},n.toOutgoingMediaJSONAnswer=function(e,t){return o.toMediaJSON(e,{role:"responder",direction:"outgoing",creator:t})},n.toCandidateJSON=o.toCandidateJSON,n.toMediaJSON=o.toMediaJSON,n.toSessionJSON=o.toSessionJSON},{"./lib/tojson":69,"./lib/tosdp":70}],67:[function(e,t,n){n.lines=function(e){return e.split(/\r?\n/).filter(function(e){return 0<e.length})},n.findLine=function(e,t,n){for(var r=e.length,o=0;o<t.length;o++)if(t[o].substr(0,r)===e)return t[o];if(n)for(var i=0;i<n.length;i++)if(n[i].substr(0,r)===e)return n[i];return!1},n.findLines=function(e,t,n){for(var r=[],o=e.length,i=0;i<t.length;i++)t[i].substr(0,o)===e&&r.push(t[i]);if(!r.length&&n)for(var s=0;s<n.length;s++)n[s].substr(0,o)===e&&r.push(n[s]);return r},n.mline=function(e){for(var t=e.substr(2).split(" "),n={media:t[0],port:t[1],proto:t[2],formats:[]},r=3;r<t.length;r++)t[r]&&n.formats.push(t[r]);return n},n.rtpmap=function(e){var t={id:(e=e.substr(9).split(" ")).shift()},e=e[0].split("/");return t.name=e[0],t.clockrate=e[1],t.channels=3==e.length?e[2]:"1",t},n.sctpmap=function(e){e=e.substr(10).split(" ");return{number:e.shift(),protocol:e.shift(),streams:e.shift()}},n.fmtp=function(e){for(var t,n,r=e.substr(e.indexOf(" ")+1).split(";"),o=[],i=0;i<r.length;i++)t=(n=r[i].split("="))[0].trim(),n=n[1],t&&n?o.push({key:t,value:n}):t&&o.push({key:"",value:t});return o},n.crypto=function(e){e=e.substr(9).split(" ");return{tag:e[0],cipherSuite:e[1],keyParams:e[2],sessionParams:e.slice(3).join(" ")}},n.fingerprint=function(e){e=e.substr(14).split(" ");return{hash:e[0],value:e[1]}},n.extmap=function(e){var e=e.substr(9).split(" "),t={},n=e.shift(),r=n.indexOf("/");return 0<=r?(t.id=n.substr(0,r),t.senders=n.substr(r+1)):(t.id=n,t.senders="sendrecv"),t.uri=e.shift()||"",t},n.rtcpfb=function(e){var e=e.substr(10).split(" "),t={};return t.id=e.shift(),t.type=e.shift(),"trr-int"===t.type?t.value=e.shift():t.subtype=e.shift()||"",t.parameters=e,t},n.candidate=function(e){for(var t=(0===e.indexOf("a=candidate:")?e.substring(12):e.substring(10)).split(" "),n={foundation:t[0],component:t[1],protocol:t[2].toLowerCase(),priority:t[3],ip:t[4],port:t[5],type:t[7],generation:"0"},r=8;r<t.length;r+=2)"raddr"===t[r]?n.relAddr=t[r+1]:"rport"===t[r]?n.relPort=t[r+1]:"generation"===t[r]?n.generation=t[r+1]:"tcptype"===t[r]&&(n.tcpType=t[r+1]);return n.network="1",n},n.sourceGroups=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n].substr(13).split(" ");t.push({semantics:r.shift(),sources:r})}return t},n.sources=function(e){for(var t=[],n={},r=0;r<e.length;r++){var o=e[r].substr(7).split(" "),i=o.shift(),s=(n[i]||(t.push(s={ssrc:i,parameters:[]}),n[i]=s),(o=o.join(" ").split(":")).shift()),o=o.join(":")||null;n[i].parameters.push({key:s,value:o})}return t},n.groups=function(e){for(var t,n=[],r=0;r<e.length;r++)t=e[r].substr(8).split(" "),n.push({semantics:t.shift(),contents:t});return n},n.bandwidth=function(e){var e=e.substr(2).split(":"),t={};return t.type=e.shift(),t.bandwidth=e.shift(),t},n.msid=function(e){var e=e.substr(7),t=e.split(" ");return{msid:e,mslabel:t[0],label:t[1]}}},{}],68:[function(e,t,n){t.exports={initiator:{incoming:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},{}],69:[function(e,t,f){var l=e("./senders"),h=e("./parsers"),n=Math.random();f._setIdCounter=function(e){n=e},f.toSessionJSON=function(e,t){for(var n=t.creators||[],r=t.role||"initiator",o=t.direction||"outgoing",i=e.split(/\r?\nm=/),s=1;s<i.length;s++)i[s]="m="+i[s],s!==i.length-1&&(i[s]+="\r\n");var a=i.shift()+"\r\n",t=h.lines(a),e={},c=[];for(s=0;s<i.length;s++)c.push(f.toMediaJSON(i[s],a,{role:r,direction:o,creator:n[s]||"initiator"}));e.contents=c;t=h.findLines("a=group:",t);return t.length&&(e.groups=h.groups(t)),e},f.toMediaJSON=function(e,t,n){var o,i,r=n.creator||"initiator",s=n.role||"initiator",a=n.direction||"outgoing",c=h.lines(e),n=h.lines(t),e=h.mline(c[0]),t={creator:r,name:e.media,application:{applicationType:"rtp",media:e.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transportType:"iceUdp",candidates:[],fingerprints:[]}},u=("application"==e.media&&(t.application={applicationType:"datachannel"},t.transport.sctp=[]),t.application),p=t.transport,r=h.findLine("a=mid:",c),r=(r&&(t.name=r.substr(6)),h.findLine("a=sendrecv",c,n)?t.senders="both":h.findLine("a=sendonly",c,n)?t.senders=l[s][a].sendonly:h.findLine("a=recvonly",c,n)?t.senders=l[s][a].recvonly:h.findLine("a=inactive",c,n)&&(t.senders="none"),"rtp"==u.applicationType&&((e=h.findLine("b=",c))&&(u.bandwidth=h.bandwidth(e)),(r=h.findLine("a=ssrc:",c))&&(u.ssrc=r.substr(7).split(" ")[0]),h.findLines("a=rtpmap:",c).forEach(function(e){var t=h.rtpmap(e);t.parameters=[],t.feedback=[],h.findLines("a=fmtp:"+t.id,c).forEach(function(e){t.parameters=h.fmtp(e)}),h.findLines("a=rtcp-fb:"+t.id,c).forEach(function(e){t.feedback.push(h.rtcpfb(e))}),u.payloads.push(t)}),h.findLines("a=crypto:",c,n).forEach(function(e){u.encryption.push(h.crypto(e))}),h.findLine("a=rtcp-mux",c)&&(u.mux=!0),h.findLine("a=rtcp-rsize",c)&&(u.rsize=!0),h.findLines("a=rtcp-fb:*",c).forEach(function(e){u.feedback.push(h.rtcpfb(e))}),h.findLines("a=extmap:",c).forEach(function(e){e=h.extmap(e);e.senders=l[s][a][e.senders],u.headerExtensions.push(e)}),e=h.findLines("a=ssrc-group:",c),u.sourceGroups=h.sourceGroups(e||[]),r=h.findLines("a=ssrc:",c),o=u.sources=h.sources(r||[]),(e=h.findLine("a=msid:",c))&&(i=h.msid(e),["msid","mslabel","label"].forEach(function(e){for(var t=0;t<o.length;t++){for(var n=!1,r=0;r<o[t].parameters.length;r++)o[t].parameters[r].key===e&&(n=!0);n||o[t].parameters.push({key:e,value:i[e]})}})),h.findLine("a=x-google-flag:conference",c,n))&&(u.googConferenceFlag=!0),h.findLines("a=fingerprint:",c,n)),d=h.findLine("a=setup:",c,n),e=(r.forEach(function(e){e=h.fingerprint(e);d&&(e.setup=d.substr(8)),p.fingerprints.push(e)}),h.findLine("a=ice-ufrag:",c,n)),r=h.findLine("a=ice-pwd:",c,n);return e&&r&&(p.ufrag=e.substr(12),p.pwd=r.substr(10),p.candidates=[],h.findLines("a=candidate:",c,n).forEach(function(e){p.candidates.push(f.toCandidateJSON(e))})),"datachannel"==u.applicationType&&h.findLines("a=sctpmap:",c).forEach(function(e){e=h.sctpmap(e);p.sctp.push(e)}),t},f.toCandidateJSON=function(e){e=h.candidate(e.split(/\r?\n/)[0]);return e.id=(n++).toString(36).substr(0,12),e}},{"./parsers":67,"./senders":68}],70:[function(e,t,p){var d=e("./senders");p.toSessionSDP=function(e,t){t.role,t.direction;var n=["v=0","o=- "+(t.sid||e.sid||Date.now())+" "+(t.time||Date.now())+" IN IP4 0.0.0.0","s=-","t=0 0"],r=e.contents||[],o=!1;return r.forEach(function(e){e.application.sources&&e.application.sources.length&&(o=!0)}),o&&n.push("a=msid-semantic: WMS *"),(e.groups||[]).forEach(function(e){n.push("a=group:"+e.semantics+" "+e.contents.join(" "))}),r.forEach(function(e){n.push(p.toMediaSDP(e,t))}),n.join("\r\n")+"\r\n"},p.toMediaSDP=function(e,t){var n,r=[],o=t.role||"initiator",i=t.direction||"outgoing",s=e.application,t=e.transport,a=s.payloads||[],c=t&&t.fingerprints||[],u=[];return"datachannel"==s.applicationType?(u.push("application"),u.push("1"),u.push("DTLS/SCTP"),t.sctp&&t.sctp.forEach(function(e){u.push(e.number)})):(u.push(s.media),u.push("1"),0<c.length?u.push("UDP/TLS/RTP/SAVPF"):s.encryption&&0<s.encryption.length?u.push("RTP/SAVPF"):u.push("RTP/AVPF"),a.forEach(function(e){u.push(e.id)})),r.push("m="+u.join(" ")),r.push("c=IN IP4 0.0.0.0"),s.bandwidth&&s.bandwidth.type&&s.bandwidth.bandwidth&&r.push("b="+s.bandwidth.type+":"+s.bandwidth.bandwidth),"rtp"==s.applicationType&&r.push("a=rtcp:1 IN IP4 0.0.0.0"),t&&(t.ufrag&&r.push("a=ice-ufrag:"+t.ufrag),t.pwd&&r.push("a=ice-pwd:"+t.pwd),c.forEach(function(e){r.push("a=fingerprint:"+e.hash+" "+e.value),e.setup&&r.push("a=setup:"+e.setup)}),t.sctp)&&t.sctp.forEach(function(e){r.push("a=sctpmap:"+e.number+" "+e.protocol+" "+e.streams)}),"rtp"==s.applicationType&&r.push("a="+(d[o][i][e.senders]||"sendrecv")),r.push("a=mid:"+e.name),s.sources&&s.sources.length&&(n={},s.sources.forEach(function(e){(e.parameters||[]).forEach(function(e){"msid"===e.key&&(n[e.value]=1)})}),1===(n=Object.keys(n)).length)&&r.push("a=msid:"+n[0]),s.mux&&r.push("a=rtcp-mux"),s.rsize&&r.push("a=rtcp-rsize"),(s.encryption||[]).forEach(function(e){r.push("a=crypto:"+e.tag+" "+e.cipherSuite+" "+e.keyParams+(e.sessionParams?" "+e.sessionParams:""))}),s.googConferenceFlag&&r.push("a=x-google-flag:conference"),a.forEach(function(t){var n,e="a=rtpmap:"+t.id+" "+t.name+"/"+t.clockrate;t.channels&&"1"!=t.channels&&(e+="/"+t.channels),r.push(e),t.parameters&&t.parameters.length&&(e=["a=fmtp:"+t.id],n=[],t.parameters.forEach(function(e){n.push((e.key?e.key+"=":"")+e.value)}),e.push(n.join(";")),r.push(e.join(" "))),t.feedback&&t.feedback.forEach(function(e){"trr-int"===e.type?r.push("a=rtcp-fb:"+t.id+" trr-int "+(e.value||"0")):r.push("a=rtcp-fb:"+t.id+" "+e.type+(e.subtype?" "+e.subtype:""))})}),s.feedback&&s.feedback.forEach(function(e){"trr-int"===e.type?r.push("a=rtcp-fb:* trr-int "+(e.value||"0")):r.push("a=rtcp-fb:* "+e.type+(e.subtype?" "+e.subtype:""))}),(s.headerExtensions||[]).forEach(function(e){r.push("a=extmap:"+e.id+(e.senders?"/"+d[o][i][e.senders]:"")+" "+e.uri)}),(s.sourceGroups||[]).forEach(function(e){r.push("a=ssrc-group:"+e.semantics+" "+e.sources.join(" "))}),(s.sources||[]).forEach(function(e){for(var t=0;t<e.parameters.length;t++){var n=e.parameters[t];r.push("a=ssrc:"+(e.ssrc||s.ssrc)+" "+n.key+(n.value?":"+n.value:""))}}),(t.candidates||[]).forEach(function(e){r.push(p.toCandidateSDP(e))}),r.join("\r\n")},p.toCandidateSDP=function(e){var t=[],n=(t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port),e.type);return t.push("typ"),t.push(n),"srflx"!==n&&"prflx"!==n&&"relay"!==n||e.relAddr&&e.relPort&&(t.push("raddr"),t.push(e.relAddr),t.push("rport"),t.push(e.relPort)),e.tcpType&&"TCP"==e.protocol.toUpperCase()&&(t.push("tcptype"),t.push(e.tcpType)),t.push("generation"),t.push(e.generation||"0"),"a=candidate:"+t.join(" ")}},{"./senders":68}],71:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};u.localCName=u.generateIdentifier(),u.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},u.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(0<t?"m="+e:e).trim()+"\r\n"})},u.getDescription=function(e){e=u.splitSections(e);return e&&e[0]},u.getMediaSections=function(e){e=u.splitSections(e);return e.shift(),e},u.matchPrefix=function(e,t){return u.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},u.parseCandidate=function(e){for(var t=void 0,n={foundation:(t=(0===e.indexOf("a=candidate:")?e.substring(12):e.substring(10)).split(" "))[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:void 0===n[t[r]]&&(n[t[r]]=t[r+1])}return n},u.writeCandidate=function(e){var t=[],n=(t.push(e.foundation),e.component),n=(t.push("rtp"===n?1:"rtcp"===n?2:n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port),e.type);return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},u.parseIceOptions=function(e){return e.substring(14).split(" ")},u.parseRtpMap=function(e){var e=e.substring(9).split(" "),t={payloadType:parseInt(e.shift(),10)},e=e[0].split("/");return t.name=e[0],t.clockRate=parseInt(e[1],10),t.channels=3===e.length?parseInt(e[2],10):1,t.numChannels=t.channels,t},u.writeRtpMap=function(e){var t=e.payloadType,n=(void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType),e.channels||e.numChannels||1);return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},u.parseExtmap=function(e){e=e.substring(9).split(" ");return{id:parseInt(e[0],10),direction:0<e[0].indexOf("/")?e[0].split("/")[1]:"sendrecv",uri:e[1],attributes:e.slice(2).join(" ")}},u.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},u.parseFmtp=function(e){for(var t={},n=void 0,r=e.substring(e.indexOf(" ")+1).split(";"),o=0;o<r.length;o++)t[(n=r[o].trim().split("="))[0].trim()]=n[1];return t},u.writeFmtp=function(t){var n,e="",r=t.payloadType;return void 0!==t.preferredPayloadType&&(r=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length&&(n=[],Object.keys(t.parameters).forEach(function(e){void 0!==t.parameters[e]?n.push(e+"="+t.parameters[e]):n.push(e)}),e+="a=fmtp:"+r+" "+n.join(";")+"\r\n"),e},u.parseRtcpFb=function(e){e=e.substring(e.indexOf(" ")+1).split(" ");return{type:e.shift(),parameter:e.join(" ")}},u.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},u.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},r=e.indexOf(":",t);return-1<r?(n.attribute=e.substring(t+1,r),n.value=e.substring(r+1)):n.attribute=e.substring(t+1),n},u.parseSsrcGroup=function(e){e=e.substring(13).split(" ");return{semantics:e.shift(),ssrcs:e.map(function(e){return parseInt(e,10)})}},u.getMid=function(e){e=u.matchPrefix(e,"a=mid:")[0];if(e)return e.substring(6)},u.parseFingerprint=function(e){e=e.substring(14).split(" ");return{algorithm:e[0].toLowerCase(),value:e[1].toUpperCase()}},u.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:u.matchPrefix(e+t,"a=fingerprint:").map(u.parseFingerprint)}},u.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},u.parseCryptoLine=function(e){e=e.substring(9).split(" ");return{tag:parseInt(e[0],10),cryptoSuite:e[1],keyParams:e[2],sessionParams:e.slice(3)}},u.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===r(e.keyParams)?u.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},u.parseCryptoKeyParams=function(e){return 0!==e.indexOf("inline:")?null:{keyMethod:"inline",keySalt:(e=e.substring(7).split("|"))[0],lifeTime:e[1],mkiValue:e[2]?e[2].split(":")[0]:void 0,mkiLength:e[2]?e[2].split(":")[1]:void 0}},u.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},u.getCryptoParameters=function(e,t){return u.matchPrefix(e+t,"a=crypto:").map(u.parseCryptoLine)},u.getIceParameters=function(e,t){var n=u.matchPrefix(e+t,"a=ice-ufrag:")[0],e=u.matchPrefix(e+t,"a=ice-pwd:")[0];return n&&e?{usernameFragment:n.substring(12),password:e.substring(10)}:null},u.writeIceParameters=function(e){var t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},u.parseRtpParameters=function(e){var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=u.splitLines(e)[0].split(" ");t.profile=n[2];for(var r=3;r<n.length;r++){var o=n[r],i=u.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(i){var s=u.parseRtpMap(i),i=u.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=i.length?u.parseFmtp(i[0]):{},s.rtcpFeedback=u.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(u.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}u.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(u.parseExtmap(e))});var a=u.matchPrefix(e,"a=rtcp-fb:* ").map(u.parseRtcpFb);return t.codecs.forEach(function(e){a.forEach(function(t){e.rtcpFeedback.find(function(e){return e.type===t.type&&e.parameter===t.parameter})||e.rtcpFeedback.push(t)})}),t},u.writeRtpDescription=function(e,t){var n="",r=(n=(n=(n=(n=(n+="m="+e+" ")+(0<t.codecs.length?"9":"0"))+(" "+(t.profile||"UDP/TLS/RTP/SAVPF")+" "))+(t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n"))+"c=IN IP4 0.0.0.0\r\n"+"a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n=(n=(n+=u.writeRtpMap(e))+u.writeFmtp(e))+u.writeRtcpFb(e)}),0);return t.codecs.forEach(function(e){e.maxptime>r&&(r=e.maxptime)}),0<r&&(n+="a=maxptime:"+r+"\r\n"),t.headerExtensions&&t.headerExtensions.forEach(function(e){n+=u.writeExtmap(e)}),n},u.parseRtpEncodingParameters=function(e){var t=[],n=u.parseRtpParameters(e),r=-1!==n.fecMechanisms.indexOf("RED"),o=-1!==n.fecMechanisms.indexOf("ULPFEC"),i=u.matchPrefix(e,"a=ssrc:").map(function(e){return u.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),s=0<i.length&&i[0].ssrc,a=void 0,i=u.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substring(17).split(" ").map(function(e){return parseInt(e,10)})}),c=(0<i.length&&1<i[0].length&&i[0][0]===s&&(a=i[0][1]),n.codecs.forEach(function(e){"RTX"===e.name.toUpperCase()&&e.parameters.apt&&(e={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)},s&&a&&(e.rtx={ssrc:a}),t.push(e),r)&&((e=JSON.parse(JSON.stringify(e))).fec={ssrc:s,mechanism:o?"red+ulpfec":"red"},t.push(e))}),0===t.length&&s&&t.push({ssrc:s}),u.matchPrefix(e,"b="));return c.length&&(c=0===c[0].indexOf("b=TIAS:")?parseInt(c[0].substring(7),10):0===c[0].indexOf("b=AS:")?1e3*parseInt(c[0].substring(5),10)*.95-16e3:void 0,t.forEach(function(e){e.maxBitrate=c})),t},u.parseRtcpParameters=function(e){var t={},n=u.matchPrefix(e,"a=ssrc:").map(function(e){return u.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0],n=(n&&(t.cname=n.value,t.ssrc=n.ssrc),u.matchPrefix(e,"a=rtcp-rsize")),n=(t.reducedSize=0<n.length,t.compound=0===n.length,u.matchPrefix(e,"a=rtcp-mux"));return t.mux=0<n.length,t},u.writeRtcpParameters=function(e){var t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},u.parseMsid=function(e){var t=void 0,n=u.matchPrefix(e,"a=msid:");return 1===n.length?{stream:(t=n[0].substring(7).split(" "))[0],track:t[1]}:0<(n=u.matchPrefix(e,"a=ssrc:").map(function(e){return u.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute})).length?{stream:(t=n[0].value.split(" "))[0],track:t[1]}:void 0},u.parseSctpDescription=function(e){var t=u.parseMLine(e),n=u.matchPrefix(e,"a=max-message-size:"),r=void 0,n=(0<n.length&&(r=parseInt(n[0].substring(19),10)),isNaN(r)&&(r=65536),u.matchPrefix(e,"a=sctp-port:"));return 0<n.length?{port:parseInt(n[0].substring(12),10),protocol:t.fmt,maxMessageSize:r}:0<(n=u.matchPrefix(e,"a=sctpmap:")).length?(t=n[0].substring(10).split(" "),{port:parseInt(t[0],10),protocol:t[1],maxMessageSize:r}):void 0},u.writeSctpDescription=function(e,t){var n=[],n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"];return void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},u.generateSessionId=function(){return Math.random().toString().substr(2,22)},u.writeSessionBoilerplate=function(e,t,n){t=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||u.generateSessionId())+" "+t+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},u.getDirection=function(e,t){for(var n=u.splitLines(e),r=0;r<n.length;r++)switch(n[r]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[r].substring(2)}return t?u.getDirection(t):"sendrecv"},u.getKind=function(e){return u.splitLines(e)[0].split(" ")[0].substring(2)},u.isRejected=function(e){return"0"===e.split(" ",2)[1]},u.parseMLine=function(e){e=u.splitLines(e)[0].substring(2).split(" ");return{kind:e[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}},u.parseOLine=function(e){e=u.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:e[0],sessionId:e[1],sessionVersion:parseInt(e[2],10),netType:e[3],addressType:e[4],address:e[5]}},u.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=u.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"===(void 0===t?"undefined":r(t))&&(t.exports=u)},{}],72:[function(e,t,n){"use strict";var r=e("get-intrinsic"),s=e("define-data-property"),a=e("has-property-descriptors")(),c=e("gopd"),u=e("es-errors/type"),p=r("%Math.floor%");t.exports=function(e,t){if("function"!=typeof e)throw new u("`fn` is not a function");if("number"!=typeof t||t<0||4294967295<t||p(t)!==t)throw new u("`length` must be a positive 32-bit integer");var n,r=2<arguments.length&&!!arguments[2],o=!0,i=!0;return"length"in e&&c&&((n=c(e,"length"))&&!n.configurable&&(o=!1),n)&&!n.writable&&(i=!1),!o&&!i&&r||(a?s(e,"length",t,!0,!0):s(e,"length",t)),e}},{"define-data-property":10,"es-errors/type":37,"get-intrinsic":43,gopd:45,"has-property-descriptors":47}],73:[function(e,t,n){"use strict";function r(e){this.ms=(e=e||{}).min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=0<e.jitter&&e.jitter<=1?e.jitter:0,this.attempts=0}Object.defineProperty(n,"__esModule",{value:!0}),n.Backoff=void 0,(n.Backoff=r).prototype.duration=function(){var e,t,n=this.ms*Math.pow(this.factor,this.attempts++);return this.jitter&&(e=Math.random(),t=Math.floor(e*this.jitter*n),n=0==(1&Math.floor(10*e))?n-t:n+t),0|Math.min(n,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(e){this.ms=e},r.prototype.setMax=function(e){this.max=e},r.prototype.setJitter=function(e){this.jitter=e}},{}],74:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.connect=n.io=n.Socket=n.Manager=n.protocol=void 0;const s=e("./url.js"),a=e("./manager.js"),o=(Object.defineProperty(n,"Manager",{enumerable:!0,get:function(){return a.Manager}}),e("./socket.js")),c=(Object.defineProperty(n,"Socket",{enumerable:!0,get:function(){return o.Socket}}),r(e("debug")).default("socket.io-client")),u={};function i(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var e=s.url(e,t.path||"/socket.io"),n=e.source,r=e.id,o=e.path,o=u[r]&&o in u[r].nsps,o=t.forceNew||t["force new connection"]||!1===t.multiplex||o;let i;return i=o?(c("ignoring socket cache for %s",n),new a.Manager(n,t)):(u[r]||(c("new io instance for %s",n),u[r]=new a.Manager(n,t)),u[r]),e.query&&!t.query&&(t.query=e.queryKey),i.socket(e.path,t)}n.io=i,n.connect=i,n.default=i,Object.assign(i,{Manager:a.Manager,Socket:o.Socket,io:i,connect:i});var p=e("socket.io-parser");Object.defineProperty(n,"protocol",{enumerable:!0,get:function(){return p.protocol}}),t.exports=i},{"./manager.js":75,"./socket.js":77,"./url.js":78,debug:8,"socket.io-parser":80}],75:[function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Manager=void 0;const c=e("engine.io-client"),a=e("./socket.js"),u=i(e("socket.io-parser")),p=e("./on.js"),d=e("./contrib/backo2.js");i=e("@socket.io/component-emitter");const f=s(e("debug")).default("socket.io-client:manager");class l extends i.Emitter{constructor(e,t){super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,c.installTimerFunctions(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!=(n=t.randomizationFactor)?n:.5),this.backoff=new d.Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;var n=t.parser||u;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null!=(t=this.backoff)&&t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null!=(t=this.backoff)&&t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null!=(t=this.backoff)&&t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(f("readyState %s",this._readyState),!~this._readyState.indexOf("open")){f("opening %s",this.uri),this.engine=new c.Socket(this.uri,this.opts);const n=this.engine,r=this,o=(this._readyState="opening",this.skipReconnect=!1,p.on(n,"open",function(){r.onopen(),t&&t()})),i=e=>{f("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",e),t?t(e):this.maybeReconnectOnOpen()};var e=p.on(n,"error",i);if(!1!==this._timeout){const s=this._timeout,a=(f("connect attempt will timeout after %d",s),this.setTimeoutFn(()=>{f("connect attempt timed out after %d",s),o(),i(new Error("timeout")),n.close()},s));this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}this.subs.push(o),this.subs.push(e)}return this}connect(e){return this.open(e)}onopen(){f("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");var e=this.engine;this.subs.push(p.on(e,"ping",this.onping.bind(this)),p.on(e,"data",this.ondata.bind(this)),p.on(e,"error",this.onerror.bind(this)),p.on(e,"close",this.onclose.bind(this)),p.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){c.nextTick(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){f("error",e),this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new a.Socket(this,e,t),this.nsps[e]=n),n}_destroy(e){for(const t of Object.keys(this.nsps)){const e=this.nsps[t];if(e.active)return void f("socket %s is still active, skipping close",t)}this._close()}_packet(t){f("writing packet %j",t);var n=this.encoder.encode(t);for(let e=0;e<n.length;e++)this.engine.write(n[e],t.options)}cleanup(){f("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){f("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){f("closed due to %s",e),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)f("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var e=this.backoff.duration();f("will wait %dms before reconnect attempt",e),this._reconnecting=!0;const n=this.setTimeoutFn(()=>{t.skipReconnect||(f("attempting reconnect"),this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect)||t.open(e=>{e?(f("reconnect attempt error"),t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):(f("reconnect success"),t.onreconnect())})},e);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){var e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}n.Manager=l},{"./contrib/backo2.js":73,"./on.js":76,"./socket.js":77,"@socket.io/component-emitter":1,debug:8,"engine.io-client":16,"socket.io-parser":80}],76:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.on=void 0,n.on=function(e,t,n){return e.on(t,n),function(){e.off(t,n)}}},{}],77:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Socket=void 0;const o=e("socket.io-parser"),i=e("./on.js");var s=e("@socket.io/component-emitter");const a=r(e("debug")).default("socket.io-client:socket"),c=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class u extends s.Emitter{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){var e;this.subs||(e=this.io,this.subs=[i.on(e,"open",this.onopen.bind(this)),i.on(e,"packet",this.onpacket.bind(this)),i.on(e,"error",this.onerror.bind(this)),i.on(e,"close",this.onclose.bind(this))])}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(c.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');var n,r;return t.unshift(e),!this._opts.retries||this.flags.fromQueue||this.flags.volatile?(r=((e={type:o.PacketType.EVENT,data:t,options:{}}).options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(n=this.ids++,a("emitting packet with ack id %d",n),r=t.pop(),this._registerAckCallback(n,r),e.id=n),this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable),this.flags.volatile&&(!r||!this.connected)?a("discard packet as the transport is not currently writable"):this.connected?(this.notifyOutgoingListeners(e),this.packet(e)):this.sendBuffer.push(e),this.flags={}):this._addToQueue(t),this}_registerAckCallback(t,n){var e;const r=null!=(e=this.flags.timeout)?e:this._opts.ackTimeout;if(void 0===r)this.acks[t]=n;else{const o=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===t&&(a("removing packet with ack id %d from the buffer",t),this.sendBuffer.splice(e,1));a("event with ack id %d has timed out after %d ms",t,r),n.call(this,new Error("operation has timed out"))},r);this.acks[t]=(...e)=>{this.io.clearTimeoutFn(o),n.apply(this,[null,...e])}}}emitWithAck(e,...t){const o=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise((n,r)=>{t.push((e,t)=>o?e?r(e):n(t):n(e)),this.emit(e,...t)})}_addToQueue(e){let n;"function"==typeof e[e.length-1]&&(n=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((e,...t)=>{if(r===this._queue[0])return null!==e?r.tryCount>this._opts.retries&&(a("packet [%d] is discarded after %d tries",r.id,r.tryCount),this._queue.shift(),n)&&n(e):(a("packet [%d] was successfully sent",r.id),this._queue.shift(),n&&n(null,...t)),r.pending=!1,this._drainQueue()}),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){var t;a("draining queue"),this.connected&&0!==this._queue.length&&((t=this._queue[0]).pending&&!e?a("packet [%d] has already been sent and is waiting for an ack",t.id):(t.pending=!0,t.tryCount++,a("sending packet [%d] (try n°%d)",t.id,t.tryCount),this.flags=t.flags,this.emit.apply(this,t.args)))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){a("transport is open - connecting"),"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:o.PacketType.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){a("close (%s)",e),this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case o.PacketType.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case o.PacketType.EVENT:case o.PacketType.BINARY_EVENT:this.onevent(e);break;case o.PacketType.ACK:case o.PacketType.BINARY_ACK:this.onack(e);break;case o.PacketType.DISCONNECT:this.ondisconnect();break;case o.PacketType.CONNECT_ERROR:this.destroy();var t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){var t=e.data||[];a("emitting event %j",t),null!=e.id&&(a("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length)for(const t of this._anyListeners.slice())t.apply(this,e);super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(t){const n=this;let r=!1;return function(...e){r||(r=!0,a("sending ack %j",e),n.packet({type:o.PacketType.ACK,id:t,data:e}))}}onack(e){var t=this.acks[e.id];"function"==typeof t?(a("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):a("bad ack %s",e.id)}onconnect(e,t){a("socket connected with id %s",e),this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){a("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(a("performing disconnect (%s)",this.nsp),this.packet({type:o.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(t){if(this._anyListeners)if(t){var n=this._anyListeners;for(let e=0;e<n.length;e++)if(t===n[e])return n.splice(e,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(t){if(this._anyOutgoingListeners)if(t){var n=this._anyOutgoingListeners;for(let e=0;e<n.length;e++)if(t===n[e])return n.splice(e,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length)for(const t of this._anyOutgoingListeners.slice())t.apply(this,e.data)}}n.Socket=u},{"./on.js":76,"@socket.io/component-emitter":1,debug:8,"socket.io-parser":80}],78:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.url=void 0;const o=e("engine.io-client"),i=r(e("debug")).default("socket.io-client:url");n.url=function(e,t="",n){let r=e;return n=n||"undefined"!=typeof location&&location,"string"==typeof(e=null==e?n.protocol+"//"+n.host:e)&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e=void 0!==n?n.protocol+"//"+e:"https://"+e),i("parse %s",e),r=o.parse(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/",e=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host,r.id=r.protocol+"://"+e+":"+r.port+t,r.href=r.protocol+"://"+e+(n&&n.port===r.port?"":":"+r.port),r}},{debug:8,"engine.io-client":16}],79:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.reconstructPacket=n.deconstructPacket=void 0;const a=e("./is-binary.js");n.deconstructPacket=function(e){var t=[],n=e.data;return e.data=function t(n,r){if(!n)return n;{if((0,a.isBinary)(n)){const e={_placeholder:!0,num:r.length};return r.push(n),e}if(Array.isArray(n)){const o=new Array(n.length);for(let e=0;e<n.length;e++)o[e]=t(n[e],r);return o}if("object"==typeof n&&!(n instanceof Date)){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=t(n[s],r));return i}}return n}(n,t),e.attachments=t.length,{packet:e,buffers:t}},n.reconstructPacket=function(e,t){return e.data=function t(n,r){if(!n)return n;{if(n&&!0===n._placeholder){const e="number"==typeof n.num&&0<=n.num&&n.num<r.length;if(e)return r[n.num];throw new Error("illegal attachments")}if(Array.isArray(n))for(let e=0;e<n.length;e++)n[e]=t(n[e],r);else if("object"==typeof n)for(const o in n)Object.prototype.hasOwnProperty.call(n,o)&&(n[o]=t(n[o],r))}return n}(e.data,t),delete e.attachments,e}},{"./is-binary.js":81}],80:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Decoder=n.Encoder=n.PacketType=n.protocol=void 0;var i,r=e("@socket.io/component-emitter");const o=e("./binary.js"),s=e("./is-binary.js"),a=(0,e("debug").default)("socket.io-parser"),c=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];n.protocol=5,(e=i=n.PacketType||(n.PacketType={}))[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK";function u(e){return"[object Object]"===Object.prototype.toString.call(e)}n.Encoder=class{constructor(e){this.replacer=e}encode(e){return a("encoding packet %j",e),e.type!==i.EVENT&&e.type!==i.ACK||!(0,s.hasBinary)(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===i.EVENT?i.BINARY_EVENT:i.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==i.BINARY_EVENT&&e.type!==i.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),a("encoded %j as %s",e,t),t}encodeAsBinary(e){var e=(0,o.deconstructPacket)(e),t=this.encodeAsString(e.packet),e=e.buffers;return e.unshift(t),e}};class p extends r.Emitter{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");var n=(t=this.decodeString(e)).type===i.BINARY_EVENT;(!n&&t.type!==i.BINARY_ACK||(t.type=n?i.EVENT:i.ACK,this.reconstructor=new d(t),0===t.attachments))&&super.emitReserved("decoded",t)}else{if(!(0,s.isBinary)(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;var n={type:Number(e.charAt(0))};if(void 0===i[n.type])throw new Error("unknown packet type "+n.type);if(n.type===i.BINARY_EVENT||n.type===i.BINARY_ACK){for(var r=t+1;"-"!==e.charAt(++t)&&t!=e.length;);r=e.substring(r,t);if(r!=Number(r)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(r)}if("/"===e.charAt(t+1)){for(r=t+1;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(r,t)}else n.nsp="/";r=e.charAt(t+1);if(""!==r&&Number(r)==r){for(r=t+1;++t;){var o=e.charAt(t);if(null==o||Number(o)!=o){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){r=this.tryParse(e.substr(t));if(!p.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return a("decoded %s as %j",e,n),n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case i.CONNECT:return u(t);case i.DISCONNECT:return void 0===t;case i.CONNECT_ERROR:return"string"==typeof t||u(t);case i.EVENT:case i.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===c.indexOf(t[0]));case i.ACK:case i.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}n.Decoder=p;class d{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){return this.buffers.push(e),this.buffers.length===this.reconPack.attachments?(e=(0,o.reconstructPacket)(this.reconPack,this.buffers),this.finishedReconstruction(),e):null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}},{"./binary.js":79,"./is-binary.js":81,"@socket.io/component-emitter":1,debug:8}],81:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.hasBinary=n.isBinary=void 0;const r="function"==typeof ArrayBuffer;var o=Object.prototype.toString;const i="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);function a(e){return r&&(e instanceof ArrayBuffer||(t=e,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer))||i&&e instanceof Blob||s&&e instanceof File;var t}n.isBinary=a,n.hasBinary=function n(r,e){if(r&&"object"==typeof r)if(Array.isArray(r)){for(let e=0,t=r.length;e<t;e++)if(n(r[e]))return!0}else{if(a(r))return!0;if(r.toJSON&&"function"==typeof r.toJSON&&1===arguments.length)return n(r.toJSON(),!0);for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&n(r[t]))return!0}return!1}},{}],82:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],83:[function(e,t,n){"use strict";var r=e("is-arguments"),o=e("is-generator-function"),i=e("which-typed-array"),s=e("is-typed-array");function a(e){return e.call.bind(e)}var c,u,p="undefined"!=typeof BigInt,d="undefined"!=typeof Symbol,f=a(Object.prototype.toString),l=a(Number.prototype.valueOf),h=a(String.prototype.valueOf),m=a(Boolean.prototype.valueOf);function y(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function g(e){return"[object Map]"===f(e)}function v(e){return"[object Set]"===f(e)}function b(e){return"[object WeakMap]"===f(e)}function C(e){return"[object WeakSet]"===f(e)}function S(e){return"[object ArrayBuffer]"===f(e)}function w(e){return"undefined"!=typeof ArrayBuffer&&(S.working?S(e):e instanceof ArrayBuffer)}function T(e){return"[object DataView]"===f(e)}function P(e){return"undefined"!=typeof DataView&&(T.working?T(e):e instanceof DataView)}p&&(c=a(BigInt.prototype.valueOf)),d&&(u=a(Symbol.prototype.valueOf)),n.isArgumentsObject=r,n.isGeneratorFunction=o,n.isTypedArray=s,n.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},n.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):s(e)||P(e)},n.isUint8Array=function(e){return"Uint8Array"===i(e)},n.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===i(e)},n.isUint16Array=function(e){return"Uint16Array"===i(e)},n.isUint32Array=function(e){return"Uint32Array"===i(e)},n.isInt8Array=function(e){return"Int8Array"===i(e)},n.isInt16Array=function(e){return"Int16Array"===i(e)},n.isInt32Array=function(e){return"Int32Array"===i(e)},n.isFloat32Array=function(e){return"Float32Array"===i(e)},n.isFloat64Array=function(e){return"Float64Array"===i(e)},n.isBigInt64Array=function(e){return"BigInt64Array"===i(e)},n.isBigUint64Array=function(e){return"BigUint64Array"===i(e)},g.working="undefined"!=typeof Map&&g(new Map),n.isMap=function(e){return"undefined"!=typeof Map&&(g.working?g(e):e instanceof Map)},v.working="undefined"!=typeof Set&&v(new Set),n.isSet=function(e){return"undefined"!=typeof Set&&(v.working?v(e):e instanceof Set)},b.working="undefined"!=typeof WeakMap&&b(new WeakMap),n.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(b.working?b(e):e instanceof WeakMap)},C.working="undefined"!=typeof WeakSet&&C(new WeakSet),n.isWeakSet=C,S.working="undefined"!=typeof ArrayBuffer&&S(new ArrayBuffer),n.isArrayBuffer=w,T.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&T(new DataView(new ArrayBuffer(1),0,1)),n.isDataView=P;var k="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function _(e){return"[object SharedArrayBuffer]"===f(e)}function R(e){return void 0!==k&&((_.working=void 0===_.working?_(new k):_.working)?_(e):e instanceof k)}function E(e){return y(e,l)}function O(e){return y(e,h)}function j(e){return y(e,m)}function A(e){return p&&y(e,c)}function x(e){return d&&y(e,u)}n.isSharedArrayBuffer=R,n.isAsyncFunction=function(e){return"[object AsyncFunction]"===f(e)},n.isMapIterator=function(e){return"[object Map Iterator]"===f(e)},n.isSetIterator=function(e){return"[object Set Iterator]"===f(e)},n.isGeneratorObject=function(e){return"[object Generator]"===f(e)},n.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===f(e)},n.isNumberObject=E,n.isStringObject=O,n.isBooleanObject=j,n.isBigIntObject=A,n.isSymbolObject=x,n.isBoxedPrimitive=function(e){return E(e)||O(e)||j(e)||A(e)||x(e)},n.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(w(e)||R(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(e){Object.defineProperty(n,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})})},{"is-arguments":55,"is-generator-function":57,"is-typed-array":58,"which-typed-array":97}],84:[function(E,e,O){!function(R){!function(){var e,t=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},a=/%[sdj%]/g,r=(O.format=function(e){if(!g(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(c(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,o=r.length,i=String(e).replace(a,function(e){if("%%"===e)return"%";if(o<=n)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),s=r[n];n<o;s=r[++n])m(s)||!u(s)?i+=" "+s:i+=" "+c(s);return i},O.deprecate=function(e,t){var n;return void 0!==R&&!0===R.noDeprecation?e:void 0===R?function(){return O.deprecate(e,t).apply(this,arguments)}:(n=!1,function(){if(!n){if(R.throwDeprecation)throw new Error(t);R.traceDeprecation?console.trace(t):console.error(t),n=!0}return e.apply(this,arguments)})},{}),o=/^$/;function c(e,t){var n={seen:[],stylize:s};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),h(t)?n.showHidden=t:t&&O._extend(n,t),v(n.showHidden)&&(n.showHidden=!1),v(n.depth)&&(n.depth=2),v(n.colors)&&(n.colors=!1),v(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=i),p(n,e,n.depth)}function i(e,t){t=c.styles[t];return t?"["+c.colors[t][0]+"m"+e+"["+c.colors[t][1]+"m":e}function s(e,t){return e}function p(t,n,r){if(t.customInspect&&n&&w(n.inspect)&&n.inspect!==O.inspect&&(!n.constructor||n.constructor.prototype!==n))return g(e=n.inspect(r,t))?e:p(t,e,r);var e=function(e,t){if(v(t))return e.stylize("undefined","undefined");{var n;if(g(t))return n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",e.stylize(n,"string")}return y(t)?e.stylize(""+t,"number"):h(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}(t,n);if(e)return e;var o,e=Object.keys(n),i=(o={},e.forEach(function(e,t){o[e]=!0}),o);if(t.showHidden&&(e=Object.getOwnPropertyNames(n)),S(n)&&(0<=e.indexOf("message")||0<=e.indexOf("description")))return d(n);if(0===e.length){if(w(n))return s=n.name?": "+n.name:"",t.stylize("[Function"+s+"]","special");if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(C(n))return t.stylize(Date.prototype.toString.call(n),"date");if(S(n))return d(n)}var s="",a=!1,c=["{","}"];if(l(n)&&(a=!0,c=["[","]"]),w(n)&&(s=" [Function"+(n.name?": "+n.name:"")+"]"),b(n)&&(s=" "+RegExp.prototype.toString.call(n)),C(n)&&(s=" "+Date.prototype.toUTCString.call(n)),S(n)&&(s=" "+d(n)),0===e.length&&(!a||0==n.length))return c[0]+s+c[1];if(r<0)return b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special");t.seen.push(n),u=a?function(t,n,r,o,e){for(var i=[],s=0,a=n.length;s<a;++s)k(n,String(s))?i.push(f(t,n,r,o,String(s),!0)):i.push("");return e.forEach(function(e){e.match(/^\d+$/)||i.push(f(t,n,r,o,e,!0))}),i}(t,n,r,i,e):e.map(function(e){return f(t,n,r,i,e,a)}),t.seen.pop();var u;return 60<u.reduce(function(e,t){return 0<=t.indexOf("\n")&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)?c[0]+(""===s?"":s+"\n ")+" "+u.join(",\n  ")+" "+c[1]:c[0]+s+" "+u.join(", ")+" "+c[1]}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,o,i){var s,a,t=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]};if(t.get?a=t.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):t.set&&(a=e.stylize("[Setter]","special")),k(r,o)||(s="["+o+"]"),a||(e.seen.indexOf(t.value)<0?-1<(a=m(n)?p(e,t.value,null):p(e,t.value,n-1)).indexOf("\n")&&(a=i?a.split("\n").map(function(e){return"  "+e}).join("\n").slice(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n")):a=e.stylize("[Circular]","special")),v(s)){if(i&&o.match(/^\d+$/))return a;s=(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.slice(1,-1),e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),e.stylize(s,"string"))}return s+": "+a}function l(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function m(e){return null===e}function y(e){return"number"==typeof e}function g(e){return"string"==typeof e}function v(e){return void 0===e}function b(e){return u(e)&&"[object RegExp]"===n(e)}function u(e){return"object"==typeof e&&null!==e}function C(e){return u(e)&&"[object Date]"===n(e)}function S(e){return u(e)&&("[object Error]"===n(e)||e instanceof Error)}function w(e){return"function"==typeof e}function n(e){return Object.prototype.toString.call(e)}function T(e){return e<10?"0"+e.toString(10):e.toString(10)}R.env.NODE_DEBUG&&(e=(e=R.env.NODE_DEBUG).replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),o=new RegExp("^"+e+"$","i")),O.debuglog=function(t){var n;return t=t.toUpperCase(),r[t]||(o.test(t)?(n=R.pid,r[t]=function(){var e=O.format.apply(O,arguments);console.error("%s %d: %s",t,n,e)}):r[t]=function(){}),r[t]},(O.inspect=c).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},O.types=E("./support/types"),O.isArray=l,O.isBoolean=h,O.isNull=m,O.isNullOrUndefined=function(e){return null==e},O.isNumber=y,O.isString=g,O.isSymbol=function(e){return"symbol"==typeof e},O.isUndefined=v,O.isRegExp=b,O.types.isRegExp=b,O.isObject=u,O.isDate=C,O.types.isDate=C,O.isError=S,O.types.isNativeError=S,O.isFunction=w,O.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},O.isBuffer=E("./support/isBuffer");var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function k(e,t){return Object.prototype.hasOwnProperty.call(e,t)}O.log=function(){var e,t;console.log("%s - %s",(e=new Date,t=[T(e.getHours()),T(e.getMinutes()),T(e.getSeconds())].join(":"),[e.getDate(),P[e.getMonth()],t].join(" ")),O.format.apply(O,arguments))},O.inherits=E("inherits"),O._extend=function(e,t){if(t&&u(t))for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var _="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;O.promisify=function(i){if("function"!=typeof i)throw new TypeError('The "original" argument must be of type Function');if(_&&i[_]){var e;if("function"!=typeof(e=i[_]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,_,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var n,r,e=new Promise(function(e,t){n=e,r=t}),t=[],o=0;o<arguments.length;o++)t.push(arguments[o]);t.push(function(e,t){e?r(e):n(t)});try{i.apply(this,t)}catch(e){r(e)}return e}return Object.setPrototypeOf(e,Object.getPrototypeOf(i)),_&&Object.defineProperty(e,_,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,t(i))},O.promisify.custom=_,O.callbackify=function(i){if("function"!=typeof i)throw new TypeError('The "original" argument must be of type Function');function e(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);var n=e.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");function r(){return n.apply(o,arguments)}var o=this;i.apply(this,e).then(function(e){R.nextTick(r.bind(null,null,e))},function(e){R.nextTick(function(e,t){var n;return e||((n=new Error("Promise was rejected with a falsy value")).reason=e,e=n),t(e)}.bind(null,e,r))})}return Object.setPrototypeOf(e,Object.getPrototypeOf(i)),Object.defineProperties(e,t(i)),e}}.call(this)}.call(this,E("_process"))},{"./support/isBuffer":82,"./support/types":83,_process:64,inherits:54}],85:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});e=(n.default=void 0,e("./adapter_factory.js").adapterFactory)({window:"undefined"==typeof window?void 0:window});n.default=e},{"./adapter_factory.js":86}],86:[function(e,t,n){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},n=i.log,r=i.detectBrowser(e),o={browserDetails:r,commonShim:p,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings,sdp:d};switch(r.browser){case"chrome":if(!a||!a.shimPeerConnection||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),o;if(null===r.version)return n("Chrome shim can not determine version, not shimming."),o;n("adapter.js shimming chrome."),o.browserShim=a,p.shimAddIceCandidateNullOrEmpty(e,r),p.shimParameterlessSetLocalDescription(e,r),a.shimGetUserMedia(e,r),a.shimMediaStream(e,r),a.shimPeerConnection(e,r),a.shimOnTrack(e,r),a.shimAddTrackRemoveTrack(e,r),a.shimGetSendersWithDtmf(e,r),a.shimGetStats(e,r),a.shimSenderReceiverGetStats(e,r),a.fixNegotiationNeeded(e,r),p.shimRTCIceCandidate(e,r),p.shimRTCIceCandidateRelayProtocol(e,r),p.shimConnectionState(e,r),p.shimMaxMessageSize(e,r),p.shimSendThrowTypeError(e,r),p.removeExtmapAllowMixed(e,r);break;case"firefox":if(!c||!c.shimPeerConnection||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),o;n("adapter.js shimming firefox."),o.browserShim=c,p.shimAddIceCandidateNullOrEmpty(e,r),p.shimParameterlessSetLocalDescription(e,r),c.shimGetUserMedia(e,r),c.shimPeerConnection(e,r),c.shimOnTrack(e,r),c.shimRemoveStream(e,r),c.shimSenderGetStats(e,r),c.shimReceiverGetStats(e,r),c.shimRTCDataChannel(e,r),c.shimAddTransceiver(e,r),c.shimGetParameters(e,r),c.shimCreateOffer(e,r),c.shimCreateAnswer(e,r),p.shimRTCIceCandidate(e,r),p.shimConnectionState(e,r),p.shimMaxMessageSize(e,r),p.shimSendThrowTypeError(e,r);break;case"safari":if(!u||!t.shimSafari)return n("Safari shim is not included in this adapter release."),o;n("adapter.js shimming safari."),o.browserShim=u,p.shimAddIceCandidateNullOrEmpty(e,r),p.shimParameterlessSetLocalDescription(e,r),u.shimRTCIceServerUrls(e,r),u.shimCreateOfferLegacy(e,r),u.shimCallbacksAPI(e,r),u.shimLocalStreamsAPI(e,r),u.shimRemoteStreamsAPI(e,r),u.shimTrackEventTransceiver(e,r),u.shimGetUserMedia(e,r),u.shimAudioContext(e,r),p.shimRTCIceCandidate(e,r),p.shimRTCIceCandidateRelayProtocol(e,r),p.shimMaxMessageSize(e,r),p.shimSendThrowTypeError(e,r),p.removeExtmapAllowMixed(e,r);break;default:n("Unsupported browser!")}return o};var i=r(e("./utils")),a=r(e("./chrome/chrome_shim")),c=r(e("./firefox/firefox_shim")),u=r(e("./safari/safari_shim")),p=r(e("./common_shim")),d=r(e("sdp"));function f(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(f=function(e){return e?n:t})(e))}function r(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==s(e)&&"function"!=typeof e)return{default:e};t=f(t);if(t&&t.has(e))return t.get(e);var n,r,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((r=i?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(o,n,r):o[n]=e[n]);return o.default=e,t&&t.set(e,o),o}},{"./chrome/chrome_shim":87,"./common_shim":90,"./firefox/firefox_shim":91,"./safari/safari_shim":94,"./utils":95,sdp:71}],87:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fixNegotiationNeeded=function(e,n){o.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){var t=e.target;if(!(n.version<72||t.getConfiguration&&"plan-b"===t.getConfiguration().sdpSemantics)||"stable"===t.signalingState)return e})},n.shimAddTrackRemoveTrack=function(o,e){if(o.RTCPeerConnection){if(o.RTCPeerConnection.prototype.addTrack&&65<=e.version)return u(o);var n=o.RTCPeerConnection.prototype.getLocalStreams,r=(o.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this,e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(function(e){return t._reverseStreams[e.id]})},o.RTCPeerConnection.prototype.addStream),t=(o.RTCPeerConnection.prototype.addStream=function(e){var t,n=this;this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e.getTracks().forEach(function(t){if(n.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")}),this._reverseStreams[e.id]||(t=new o.MediaStream(e.getTracks()),this._streams[e.id]=t,this._reverseStreams[t.id]=e,e=t),r.apply(this,[e])},o.RTCPeerConnection.prototype.removeStream),i=(o.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[(this._streams[e.id]||e).id],delete this._streams[e.id]},o.RTCPeerConnection.prototype.addTrack=function(t,e){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var r=this._streams[e.id];return r?(r.addTrack(t),Promise.resolve().then(function(){n.dispatchEvent(new Event("negotiationneeded"))})):(r=new o.MediaStream([t]),this._streams[e.id]=r,this._reverseStreams[r.id]=e,this.addStream(r)),this.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(e){var r=o.RTCPeerConnection.prototype[e],t=c({},e,function(){var t=this,n=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[function(e){e=a(t,e);n[0].apply(null,[e])},function(e){n[1]&&n[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then(function(e){return a(t,e)})});o.RTCPeerConnection.prototype[e]=t[e]}),o.RTCPeerConnection.prototype.setLocalDescription),s=(o.RTCPeerConnection.prototype.setLocalDescription=function(){var n,e,r;return arguments.length&&arguments[0].type&&(arguments[0]=(n=this,r=(e=arguments[0]).sdp,Object.keys(n._reverseStreams||[]).forEach(function(e){var e=n._reverseStreams[e],t=n._streams[e.id];r=r.replace(new RegExp(e.id,"g"),t.id)}),new RTCSessionDescription({type:e.type,sdp:r}))),i.apply(this,arguments)},Object.getOwnPropertyDescriptor(o.RTCPeerConnection.prototype,"localDescription"));Object.defineProperty(o.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=s.get.apply(this);return""===e.type?e:a(this,e)}}),o.RTCPeerConnection.prototype.removeTrack=function(t){var n,r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(t._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach(function(e){r._streams[e].getTracks().find(function(e){return t.track===e})&&(n=r._streams[e])}),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}}function a(n,e){var r=e.sdp;return Object.keys(n._reverseStreams||[]).forEach(function(e){var e=n._reverseStreams[e],t=n._streams[e.id];r=r.replace(new RegExp(t.id,"g"),e.id)}),new RTCSessionDescription({type:e.type,sdp:r})}},n.shimAddTrackRemoveTrackWithNative=u,Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),n.shimGetSendersWithDtmf=function(e){{var r,o,t,n,i,s;"object"===a(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype?(r=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}},e.RTCPeerConnection.prototype.getSenders||(e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()},o=e.RTCPeerConnection.prototype.addTrack,e.RTCPeerConnection.prototype.addTrack=function(e,t){var n=o.apply(this,arguments);return n||(n=r(this,e),this._senders.push(n)),n},t=e.RTCPeerConnection.prototype.removeTrack,e.RTCPeerConnection.prototype.removeTrack=function(e){t.apply(this,arguments);e=this._senders.indexOf(e);-1!==e&&this._senders.splice(e,1)}),n=e.RTCPeerConnection.prototype.addStream,e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(function(e){t._senders.push(r(t,e))})},i=e.RTCPeerConnection.prototype.removeStream,e.RTCPeerConnection.prototype.removeStream=function(e){var n=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach(function(t){var e=n._senders.find(function(e){return e.track===t});e&&n._senders.splice(n._senders.indexOf(e),1)})}):"object"===a(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&(s=e.RTCPeerConnection.prototype.getSenders,e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=s.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}}))}},n.shimGetStats=function(e){var s;e.RTCPeerConnection&&(s=e.RTCPeerConnection.prototype.getStats,e.RTCPeerConnection.prototype.getStats=function(){var n,r,o=this,e=Array.prototype.slice.call(arguments),t=e[0],i=e[1],e=e[2];return 0<arguments.length&&"function"==typeof t?s.apply(this,arguments):0!==s.length||0!==arguments.length&&"function"==typeof t?(n=function(e){var r={};return e.result().forEach(function(t){var n={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach(function(e){n[e]=t.stat(e)}),r[n.id]=n}),r},r=function(t){return new Map(Object.keys(t).map(function(e){return[e,t[e]]}))},2<=arguments.length?s.apply(this,[function(e){i(r(n(e)))},t]):new Promise(function(t,e){s.apply(o,[function(e){t(r(n(e)))},e])}).then(i,e)):s.apply(this,[])})},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}}),n.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function(i){{var e;"object"!==a(i)||!i.RTCPeerConnection||"ontrack"in i.RTCPeerConnection.prototype?o.wrapPeerConnectionEvent(i,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}):(Object.defineProperty(i.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0}),e=i.RTCPeerConnection.prototype.setRemoteDescription,i.RTCPeerConnection.prototype.setRemoteDescription=function(){var o=this;return this._ontrackpoly||(this._ontrackpoly=function(r){r.stream.addEventListener("addtrack",function(t){var e=i.RTCPeerConnection.prototype.getReceivers?o.getReceivers().find(function(e){return e.track&&e.track.id===t.track.id}):{track:t.track},n=new Event("track");n.track=t.track,n.receiver=e,n.transceiver={receiver:e},n.streams=[r.stream],o.dispatchEvent(n)}),r.stream.getTracks().forEach(function(t){var e=i.RTCPeerConnection.prototype.getReceivers?o.getReceivers().find(function(e){return e.track&&e.track.id===t.id}):{track:t},n=new Event("track");n.track=t,n.receiver=e,n.transceiver={receiver:e},n.streams=[r.stream],o.dispatchEvent(n)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)})}},n.shimPeerConnection=function(r,e){!r.RTCPeerConnection&&r.webkitRTCPeerConnection&&(r.RTCPeerConnection=r.webkitRTCPeerConnection);r.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=r.RTCPeerConnection.prototype[e],n=c({},e,function(){return arguments[0]=new("addIceCandidate"===e?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)});r.RTCPeerConnection.prototype[e]=n[e]})},n.shimSenderReceiverGetStats=function(e){var n,t,r,i;"object"===a(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver&&("getStats"in e.RTCRtpSender.prototype||((n=e.RTCPeerConnection.prototype.getSenders)&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),(t=e.RTCPeerConnection.prototype.addTrack)&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return o.filterStats(e,t.track,!0)})}),"getStats"in e.RTCRtpReceiver.prototype||((r=e.RTCPeerConnection.prototype.getReceivers)&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=r.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),o.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return o.filterStats(e,t.track,!1)})}),"getStats"in e.RTCRtpSender.prototype)&&"getStats"in e.RTCRtpReceiver.prototype&&(i=e.RTCPeerConnection.prototype.getStats,e.RTCPeerConnection.prototype.getStats=function(){var t,n,r,o;return 0<arguments.length&&arguments[0]instanceof e.MediaStreamTrack?(t=arguments[0],this.getSenders().forEach(function(e){e.track===t&&(n?o=!0:n=e)}),this.getReceivers().forEach(function(e){return e.track===t&&(r?o=!0:r=e),e.track===t}),o||n&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))):i.apply(this,arguments)})};var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var i;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(e("../utils.js")),r=e("./getusermedia"),i=e("./getdisplaymedia");function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function c(e,t,n){return(t=function(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(e){return t._shimmedLocalStreams[e][0]})};var r=e.RTCPeerConnection.prototype.addTrack,o=(e.RTCPeerConnection.prototype.addTrack=function(e,t){if(!t)return r.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=r.apply(this,arguments);return this._shimmedLocalStreams[t.id]?-1===this._shimmedLocalStreams[t.id].indexOf(n)&&this._shimmedLocalStreams[t.id].push(n):this._shimmedLocalStreams[t.id]=[t,n],n},e.RTCPeerConnection.prototype.addStream),t=(e.RTCPeerConnection.prototype.addStream=function(e){var n=this,t=(this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(t){if(n.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")}),this.getSenders()),r=(o.apply(this,arguments),this.getSenders().filter(function(e){return-1===t.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(r)},e.RTCPeerConnection.prototype.removeStream),i=(e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],t.apply(this,arguments)},e.RTCPeerConnection.prototype.removeTrack);e.RTCPeerConnection.prototype.removeTrack=function(n){var r=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},n&&Object.keys(this._shimmedLocalStreams).forEach(function(e){var t=r._shimmedLocalStreams[e].indexOf(n);-1!==t&&r._shimmedLocalStreams[e].splice(t,1),1===r._shimmedLocalStreams[e].length&&delete r._shimmedLocalStreams[e]}),i.apply(this,arguments)}}},{"../utils.js":95,"./getdisplaymedia":88,"./getusermedia":89}],88:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(i,e){i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices||i.navigator.mediaDevices&&("function"!=typeof e?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):i.navigator.mediaDevices.getDisplayMedia=function(o){return e(o).then(function(e){var t=o.video&&o.video.width,n=o.video&&o.video.height,r=o.video&&o.video.frameRate;return o.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:r||3}},t&&(o.video.mandatory.maxWidth=t),n&&(o.video.mandatory.maxHeight=n),i.navigator.mediaDevices.getUserMedia(o)})})}},{}],89:[function(e,t,n){"use strict";function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e,t){var s,r,o,n,a=e&&e.navigator;a.mediaDevices&&(s=function(o){var i;return"object"!==c(o)||o.mandatory||o.optional?o:(i={},Object.keys(o).forEach(function(t){var n,r,e;"require"!==t&&"advanced"!==t&&"mediaSource"!==t&&(void 0!==(n="object"===c(o[t])?o[t]:{ideal:o[t]}).exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact),r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t},void 0!==n.ideal&&(i.optional=i.optional||[],e={},"number"==typeof n.ideal?(e[r("min",t)]=n.ideal,i.optional.push(e),(e={})[r("max",t)]=n.ideal):e[r("",t)]=n.ideal,i.optional.push(e)),void 0!==n.exact&&"number"!=typeof n.exact?(i.mandatory=i.mandatory||{},i.mandatory[r("",t)]=n.exact):["min","max"].forEach(function(e){void 0!==n[e]&&(i.mandatory=i.mandatory||{},i.mandatory[r(e,t)]=n[e])}))}),o.advanced&&(i.optional=(i.optional||[]).concat(o.advanced)),i)},r=function(n,r){if(!(61<=t.version)){if((n=JSON.parse(JSON.stringify(n)))&&"object"===c(n.audio)&&((e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])})((n=JSON.parse(JSON.stringify(n))).audio,"autoGainControl","googAutoGainControl"),e(n.audio,"noiseSuppression","googNoiseSuppression"),n.audio=s(n.audio)),n&&"object"===c(n.video)){var o,i=(i=n.video.facingMode)&&("object"===c(i)?i:{ideal:i}),e=t.version<66;if(i&&("user"===i.exact||"environment"===i.exact||"user"===i.ideal||"environment"===i.ideal)&&(!a.mediaDevices.getSupportedConstraints||!a.mediaDevices.getSupportedConstraints().facingMode||e))if(delete n.video.facingMode,"environment"===i.exact||"environment"===i.ideal?o=["back","rear"]:"user"!==i.exact&&"user"!==i.ideal||(o=["front"]),o)return a.mediaDevices.enumerateDevices().then(function(e){var t=(e=e.filter(function(e){return"videoinput"===e.kind})).find(function(t){return o.some(function(e){return t.label.toLowerCase().includes(e)})});return(t=!t&&e.length&&o.includes("back")?e[e.length-1]:t)&&(n.video.deviceId=i.exact?{exact:t.deviceId}:{ideal:t.deviceId}),n.video=s(n.video),u("chrome: "+JSON.stringify(n)),r(n)});n.video=s(n.video)}u("chrome: "+JSON.stringify(n))}return r(n)},o=function(e){return 64<=t.version?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},a.getUserMedia=function(e,t,n){r(e,function(e){a.webkitGetUserMedia(e,t,function(e){n&&n(o(e))})})}.bind(a),a.mediaDevices.getUserMedia)&&(n=a.mediaDevices.getUserMedia.bind(a.mediaDevices),a.mediaDevices.getUserMedia=function(e){return r(e,function(t){return n(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return e},function(e){return Promise.reject(o(e))})})})};var u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var i;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(e("../utils.js")).log},{"../utils.js":95}],90:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.removeExtmapAllowMixed=function(n,e){var r;!n.RTCPeerConnection||"chrome"===e.browser&&71<=e.version||"safari"===e.browser&&605<=e.version||(r=n.RTCPeerConnection.prototype.setRemoteDescription,n.RTCPeerConnection.prototype.setRemoteDescription=function(e){var t;return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(t=e.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n"),n.RTCSessionDescription&&e instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:e.type,sdp:t}):e.sdp=t),r.apply(this,arguments)})},n.shimAddIceCandidateNullOrEmpty=function(e,t){var n;e.RTCPeerConnection&&e.RTCPeerConnection.prototype&&(n=e.RTCPeerConnection.prototype.addIceCandidate)&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})},n.shimConnectionState=function(e){var n;!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype||(n=e.RTCPeerConnection.prototype,Object.defineProperty(n,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(n,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var t=n[e];n[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t,n=e.target;return n._lastConnectionState!==n.connectionState&&(n._lastConnectionState=n.connectionState,t=new Event("connectionstatechange",e),n.dispatchEvent(t)),e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}}))},n.shimMaxMessageSize=function(e,i){var s;e.RTCPeerConnection&&("sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}}),s=e.RTCPeerConnection.prototype.setRemoteDescription,e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e,t,n,r,o;return this._sctp=null,"chrome"===i.browser&&76<=i.version&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0}),(o=arguments[0])&&o.sdp&&((o=a.default.splitSections(o.sdp)).shift(),o.some(function(e){e=a.default.parseMLine(e);return e&&"application"===e.kind&&-1!==e.protocol.indexOf("SCTP")}))&&(o=null===(o=(o=arguments[0]).sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/))||o.length<2||(o=parseInt(o[1],10))!=o?-1:o,n=o,r=65536,n=r="firefox"===i.browser?i.version<57?-1===n?16384:2147483637:i.version<60?57===i.version?65535:65536:2147483637:r,r=arguments[0],o=o,t=65536,"firefox"===i.browser&&57===i.version&&(t=65535),0<(r=a.default.matchPrefix(r.sdp,"a=max-message-size:")).length?t=parseInt(r[0].substring(19),10):"firefox"===i.browser&&-1!==o&&(t=2147483637),r=t,e=0===n&&0===r?Number.POSITIVE_INFINITY:0===n||0===r?Math.max(n,r):Math.min(n,r),o={},Object.defineProperty(o,"maxMessageSize",{get:function(){return e}}),this._sctp=o),s.apply(this,arguments)})},n.shimParameterlessSetLocalDescription=function(e,t){var n;e.RTCPeerConnection&&e.RTCPeerConnection.prototype&&(n=e.RTCPeerConnection.prototype.setLocalDescription)&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){var t=this,e=arguments[0]||{};if("object"!==c(e)||e.type&&e.sdp)return n.apply(this,arguments);if(!(e={type:e.type,sdp:e.sdp}).type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}return e.sdp||"offer"!==e.type&&"answer"!==e.type?n.apply(this,[e]):("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then(function(e){return n.apply(t,[e])})})},n.shimRTCIceCandidate=function(t){var o;!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype||(o=t.RTCIceCandidate,t.RTCIceCandidate=function(e){if("object"===c(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){var t,n=new o(e),r=a.default.parseCandidate(e.candidate);for(t in r)t in n||Object.defineProperty(n,t,{value:r[t]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new o(e)},t.RTCIceCandidate.prototype=o.prototype,r.wrapPeerConnectionEvent(t,"icecandidate",function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"}),e}))},n.shimRTCIceCandidateRelayProtocol=function(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||r.wrapPeerConnectionEvent(e,"icecandidate",function(e){var t;return e.candidate&&"relay"===(t=a.default.parseCandidate(e.candidate.candidate)).type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24]),e})},n.shimSendThrowTypeError=function(e){var t;function n(t,n){var r=t.send;t.send=function(){var e=arguments[0],e=e.length||e.size||e.byteLength;if("open"===t.readyState&&n.sctp&&e>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return r.apply(t,arguments)}}e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype&&(t=e.RTCPeerConnection.prototype.createDataChannel,e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},r.wrapPeerConnectionEvent(e,"datachannel",function(e){return n(e.channel,e.target),e}))};var a=(n=e("sdp"))&&n.__esModule?n:{default:n},r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var i;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(e("./utils"));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"./utils":95,sdp:71}],91:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimAddTransceiver=function(e){var o;"object"===c(e)&&e.RTCPeerConnection&&(o=e.RTCPeerConnection.prototype.addTransceiver)&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e,t=arguments[1]&&arguments[1].sendEncodings,n=0<(t=function(e){if(Array.isArray(e))return a(e)}(n=t=void 0===t?[]:t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){var n;if(e)return"string"==typeof e?a(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).length,r=(n&&t.forEach(function(e){if("rid"in e)if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(1<=parseFloat(e.scaleResolutionDownBy)))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(0<=parseFloat(e.maxFramerate)))throw new RangeError("max_framerate must be >= 0.0")}),o.apply(this,arguments));return!n||"encodings"in(n=(e=r.sender).getParameters())&&(1!==n.encodings.length||0!==Object.keys(n.encodings[0]).length)||(n.encodings=t,e.sendEncodings=t,this.setParametersPromises.push(e.setParameters(n).then(function(){delete e.sendEncodings}).catch(function(){delete e.sendEncodings}))),r})},n.shimCreateAnswer=function(e){var n;"object"===c(e)&&e.RTCPeerConnection&&(n=e.RTCPeerConnection.prototype.createAnswer,e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,t=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return n.apply(t,e)}).finally(function(){t.setParametersPromises=[]}):n.apply(this,arguments)})},n.shimCreateOffer=function(e){var n;"object"===c(e)&&e.RTCPeerConnection&&(n=e.RTCPeerConnection.prototype.createOffer,e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,t=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return n.apply(t,e)}).finally(function(){t.setParametersPromises=[]}):n.apply(this,arguments)})},Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),n.shimGetParameters=function(e){var t;"object"===c(e)&&e.RTCRtpSender&&(t=e.RTCRtpSender.prototype.getParameters)&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return o.shimGetUserMedia}}),n.shimOnTrack=function(e){"object"===c(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(r,o){var i,n;"object"===c(r)&&(r.RTCPeerConnection||r.mozRTCPeerConnection)&&(!r.RTCPeerConnection&&r.mozRTCPeerConnection&&(r.RTCPeerConnection=r.mozRTCPeerConnection),o.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=r.RTCPeerConnection.prototype[e],n=function(e,t,n){(t=function(e){e=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===c(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},e,function(){return arguments[0]=new("addIceCandidate"===e?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)});r.RTCPeerConnection.prototype[e]=n[e]}),i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=r.RTCPeerConnection.prototype.getStats,r.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),t=e[0],r=e[1],e=e[2];return n.apply(this,[t||null]).then(function(n){if(o.version<53&&!r)try{n.forEach(function(e){e.type=i[e.type]||e.type})}catch(e){if("TypeError"!==e.name)throw e;n.forEach(function(e,t){n.set(t,Object.assign({},e,{type:i[e.type]||e.type}))})}return n}).then(r,e)})},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimReceiverGetStats=function(e){var n;"object"===c(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype||((n=e.RTCPeerConnection.prototype.getReceivers)&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),r.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}))},n.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(t){var n=this;r.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(e){e.track&&t.getTracks().includes(e.track)&&n.removeTrack(e)})})},n.shimSenderGetStats=function(e){var n,t;"object"===c(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype||((n=e.RTCPeerConnection.prototype.getSenders)&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),(t=e.RTCPeerConnection.prototype.addTrack)&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}))};var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var i;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(e("../utils")),o=e("./getusermedia"),i=e("./getdisplaymedia");function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":95,"./getdisplaymedia":92,"./getusermedia":93}],92:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(t,n){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(e){return e&&e.video?(!0===e.video?e.video={mediaSource:n}:e.video.mediaSource=n,t.navigator.mediaDevices.getUserMedia(e)):((e=new DOMException("getDisplayMedia without video constraints is undefined")).name="NotFoundError",e.code=8,Promise.reject(e))})}},{}],93:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e,t){var r=e&&e.navigator,e=e&&e.MediaStreamTrack;{var n,o,i,s;r.getUserMedia=function(e,t,n){a.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,n)},55<t.version&&"autoGainControl"in r.mediaDevices.getSupportedConstraints()||(n=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},o=r.mediaDevices.getUserMedia.bind(r.mediaDevices),r.mediaDevices.getUserMedia=function(e){return"object"===c(e)&&"object"===c(e.audio)&&(e=JSON.parse(JSON.stringify(e)),n(e.audio,"autoGainControl","mozAutoGainControl"),n(e.audio,"noiseSuppression","mozNoiseSuppression")),o(e)},e&&e.prototype.getSettings&&(i=e.prototype.getSettings,e.prototype.getSettings=function(){var e=i.apply(this,arguments);return n(e,"mozAutoGainControl","autoGainControl"),n(e,"mozNoiseSuppression","noiseSuppression"),e}),e&&e.prototype.applyConstraints&&(s=e.prototype.applyConstraints,e.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===c(e)&&(e=JSON.parse(JSON.stringify(e)),n(e,"autoGainControl","mozAutoGainControl"),n(e,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[e])}))}};var a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var i;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(e("../utils"));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":95}],94:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimAudioContext=function(e){"object"!==c(e)||e.AudioContext||(e.AudioContext=e.webkitAudioContext)},n.shimCallbacksAPI=function(e){var r,o,i,s,a,t;"object"===c(e)&&e.RTCPeerConnection&&(e=e.RTCPeerConnection.prototype,r=e.createOffer,o=e.createAnswer,i=e.setLocalDescription,s=e.setRemoteDescription,a=e.addIceCandidate,e.createOffer=function(e,t){var n=r.apply(this,[2<=arguments.length?arguments[2]:e]);return t?(n.then(e,t),Promise.resolve()):n},e.createAnswer=function(e,t){var n=o.apply(this,[2<=arguments.length?arguments[2]:e]);return t?(n.then(e,t),Promise.resolve()):n},t=function(e,t,n){e=i.apply(this,[e]);return n?(e.then(t,n),Promise.resolve()):e},e.setLocalDescription=t,t=function(e,t,n){e=s.apply(this,[e]);return n?(e.then(t,n),Promise.resolve()):e},e.setRemoteDescription=t,t=function(e,t,n){e=a.apply(this,[e]);return n?(e.then(t,n),Promise.resolve()):e},e.addIceCandidate=t)},n.shimConstraints=o,n.shimCreateOfferLegacy=function(e){var n=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var t;return e&&(void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio),t=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind}),!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo),t=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind}),!1===e.offerToReceiveVideo&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveVideo||t||this.addTransceiver("video",{direction:"recvonly"})),n.apply(this,arguments)}},n.shimGetUserMedia=function(e){var r=e&&e.navigator;{var t;r.mediaDevices&&r.mediaDevices.getUserMedia&&(e=r.mediaDevices,t=e.getUserMedia.bind(e),r.mediaDevices.getUserMedia=function(e){return t(o(e))})}!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=function(e,t,n){r.mediaDevices.getUserMedia(e).then(t,n)}.bind(r))},n.shimLocalStreamsAPI=function(e){var i;"object"===c(e)&&e.RTCPeerConnection&&("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"addStream"in e.RTCPeerConnection.prototype||(i=e.RTCPeerConnection.prototype.addTrack,e.RTCPeerConnection.prototype.addStream=function(t){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach(function(e){return i.call(n,e,t)}),t.getVideoTracks().forEach(function(e){return i.call(n,e,t)})},e.RTCPeerConnection.prototype.addTrack=function(e){for(var t=this,n=arguments.length,r=new Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r&&r.forEach(function(e){t._localStreams?t._localStreams.includes(e)||t._localStreams.push(e):t._localStreams=[e]}),i.apply(this,arguments)}),"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t,n=this,r=(this._localStreams||(this._localStreams=[]),this._localStreams.indexOf(e));-1!==r&&(this._localStreams.splice(r,1),t=e.getTracks(),this.getSenders().forEach(function(e){t.includes(e.track)&&n.removeTrack(e)}))}))},n.shimRTCIceServerUrls=function(e){var i;e.RTCPeerConnection&&(i=e.RTCPeerConnection,e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){for(var n=[],r=0;r<e.iceServers.length;r++){var o=e.iceServers[r];void 0===o.urls&&o.url?(s.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,n.push(o)):n.push(e.iceServers[r])}e.iceServers=n}return new i(e,t)},e.RTCPeerConnection.prototype=i.prototype,"generateCertificate"in i)&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return i.generateCertificate}})},n.shimRemoteStreamsAPI=function(e){var t;"object"===c(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams||[]}),"onaddstream"in e.RTCPeerConnection.prototype||(Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var n=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){var t;n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.includes(e)||(n._remoteStreams.push(e),(t=new Event("addstream")).stream=e,n.dispatchEvent(t))})})}}),t=e.RTCPeerConnection.prototype.setRemoteDescription,e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){var t;n._remoteStreams||(n._remoteStreams=[]),0<=n._remoteStreams.indexOf(e)||(n._remoteStreams.push(e),(t=new Event("addstream")).stream=e,n.dispatchEvent(t))})}),t.apply(n,arguments)}))},n.shimTrackEventTransceiver=function(e){"object"===c(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};var s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};t=a(t);if(t&&t.has(e))return t.get(e);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var i;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(e("../utils"));function a(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(a=function(e){return e?n:t})(e))}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return e&&void 0!==e.video?Object.assign({},e,{video:s.compactObject(e.video)}):e}},{"../utils":95}],95:[function(e,t,n){"use strict";function s(e,t,n){return(t=function(e){e=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===r(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.compactObject=function o(i){if(!c(i))return i;return Object.keys(i).reduce(function(e,t){var n=c(i[t]),r=n?o(i[t]):i[t],n=n&&!Object.keys(r).length;return void 0===r||n?e:Object.assign(e,s({},t,r))},{})},n.deprecated=function(e,t){i&&console.warn(e+" is deprecated, please use "+t+" instead.")},n.detectBrowser=function(e){var t,n={browser:null,version:null};return void 0!==e&&e.navigator&&e.navigator.userAgent?(t=e.navigator).mozGetUserMedia?(n.browser="firefox",n.version=a(t.userAgent,/Firefox\/(\d+)\./,1)):t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection?(n.browser="chrome",n.version=a(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):e.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./)?(n.browser="safari",n.version=a(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype):n.browser="Not a supported browser.":n.browser="Not a browser.",n},n.disableLog=function(e){return"boolean"==typeof e?(o=e)?"adapter.js logging disabled":"adapter.js logging enabled":new Error("Argument type: "+r(e)+". Please use a boolean.")},n.disableWarnings=function(e){return"boolean"==typeof e?(i=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled")):new Error("Argument type: "+r(e)+". Please use a boolean.")},n.extractVersion=a,n.filterStats=function(n,t,e){var r,o=e?"outbound-rtp":"inbound-rtp",i=new Map;return null!==t&&(r=[],n.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&r.push(e)}),r.forEach(function(t){n.forEach(function(e){e.type===o&&e.trackId===t.id&&u(n,e,i)})})),i},n.log=function(){"object"!==("undefined"==typeof window?"undefined":r(window))||o||"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)},n.walkStats=u,n.wrapPeerConnectionEvent=function(e,r,o){var i,s;e.RTCPeerConnection&&(e=e.RTCPeerConnection.prototype,i=e.addEventListener,e.addEventListener=function(e,t){var n;return e!==r?i.apply(this,arguments):(n=function(e){e=o(e);e&&(t.handleEvent?t.handleEvent(e):t(e))},this._eventMap=this._eventMap||{},this._eventMap[r]||(this._eventMap[r]=new Map),this._eventMap[r].set(t,n),i.apply(this,[e,n]))},s=e.removeEventListener,e.removeEventListener=function(e,t){var n;return e===r&&this._eventMap&&this._eventMap[r]&&this._eventMap[r].has(t)?(n=this._eventMap[r].get(t),this._eventMap[r].delete(t),0===this._eventMap[r].size&&delete this._eventMap[r],0===Object.keys(this._eventMap).length&&delete this._eventMap,s.apply(this,[e,n])):s.apply(this,arguments)},Object.defineProperty(e,"on"+r,{get:function(){return this["_on"+r]},set:function(e){this["_on"+r]&&(this.removeEventListener(r,this["_on"+r]),delete this["_on"+r]),e&&this.addEventListener(r,this["_on"+r]=e)},enumerable:!0,configurable:!0}))};var o=!0,i=!0;function a(e,t,n){e=e.match(t);return e&&e.length>=n&&parseInt(e[n],10)}function c(e){return"[object Object]"===Object.prototype.toString.call(e)}function u(t,n,r){n&&!r.has(n.id)&&(r.set(n.id,n),Object.keys(n).forEach(function(e){e.endsWith("Id")?u(t,t.get(n[e]),r):e.endsWith("Ids")&&n[e].forEach(function(e){u(t,t.get(e),r)})}))}},{}],96:[function(e,t,n){window.mozRTCPeerConnection||navigator.mozGetUserMedia?(r="moz",o=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)):(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)&&(r="webkit",o=navigator.userAgent.match(/Chrom(e|ium)/)&&parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10));var r,o,i=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,s=window.mozRTCIceCandidate||window.RTCIceCandidate,a=window.mozRTCSessionDescription||window.RTCSessionDescription,c=window.webkitMediaStream||window.MediaStream,u="https:"===window.location.protocol&&("webkit"===r&&26<=o||"moz"===r&&33<=o),p=window.AudioContext||window.webkitAudioContext,d=document.createElement("video"),d=d&&d.canPlayType&&"probably"===d.canPlayType('video/webm; codecs="vp8", vorbis'),f=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;t.exports={prefix:r,browserVersion:o,support:!!i&&!!f,supportRTCPeerConnection:!!i,supportVp8:d,supportGetUserMedia:!!f,supportDataChannel:!!(i&&i.prototype&&i.prototype.createDataChannel),supportWebAudio:!(!p||!p.prototype.createMediaStreamSource),supportMediaStream:!(!c||!c.prototype.removeTrack),supportScreenSharing:!!u,AudioContext:p,PeerConnection:i,SessionDescription:a,IceCandidate:s,MediaStream:c,getUserMedia:f}},{}],97:[function(h,m,e){!function(n){!function(){"use strict";var s=h("for-each"),e=h("available-typed-arrays"),r=h("call-bind"),t=h("call-bind/callBound"),a=h("gopd"),c=t("Object.prototype.toString"),u=h("has-tostringtag/shams")(),o="undefined"==typeof globalThis?n:globalThis,p=e(),d=t("String.prototype.slice"),i=Object.getPrototypeOf,f=t("Array.prototype.indexOf",!0)||function(e,t){for(var n=0;n<e.length;n+=1)if(e[n]===t)return n;return-1},l={__proto__:null};s(p,u&&a&&i?function(e){var t,n=new o[e];Symbol.toStringTag in n&&(n=i(n),(t=a(n,Symbol.toStringTag))||(n=i(n),t=a(n,Symbol.toStringTag)),l["$"+e]=r(t.get))}:function(e){var t=new o[e],t=t.slice||t.set;t&&(l["$"+e]=r(t))});m.exports=function(e){var t,n,r,o,i;return!(!e||"object"!=typeof e)&&(u?a?(o=e,i=!1,s(l,function(e,t){if(!i)try{"$"+e(o)===t&&(i=d(t,1))}catch(e){}}),i):null:(t=d(c(e),8,-1),-1<f(p,t)?t:"Object"===t&&(n=e,r=!1,s(l,function(e,t){if(!r)try{e(n),r=d(t,1)}catch(e){}}),r)))}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"available-typed-arrays":3,"call-bind":7,"call-bind/callBound":6,"for-each":40,gopd:45,"has-tostringtag/shams":51}],98:[function(e,t,n){function r(){}((t.exports=r).mixin=function(e){e=e.prototype||e;e.isWildEmitter=!0,e.on=function(e,t,n){this.callbacks=this.callbacks||{};var r=3===arguments.length,o=r?n:t;return o._groupName=r?t:void 0,(this.callbacks[e]=this.callbacks[e]||[]).push(o),this},e.once=function(t,e,n){var r=this,o=3===arguments.length,i=o?n:e;return this.on(t,o?e:void 0,function e(){r.off(t,e),i.apply(this,arguments)}),this},e.releaseGroup=function(e){var t,n,r,o;for(t in this.callbacks=this.callbacks||{},this.callbacks)for(n=0,r=(o=this.callbacks[t]).length;n<r;n++)o[n]._groupName===e&&(o.splice(n,1),n--,r--);return this},e.off=function(e,t){this.callbacks=this.callbacks||{};var n,r=this.callbacks[e];return r&&(1===arguments.length||-1!==(n=r.indexOf(t))&&(r.splice(n,1),0===r.length))&&delete this.callbacks[e],this},e.emit=function(e){this.callbacks=this.callbacks||{};var t,n,r,o=[].slice.call(arguments,1),i=this.callbacks[e],s=this.getWildcardCallbacks(e);if(i)for(t=0,n=(r=i.slice()).length;t<n&&r[t];++t)r[t].apply(this,o);if(s)for(n=s.length,t=0,n=(r=s.slice()).length;t<n&&r[t];++t)r[t].apply(this,[e].concat(o));return this},e.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,n,r=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(r=r.concat(this.callbacks[t]));return r}})(r)},{}],99:[function(e,t,n){var r=e("util"),o=e("webrtcsupport"),i=e("rtcpeerconnection"),s=e("wildemitter"),a=e("filetransfer"),c="https://simplewebrtc.com/protocol/filetransfer#inband-v1";function u(e){var r=this;s.call(this),this.id=e.id,this.parent=e.parent,this.type=e.type||"video",this.oneway=e.oneway||!1,this.sharemyscreen=e.sharemyscreen||!1,this.browserPrefix=e.prefix,this.stream=e.stream,this.enableDataChannels=(void 0===e.enableDataChannels?this.parent.config:e).enableDataChannels,this.receiveMedia=e.receiveMedia||this.parent.config.receiveMedia,this.channels={},this.sid=e.sid||Date.now().toString(),this.pc=new i(this.parent.config.peerConnectionConfig,this.parent.config.peerConnectionConstraints),this.pc.on("ice",this.onIceCandidate.bind(this)),this.pc.on("endOfCandidates",function(e){r.send("endOfCandidates",e)}),this.pc.on("offer",function(e){r.parent.config.nick&&(e.nick=r.parent.config.nick),r.send("offer",e)}),this.pc.on("answer",function(e){r.parent.config.nick&&(e.nick=r.parent.config.nick),r.send("answer",e)}),this.pc.on("addStream",this.handleRemoteStreamAdded.bind(this)),this.pc.on("addChannel",this.handleDataChannelAdded.bind(this)),this.pc.on("removeStream",this.handleStreamRemoved.bind(this)),this.pc.on("negotiationNeeded",this.emit.bind(this,"negotiationNeeded")),this.pc.on("iceConnectionStateChange",this.emit.bind(this,"iceConnectionStateChange")),this.pc.on("iceConnectionStateChange",function(){"failed"===r.pc.iceConnectionState&&"offer"===r.pc.pc.localDescription.type&&(r.parent.emit("iceFailed",r),r.send("connectivityError"))}),this.pc.on("signalingStateChange",this.emit.bind(this,"signalingStateChange")),this.logger=this.parent.logger,"screen"===e.type?this.parent.localScreens&&this.parent.localScreens[0]&&this.sharemyscreen&&(this.logger.log("adding local screen stream to peer connection"),this.pc.addStream(this.parent.localScreens[0]),this.broadcaster=e.broadcaster):this.parent.localStreams.forEach(function(e){r.pc.addStream(e)}),this.on("channelOpen",function(t){t.protocol===c&&(t.onmessage=function(e){var e=JSON.parse(e.data),n=new a.Receiver;n.receive(e,t),r.emit("fileTransfer",e,n),n.on("receivedFile",function(e,t){n.channel.close()})})}),this.on("*",function(){r.parent.emit.apply(r.parent,arguments)})}r.inherits(u,s),u.prototype.handleMessage=function(e){var t=this;this.logger.log("getting",e.type,e),e.prefix&&(this.browserPrefix=e.prefix),"offer"===e.type?(this.nick||(this.nick=e.payload.nick),delete e.payload.nick,this.pc.handleOffer(e.payload,function(e){e||t.pc.answer(function(e,t){})})):"answer"===e.type?(this.nick||(this.nick=e.payload.nick),delete e.payload.nick,this.pc.handleAnswer(e.payload)):"candidate"===e.type?this.pc.processIce(e.payload):"connectivityError"===e.type?this.parent.emit("connectivityError",t):"mute"===e.type?this.parent.emit("mute",{id:e.from,name:e.payload.name}):"unmute"===e.type?this.parent.emit("unmute",{id:e.from,name:e.payload.name}):"endOfCandidates"===e.type&&this.pc.pc.addIceCandidate(void 0)},u.prototype.send=function(e,t){t={to:this.id,sid:this.sid,broadcaster:this.broadcaster,roomType:this.type,type:e,payload:t,prefix:o.prefix};this.logger.log("sending",e,t),this.parent.emit("message",t)},u.prototype.sendDirectly=function(e,t,n){n={type:t,payload:n},this.logger.log("sending via datachannel",e,t,n),t=this.getDataChannel(e);return"open"==t.readyState&&(t.send(JSON.stringify(n)),!0)},u.prototype._observeDataChannel=function(t){var n=this;t.onclose=this.emit.bind(this,"channelClose",t),t.onerror=this.emit.bind(this,"channelError",t),t.onmessage=function(e){n.emit("channelMessage",n,t.label,JSON.parse(e.data),t,e)},t.onopen=this.emit.bind(this,"channelOpen",t)},u.prototype.getDataChannel=function(e,t){var n;return o.supportDataChannel?(t=t||{},(n=this.channels[e])||(n=this.channels[e]=this.pc.createDataChannel(e,t),this._observeDataChannel(n)),n):this.emit("error",new Error("createDataChannel not supported"))},u.prototype.onIceCandidate=function(e){var t;this.closed||(e?(t=this.parent.config.peerConnectionConfig,"moz"===o.prefix&&t&&t.iceTransports&&e.candidate&&e.candidate.candidate&&e.candidate.candidate.indexOf(t.iceTransports)<0?this.logger.log("Ignoring ice candidate not matching pcConfig iceTransports type: ",t.iceTransports):this.send("candidate",e)):this.logger.log("End of candidates."))},u.prototype.start=function(){this.enableDataChannels&&this.getDataChannel("simplewebrtc"),this.pc.offer(this.receiveMedia,function(e,t){})},u.prototype.icerestart=function(){var e=this.receiveMedia;e.mandatory.IceRestart=!0,this.pc.offer(e,function(e,t){})},u.prototype.end=function(){this.closed||(this.pc.close(),this.handleStreamRemoved())},u.prototype.handleRemoteStreamAdded=function(e){var n=this;this.stream?this.logger.warn("Already have a remote stream"):(this.stream=e.stream,this.stream.getTracks().forEach(function(e){e.addEventListener("ended",function(){var e,t;e=n.stream,t=!0,e.getTracks().forEach(function(e){t="ended"===e.readyState&&t}),t&&n.end()})}),this.parent.emit("peerStreamAdded",this))},u.prototype.handleStreamRemoved=function(){var e=this.parent.peers.indexOf(this);-1<e&&(this.parent.peers.splice(e,1),this.closed=!0,this.parent.emit("peerStreamRemoved",this))},u.prototype.handleDataChannelAdded=function(e){this.channels[e.label]=e,this._observeDataChannel(e)},u.prototype.sendFile=function(e){var t=new a.Sender,n=this.getDataChannel("filetransfer"+(new Date).getTime(),{protocol:c});return n.onopen=function(){n.send(JSON.stringify({size:e.size,name:e.name})),t.send(e,n)},n.onclose=function(){console.log("sender received transfer"),t.emit("complete")},t},t.exports=u},{filetransfer:39,rtcpeerconnection:65,util:84,webrtcsupport:96,wildemitter:98}],100:[function(e,t,n){var s=e("./webrtc"),a=e("wildemitter"),c=e("webrtcsupport"),u=e("attachmediastream"),p=e("mockconsole"),d=e("./socketioconnection");function r(e){var t,n,r=this,o=e||{},i=this.config={url:"https://sandbox.simplewebrtc.com:443/",socketio:{},connection:null,debug:!1,localVideoEl:"",remoteVideosEl:"",enableDataChannels:!0,autoRequestMedia:!1,autoRemoveVideos:!0,adjustPeerVolume:!1,peerVolumeWhenSpeaking:.25,media:{video:!0,audio:!0},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},localVideo:{autoplay:!0,mirror:!0,muted:!0}};for(t in this.logger=e.debug?e.logger||console:e.logger||p,o)o.hasOwnProperty(t)&&(this.config[t]=o[t]);this.capabilities=c,a.call(this),(n=null===this.config.connection?this.connection=new d(this.config):this.connection=this.config.connection).on("connect",function(){r.emit("connectionReady",n.getSessionid()),r.sessionReady=!0,r.testReadiness()}),n.on("message",function(t){var n,e=r.webrtc.getPeers(t.from,t.roomType);"offer"===t.type?(e.length&&e.forEach(function(e){e.sid==t.sid&&(n=e)}),n||(n=r.webrtc.createPeer({id:t.from,sid:t.sid,type:t.roomType,enableDataChannels:r.config.enableDataChannels&&"screen"!==t.roomType,sharemyscreen:"screen"===t.roomType&&!t.broadcaster,broadcaster:"screen"!==t.roomType||t.broadcaster?null:r.connection.getSessionid()}),r.emit("createdPeer",n)),n.handleMessage(t)):e.length&&e.forEach(function(e){(!t.sid||e.sid===t.sid)&&e.handleMessage(t)})}),n.on("remove",function(e){e.id!==r.connection.getSessionid()&&r.webrtc.removePeers(e.id,e.type)}),e.logger=this.logger,e.debug=!1,this.webrtc=new s(e),["mute","unmute","pauseVideo","resumeVideo","pause","resume","sendToAll","sendDirectlyToAll","getPeers"].forEach(function(e){r[e]=r.webrtc[e].bind(r.webrtc)}),this.webrtc.on("*",function(){r.emit.apply(r,arguments)}),i.debug&&this.on("*",this.logger.log.bind(this.logger,"SimpleWebRTC event:")),this.webrtc.on("localStream",function(){r.testReadiness()}),this.webrtc.on("message",function(e){r.connection.emit("message",e)}),this.webrtc.on("peerStreamAdded",this.handlePeerStreamAdded.bind(this)),this.webrtc.on("peerStreamRemoved",this.handlePeerStreamRemoved.bind(this)),this.config.adjustPeerVolume&&(this.webrtc.on("speaking",this.setVolumeForAll.bind(this,this.config.peerVolumeWhenSpeaking)),this.webrtc.on("stoppedSpeaking",this.setVolumeForAll.bind(this,1))),n.on("turnservers",function(e){r.webrtc.config.peerConnectionConfig.iceServers=r.webrtc.config.peerConnectionConfig.iceServers.concat(e),r.emit("turnservers",e)}),this.webrtc.on("iceFailed",function(e){}),this.webrtc.on("connectivityError",function(e){}),this.webrtc.on("audioOn",function(){r.webrtc.sendToAll("unmute",{name:"audio"})}),this.webrtc.on("audioOff",function(){r.webrtc.sendToAll("mute",{name:"audio"})}),this.webrtc.on("videoOn",function(){r.webrtc.sendToAll("unmute",{name:"video"})}),this.webrtc.on("videoOff",function(){r.webrtc.sendToAll("mute",{name:"video"})}),this.webrtc.on("localScreen",function(e){var t=document.createElement("video"),n=r.getRemoteVideoContainer();t.oncontextmenu=function(){return!1},t.id="localScreen",u(e,t),n&&n.appendChild(t),r.emit("localScreenAdded",t),r.connection.emit("shareScreen"),r.webrtc.peers.forEach(function(e){"video"===e.type&&(e=r.webrtc.createPeer({id:e.id,type:"screen",sharemyscreen:!0,enableDataChannels:!1,receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},broadcaster:r.connection.getSessionid()}),r.emit("createdPeer",e),e.start())})}),this.webrtc.on("localScreenStopped",function(e){r.getLocalScreen()&&r.stopScreenShare()}),this.webrtc.on("channelMessage",function(e,t,n){"volume"==n.type&&r.emit("remoteVolumeChange",e,n.volume)}),this.config.autoRequestMedia&&this.startLocalVideo()}(r.prototype=Object.create(a.prototype,{constructor:{value:r}})).leaveRoom=function(){if(this.roomName){for(this.connection.emit("leave");this.webrtc.peers.length;)this.webrtc.peers[0].end();this.getLocalScreen()&&this.stopScreenShare(),this.emit("leftRoom",this.roomName),this.roomName=void 0}},r.prototype.disconnect=function(){this.connection.disconnect(),delete this.connection},r.prototype.handlePeerStreamAdded=function(e){var t=this,n=this.getRemoteVideoContainer(),r=u(e.stream);(e.videoEl=r).id=this.getDomId(e),n&&n.appendChild(r),this.emit("videoAdded",r,e),window.setTimeout(function(){t.webrtc.isAudioEnabled()||e.send("mute",{name:"audio"}),t.webrtc.isVideoEnabled()||e.send("mute",{name:"video"})},250)},r.prototype.handlePeerStreamRemoved=function(e){var t=this.getRemoteVideoContainer(),n=e.videoEl;this.config.autoRemoveVideos&&t&&n&&t.removeChild(n),n&&this.emit("videoRemoved",n,e)},r.prototype.getDomId=function(e){return[e.id,e.type,e.broadcaster?"broadcasting":"incoming"].join("_")},r.prototype.setVolumeForAll=function(t){this.webrtc.peers.forEach(function(e){e.videoEl&&(e.videoEl.volume=t)})},r.prototype.joinRoom=function(s,a){var c=this;this.roomName=s,this.connection.emit("join",s,function(e,t){var n,r,o,i;if(console.log("join CB",e,t),e)c.emit("error",e);else for(n in t.clients)for(o in r=t.clients[n])r[o]&&(i=c.webrtc.createPeer({id:n,type:o,enableDataChannels:c.config.enableDataChannels&&"screen"!==o,receiveMedia:{offerToReceiveAudio:"screen"!==o&&c.config.receiveMedia.offerToReceiveAudio?1:0,offerToReceiveVideo:c.config.receiveMedia.offerToReceiveVideo}}),c.emit("createdPeer",i),i.start());a&&a(e,t),c.emit("joinedRoom",s)})},r.prototype.getEl=function(e){return"string"==typeof e?document.getElementById(e):e},r.prototype.startLocalVideo=function(){var n=this;this.webrtc.start(this.config.media,function(e,t){e?n.emit("localMediaError",e):u(t,n.getLocalVideoContainer(),n.config.localVideo)})},r.prototype.stopLocalVideo=function(){this.webrtc.stop()},r.prototype.getLocalVideoContainer=function(){var e,t=this.getEl(this.config.localVideoEl);return t&&"VIDEO"===t.tagName?(t.oncontextmenu=function(){return!1},t):t?((e=document.createElement("video")).oncontextmenu=function(){return!1},t.appendChild(e),e):void 0},r.prototype.getRemoteVideoContainer=function(){return this.getEl(this.config.remoteVideosEl)},r.prototype.shareScreen=function(e){this.webrtc.startScreenShare(e)},r.prototype.getLocalScreen=function(){return this.webrtc.localScreens&&this.webrtc.localScreens[0]},r.prototype.stopScreenShare=function(){this.connection.emit("unshareScreen");var e=document.getElementById("localScreen"),t=this.getRemoteVideoContainer();this.config.autoRemoveVideos&&t&&e&&t.removeChild(e),e&&this.emit("videoRemoved",e),this.getLocalScreen()&&this.webrtc.stopScreenShare(),this.webrtc.peers.forEach(function(e){e.broadcaster&&e.end()})},r.prototype.testReadiness=function(){this.sessionReady&&(!this.config.media.video&&!this.config.media.audio||0<this.webrtc.localStreams.length)&&this.emit("readyToCall",this.connection.getSessionid())},r.prototype.createRoom=function(e,t){this.roomName=e,2===arguments.length?this.connection.emit("create",e,t):this.connection.emit("create",e)},r.prototype.sendFile=function(){if(!c.dataChannel)return this.emit("error",new Error("DataChannelNotSupported"))},t.exports=r},{"./socketioconnection":101,"./webrtc":102,attachmediastream:2,mockconsole:61,webrtcsupport:96,wildemitter:98}],101:[function(e,t,n){var r=e("socket.io-client");function o(e){this.connection=r.connect(e.url,e.socketio)}o.prototype.on=function(e,t){this.connection.on(e,t)},o.prototype.emit=function(){this.connection.emit.apply(this.connection,arguments)},o.prototype.getSessionid=function(){return this.connection.id},o.prototype.disconnect=function(){return this.connection.disconnect()},t.exports=o},{"socket.io-client":74}],102:[function(e,t,n){var r=e("util"),i=e("webrtcsupport"),s=e("mockconsole"),a=e("localmedia"),o=e("./peer");function c(e){var t,o=this,n=e||{};this.config={debug:!1,peerConnectionConfig:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},peerConnectionConstraints:{optional:[]},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},enableDataChannels:!0};for(t in this.logger=e.debug?e.logger||console:e.logger||s,n)n.hasOwnProperty(t)&&(this.config[t]=n[t]);i.support||this.logger.error("Your browser doesn't seem to support WebRTC"),this.peers=[],a.call(this,this.config),this.on("speaking",function(){o.hardMuted||o.peers.forEach(function(e){e.enableDataChannels&&"open"==(e=e.getDataChannel("hark")).readyState&&e.send(JSON.stringify({type:"speaking"}))})}),this.on("stoppedSpeaking",function(){o.hardMuted||o.peers.forEach(function(e){e.enableDataChannels&&"open"==(e=e.getDataChannel("hark")).readyState&&e.send(JSON.stringify({type:"stoppedSpeaking"}))})}),this.on("volumeChange",function(t,e){o.hardMuted||o.peers.forEach(function(e){e.enableDataChannels&&"open"==(e=e.getDataChannel("hark")).readyState&&e.send(JSON.stringify({type:"volume",volume:t}))})}),this.config.debug&&this.on("*",function(e,t,n){var r=o.config.logger===s?console:o.logger;r.log("event:",e,t,n)})}r.inherits(c,a),c.prototype.createPeer=function(e){return e.parent=this,e=new o(e),this.peers.push(e),e},c.prototype.removePeers=function(e,t){this.getPeers(e,t).forEach(function(e){e.end()})},c.prototype.getPeers=function(t,n){return this.peers.filter(function(e){return!(t&&e.id!==t||n&&e.type!==n)})},c.prototype.sendToAll=function(t,n){this.peers.forEach(function(e){e.send(t,n)})},c.prototype.sendDirectlyToAll=function(t,n,r){this.peers.forEach(function(e){e.enableDataChannels&&e.sendDirectly(t,n,r)})},t.exports=c},{"./peer":99,localmedia:59,mockconsole:61,util:84,webrtcsupport:96}]},{},[100])(100)});